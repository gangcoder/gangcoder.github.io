<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="3241px" height="1330px" viewBox="-0.5 -0.5 3241 1330" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-05-01T02:47:56.383Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_3) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/12.6.5 Chrome/80.0.3987.86 Electron/8.0.0 Safari/537.36&quot; etag=&quot;7A-gycCiQd7rAe_6svfv&quot; version=&quot;12.6.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;526PEuHqSIsdyW--ANvW&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-832-917-255-26-0"><rect x="832" y="917" width="255" height="26"/></clipPath><clipPath id="mx-clip-2342-318-395-26-0"><rect x="2342" y="318" width="395" height="26"/></clipPath><clipPath id="mx-clip-2342-399-335-26-0"><rect x="2342" y="399" width="335" height="26"/></clipPath><clipPath id="mx-clip-2342-425-335-26-0"><rect x="2342" y="425" width="335" height="26"/></clipPath><clipPath id="mx-clip-2342-451-335-26-0"><rect x="2342" y="451" width="335" height="26"/></clipPath><clipPath id="mx-clip-2342-518-389-26-0"><rect x="2342" y="518" width="389" height="26"/></clipPath><clipPath id="mx-clip-2342-544-389-26-0"><rect x="2342" y="544" width="389" height="26"/></clipPath><clipPath id="mx-clip-2342-570-389-26-0"><rect x="2342" y="570" width="389" height="26"/></clipPath></defs><g><path d="M 827 912 L 827 880 L 1087 880 L 1087 912" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="all"/><path d="M 827 912 L 827 938 L 1087 938 L 1087 912" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none"/><path d="M 827 912 L 1087 912" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="833.5" y="893">&lt;&lt;interface&gt;&gt;</text><text x="833.5" y="909">SpanProcessor</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-832-917-255-26-0)" font-size="13px"><text x="833.5" y="930.5">+ Process(input Message) error</text></g><path d="M 2337 295.25 L 2296.53 295.26 Q 2286.53 295.27 2286.53 305.27 L 2286.53 310.67 Q 2286.53 316.07 2276.53 316.05 L 2242.37 316.01" fill="none" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 2237.12 316 L 2244.12 312.51 L 2242.37 316.01 L 2244.11 319.51 Z" fill="#019ed5" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 2337 312.75 L 2337 280.75 L 2737 280.75 L 2737 312.75" fill="#dae8fc" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none"/><path d="M 2337 312.75 L 2337 338.75 L 2737 338.75 L 2737 312.75" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none"/><path d="M 2337 312.75 L 2737 312.75" fill="none" stroke="#6c8ebf" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="2343.5" y="293.75">&lt;&lt;interface&gt;&gt;</text><text x="2343.5" y="309.75">Consumer</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2342-318-395-26-0)" font-size="13px"><text x="2343.5" y="331.25">+ Partitions() &lt;-chan cluster.PartitionConsumer</text></g><path d="M 2337 393.75 L 2337 367.75 L 2677 367.75 L 2677 393.75" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="none"/><path d="M 2337 393.75 L 2337 471.75 L 2677 471.75 L 2677 393.75" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none"/><path d="M 2337 393.75 L 2677 393.75" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="2343.5" y="385.75">ProcessorFactory</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2342-399-335-26-0)" font-size="13px"><text x="2343.5" y="412.25">- topic: string</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2342-425-335-26-0)" font-size="13px"><text x="2343.5" y="438.25">- consumer: consumer.Consumer</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2342-451-335-26-0)" font-size="13px"><text x="2343.5" y="464.25">- baseProcessor: processor.SpanProcessor</text></g><path d="M 2337 513 L 2337 487 L 2731 487 L 2731 513" fill="#d5e8d4" stroke="#82b366" stroke-miterlimit="10" pointer-events="none"/><path d="M 2337 513 L 2337 591 L 2731 591 L 2731 513" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none"/><path d="M 2337 513 L 2731 513" fill="none" stroke="#82b366" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="2343.5" y="505">Consumer</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2342-518-389-26-0)" font-size="13px"><text x="2343.5" y="531.5">- internalConsumer: consumer.Consumer</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2342-544-389-26-0)" font-size="13px"><text x="2343.5" y="557.5">- processorFactory: ProcessorFactory</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2342-570-389-26-0)" font-size="13px"><text x="2343.5" y="583.5">- partitionIDToState: map[int32]*consumerState</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 271px; margin-left: 29px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">1. 创建消费者实例</div></div></div></foreignObject><text x="29" y="275" fill="#000000" font-family="source code pro" font-size="13px">1. 创建消费者实例</text></switch></g><rect x="27" y="177" width="440" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 433px; height: 1px; padding-top: 207px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">spanWriter, err := storageFactory.CreateSpanWriter()</div></div></div></foreignObject><text x="34" y="211" fill="#000000" font-family="source code pro" font-size="13px">spanWriter, err := storageFactory.CreateSpanWriter()</text></switch></g><rect x="27" y="287" width="370" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 363px; height: 1px; padding-top: 317px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">consumer, err := builder.CreateConsumer(...)</div></div></div></foreignObject><text x="34" y="321" fill="#000000" font-family="source code pro" font-size="13px">consumer, err := builder.CreateConsumer(...)</text></switch></g><rect x="480" y="287" width="220" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 213px; height: 1px; padding-top: 317px; margin-left: 487px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func CreateConsumer(...)</div></div></div></foreignObject><text x="487" y="321" fill="#000000" font-family="source code pro" font-size="13px">func CreateConsumer(...)</text></switch></g><rect x="827" y="180" width="440" height="94" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 433px; height: 1px; padding-top: 227px; margin-left: 834px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">spParams := processor.SpanProcessorParams{<br />    Writer:       spanWriter,<br />    Unmarshaller: unmarshaller,<br />}<br />spanProcessor := processor.NewSpanProcessor(spParams)</div></div></div></foreignObject><text x="834" y="231" fill="#000000" font-family="source code pro" font-size="13px">spParams := processor.SpanProcessorParams{...</text></switch></g><rect x="827" y="287" width="430" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 423px; height: 1px; padding-top: 317px; margin-left: 834px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #FE4365; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">saramaConsumer, err := consumerConfig.NewConsumer()</div></div></div></foreignObject><text x="834" y="321" fill="#FE4365" font-family="source code pro" font-size="13px">saramaConsumer, err := consumerConfig.NewConsumer()</text></switch></g><rect x="827" y="357" width="545" height="100" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 538px; height: 1px; padding-top: 407px; margin-left: 834px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">factoryParams := consumer.ProcessorFactoryParams{<br />    SaramaConsumer: saramaConsumer,<br />    BaseProcessor:  spanProcessor,<br />}<br />processorFactory, err := consumer.NewProcessorFactory(factoryParams)</div></div></div></foreignObject><text x="834" y="411" fill="#000000" font-family="source code pro" font-size="13px">factoryParams := consumer.ProcessorFactoryParams{...</text></switch></g><rect x="827" y="467" width="385" height="100" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 378px; height: 1px; padding-top: 517px; margin-left: 834px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">consumerParams := consumer.Params{<br />    InternalConsumer:      <font color="#fe4365">saramaConsumer</font>,<br />    ProcessorFactory:      *processorFactory,<br />}<br />return consumer.New(consumerParams)</div></div></div></foreignObject><text x="834" y="521" fill="#000000" font-family="source code pro" font-size="13px">consumerParams := consumer.Params{...</text></switch></g><rect x="1337" y="197" width="259" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 252px; height: 1px; padding-top: 227px; margin-left: 1344px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewSpanProcessor(...)</div></div></div></foreignObject><text x="1344" y="231" fill="#000000" font-family="source code pro" font-size="13px">func NewSpanProcessor(...)</text></switch></g><rect x="1685" y="184.5" width="330" height="85" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 323px; height: 1px; padding-top: 227px; margin-left: 1692px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;KafkaSpanProcessor{<br />    unmarshaller: params.Unmarshaller,<br />    writer:       params.Writer,<br />}</div></div></div></foreignObject><text x="1692" y="231" fill="#000000" font-family="source code pro" font-size="13px">return &amp;KafkaSpanProcessor{...</text></switch></g><rect x="2195" y="186" width="221" height="60" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 214px; height: 1px; padding-top: 216px; margin-left: 2202px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Process(message Message)</div></div></div></foreignObject><text x="2202" y="220" fill="#000000" font-family="source code pro" font-size="13px">Process(message Message)</text></switch></g><rect x="2506" y="184.5" width="460" height="63" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 453px; height: 1px; padding-top: 216px; margin-left: 2513px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">mSpan, err := s.unmarshaller.Unmarshal(message.Value())<br />return s.writer.WriteSpan(mSpan)</div></div></div></foreignObject><text x="2513" y="220" fill="#000000" font-family="source code pro" font-size="13px">mSpan, err := s.unmarshaller.Unmarshal(message.Value())...</text></switch></g><rect x="1337" y="286.5" width="142" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 135px; height: 1px; padding-top: 317px; margin-left: 1344px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">NewConsumer()</div></div></div></foreignObject><text x="1344" y="320" fill="#000000" font-family="source code pro" font-size="13px">NewConsumer()</text></switch></g><rect x="1578" y="280.75" width="658" height="70.5" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 651px; height: 1px; padding-top: 316px; margin-left: 1585px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">saramaConfig := cluster.NewConfig()<br />c.AuthenticationConfig.SetConfiguration(&amp;saramaConfig.Config)<br />return cluster.NewConsumer(c.Brokers, c.GroupID, []string{c.Topic}, saramaConfig)</div></div></div></foreignObject><text x="1585" y="320" fill="#000000" font-family="source code pro" font-size="13px">saramaConfig := cluster.NewConfig()...</text></switch></g><rect x="1447" y="377" width="254" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 247px; height: 1px; padding-top: 407px; margin-left: 1454px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewProcessorFactory(...)</div></div></div></foreignObject><text x="1454" y="411" fill="#000000" font-family="source code pro" font-size="13px">func NewProcessorFactory(...)</text></switch></g><path d="M 2337 377.01 L 2241.07 377 Q 2231.07 377 2231.07 387 L 2231.07 397 Q 2231.07 407 2221.07 407 L 2131.37 407" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 2126.12 407 L 2133.12 403.5 L 2131.37 407 L 2133.12 410.5 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><rect x="1777" y="366.75" width="348" height="80.5" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 341px; height: 1px; padding-top: 407px; margin-left: 1784px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;ProcessorFactory{<br />    consumer:       params.SaramaConsumer,<br />    baseProcessor:  params.BaseProcessor,<br />}, nil</div></div></div></foreignObject><text x="1784" y="411" fill="#000000" font-family="source code pro" font-size="13px">return &amp;ProcessorFactory{...</text></switch></g><rect x="1337" y="487" width="232" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 225px; height: 1px; padding-top: 517px; margin-left: 1344px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func New(params Params)</div></div></div></foreignObject><text x="1344" y="521" fill="#000000" font-family="source code pro" font-size="13px">func New(params Params)</text></switch></g><path d="M 2337 496.98 L 2227.07 497 Q 2217.07 497 2217.07 507 L 2217.07 512 Q 2217.07 517 2207.07 517 L 2103.37 517" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 2098.12 517 L 2105.12 513.5 L 2103.37 517 L 2105.12 520.5 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><rect x="1639" y="471.75" width="458" height="90.5" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 451px; height: 1px; padding-top: 517px; margin-left: 1646px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;Consumer{<br />    internalConsumer:    <font color="#fe4365">params.InternalConsumer</font>,<br />    processorFactory:    params.ProcessorFactory,<br />    partitionIDToState:  make(map[int32]*consumerState),<br />}, nil</div></div></div></foreignObject><text x="1646" y="521" fill="#000000" font-family="source code pro" font-size="13px">return &amp;Consumer{...</text></switch></g><path d="M 397 317 L 473.63 317" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 478.88 317 L 471.88 320.5 L 473.63 317 L 471.88 313.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 317 L 737.07 317 Q 747.07 317 747.07 307 L 747.07 237 Q 747.07 227 757.07 227 L 820.63 227" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 825.88 227 L 818.88 230.5 L 820.63 227 L 818.88 223.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 317 L 820.63 317" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 825.88 317 L 818.88 320.5 L 820.63 317 L 818.88 313.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 317 L 737.07 317 Q 747.07 317 747.07 327 L 747.07 397 Q 747.07 407 757.07 407 L 820.63 407" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 825.88 407 L 818.88 410.5 L 820.63 407 L 818.88 403.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 700 317 L 737.07 317 Q 747.07 317 747.07 327 L 747.07 507 Q 747.07 517 757.07 517 L 820.63 517" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 825.88 517 L 818.88 520.5 L 820.63 517 L 818.88 513.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1267 227 L 1330.63 227" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1335.88 227 L 1328.88 230.5 L 1330.63 227 L 1328.88 223.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1596 227 L 1678.63 227" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1683.88 227 L 1676.88 230.5 L 1678.63 227 L 1676.88 223.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2416 216 L 2499.63 216" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2504.88 216 L 2497.88 219.5 L 2499.63 216 L 2497.88 212.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1257 317 L 1287.07 317 Q 1297.07 317 1297.07 316.73 L 1297.07 316.6 Q 1297.07 316.47 1307.07 316.47 L 1330.63 316.47" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1335.88 316.47 L 1328.88 319.97 L 1330.63 316.47 L 1328.88 312.97 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1479 316.5 L 1518.53 316.47 Q 1528.53 316.47 1538.53 316.37 L 1571.63 316.07" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1576.88 316.07 L 1569.88 319.57 L 1571.63 316.07 L 1569.88 312.57 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1372 407 L 1440.63 407" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1445.88 407 L 1438.88 410.5 L 1440.63 407 L 1438.88 403.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1701 407 L 1729.07 407 Q 1739.07 407 1749.07 407 L 1770.63 407" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1775.88 407 L 1768.88 410.5 L 1770.63 407 L 1768.88 403.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1212 517 L 1330.63 517" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1335.88 517 L 1328.88 520.5 L 1330.63 517 L 1328.88 513.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1569 517 L 1594 517 Q 1604 517 1614 517 L 1632.63 517" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1637.88 517 L 1630.88 520.5 L 1632.63 517 L 1630.88 513.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 607px; margin-left: 29px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">2. 开启消费逻辑</div></div></div></foreignObject><text x="29" y="611" fill="#000000" font-family="source code pro" font-size="13px">2. 开启消费逻辑</text></switch></g><rect x="27" y="627" width="169" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 162px; height: 1px; padding-top: 657px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">consumer.Start()</div></div></div></foreignObject><text x="34" y="661" fill="#000000" font-family="source code pro" font-size="13px">consumer.Start()</text></switch></g><rect x="247" y="618.5" width="650" height="77" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 643px; height: 1px; padding-top: 657px; margin-left: 254px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for pc := range <font color="#fe4365">c.internalConsumer</font>.Partitions() {<br />    c.partitionIDToState[pc.Partition()] = &amp;consumerState{partitionConsumer: pc}<br />    go c.handleMessages(pc)<br />}</div></div></div></foreignObject><text x="254" y="661" fill="#000000" font-family="source code pro" font-size="13px">for pc := range c.internalConsumer.Partitions() {...</text></switch></g><rect x="971" y="627" width="346" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 339px; height: 1px; padding-top: 657px; margin-left: 978px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">handleMessages(pc sc.PartitionConsumer)</div></div></div></foreignObject><text x="978" y="661" fill="#000000" font-family="source code pro" font-size="13px">handleMessages(pc sc.PartitionConsumer)</text></switch></g><rect x="1408" y="597" width="619" height="120" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 612px; height: 1px; padding-top: 657px; margin-left: 1415px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for {<br />    select {<br />    case msg, ok := &lt;-pc.Messages():<br />        msgProcessor = c.processorFactory.new(pc.Partition(), msg.Offset-1)<br />        msgProcessor.Process(&amp;saramaMessageWrapper{msg})<br />    }<br />}</div></div></div></foreignObject><text x="1415" y="661" fill="#000000" font-family="source code pro" font-size="13px">for {...</text></switch></g><rect x="2125" y="627" width="332" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 325px; height: 1px; padding-top: 657px; margin-left: 2132px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">new(partition int32, minOffset int64)</div></div></div></foreignObject><text x="2132" y="661" fill="#000000" font-family="source code pro" font-size="13px">new(partition int32, minOffset int64)</text></switch></g><rect x="2547" y="606.5" width="680" height="101" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 673px; height: 1px; padding-top: 657px; margin-left: 2554px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">retryProcessor := decorator.NewRetryingProcessor(c.metricsFactory, c.baseProcessor)<br />cp := NewCommittingProcessor(retryProcessor, om)<br />spanProcessor := processor.NewDecoratedProcessor(c.metricsFactory, cp)<br />pp := processor.NewParallelProcessor(spanProcessor, c.parallelism, c.logger)<br />return newStartedProcessor(pp, om)</div></div></div></foreignObject><text x="2554" y="661" fill="#000000" font-family="source code pro" font-size="13px">retryProcessor := decorator.NewRetryingProcessor(c.metricsFactory, c.baseProcessor)...</text></switch></g><rect x="2547" y="774" width="286" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 279px; height: 1px; padding-top: 804px; margin-left: 2554px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func newStartedProcessor(...)</div></div></div></foreignObject><text x="2554" y="808" fill="#000000" font-family="source code pro" font-size="13px">func newStartedProcessor(...)</text></switch></g><rect x="2911" y="755.5" width="288" height="97" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 281px; height: 1px; padding-top: 804px; margin-left: 2918px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">s := &amp;startedProcessor{<br />    services:  services,<br />    processor: parallelProcessor,<br />}<br />s.processor.Start()</div></div></div></foreignObject><text x="2918" y="808" fill="#000000" font-family="source code pro" font-size="13px">s := &amp;startedProcessor{...</text></switch></g><rect x="2547" y="867" width="280" height="60" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 273px; height: 1px; padding-top: 897px; margin-left: 2554px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Process(message processor.Message)</div></div></div></foreignObject><text x="2554" y="901" fill="#000000" font-family="source code pro" font-size="13px">Process(message processor.Message)</text></switch></g><rect x="2911" y="867" width="306" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 299px; height: 1px; padding-top: 897px; margin-left: 2918px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return c.processor.Process(message)</div></div></div></foreignObject><text x="2918" y="901" fill="#000000" font-family="source code pro" font-size="13px">return c.processor.Process(message)</text></switch></g><path d="M 196 657 L 240.63 657" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 245.88 657 L 238.88 660.5 L 240.63 657 L 238.88 653.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 897 657 L 964.63 657" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 969.88 657 L 962.88 660.5 L 964.63 657 L 962.88 653.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1317 657 L 1401.63 657" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1406.88 657 L 1399.88 660.5 L 1401.63 657 L 1399.88 653.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2027 657 L 2118.63 657" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2123.88 657 L 2116.88 660.5 L 2118.63 657 L 2116.88 653.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2457 657 L 2540.63 657" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2545.88 657 L 2538.88 660.5 L 2540.63 657 L 2538.88 653.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2887 707.5 L 2887.05 730.73 Q 2887.07 740.73 2877.07 740.73 L 2700 740.73 Q 2690 740.73 2690 750.73 L 2690 767.63" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2690 772.88 L 2686.5 765.88 L 2690 767.63 L 2693.5 765.88 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2833 804 L 2904.63 804" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2909.88 804 L 2902.88 807.5 L 2904.63 804 L 2902.88 800.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2827 897 L 2904.63 897" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2909.88 897 L 2902.88 900.5 L 2904.63 897 L 2902.88 893.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 737px; margin-left: 29px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">3. Process 中间件</div></div></div></foreignObject><text x="29" y="741" fill="#000000" font-family="source code pro" font-size="13px">3. Process 中间件</text></switch></g><rect x="27" y="784" width="295" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 814px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewRetryingProcessor(...)</div></div></div></foreignObject><text x="34" y="818" fill="#000000" font-family="source code pro" font-size="13px">func NewRetryingProcessor(...)</text></switch></g><rect x="397" y="775.5" width="665" height="77" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 658px; height: 1px; padding-top: 814px; margin-left: 404px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;retryDecorator{<br />    retryAttempts: m.Counter(metrics.Options{Name: "retry-attempts", Tags: nil}),<br />    processor:     processor,<br />}</div></div></div></foreignObject><text x="404" y="818" fill="#000000" font-family="source code pro" font-size="13px">return &amp;retryDecorator{...</text></switch></g><rect x="1137" y="774" width="299" height="60" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 292px; height: 1px; padding-top: 804px; margin-left: 1144px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Process(message processor.Message)</div></div></div></foreignObject><text x="1144" y="808" fill="#000000" font-family="source code pro" font-size="13px">Process(message processor.Message)</text></switch></g><rect x="1517" y="755.5" width="678" height="97" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 671px; height: 1px; padding-top: 804px; margin-left: 1524px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">err := d.processor.Process(message)<br />for attempts := uint(0); err != nil &amp;&amp; d.options.maxAttempts &gt; attempts; attempts++ {<br />    time.Sleep(d.computeInterval(attempts))<br />    err = d.processor.Process(message)<br />}</div></div></div></foreignObject><text x="1524" y="808" fill="#000000" font-family="source code pro" font-size="13px">err := d.processor.Process(message)...</text></switch></g><rect x="27" y="894.5" width="313" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 306px; height: 1px; padding-top: 925px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewCommittingProcessor(...)</div></div></div></foreignObject><text x="34" y="928" fill="#000000" font-family="source code pro" font-size="13px">func NewCommittingProcessor(...)</text></switch></g><rect x="424" y="881" width="246" height="87" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 239px; height: 1px; padding-top: 925px; margin-left: 431px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;comittingProcessor{<br />    processor: processor,<br />    marker:    marker,<br />}</div></div></div></foreignObject><text x="431" y="928" fill="#000000" font-family="source code pro" font-size="13px">return &amp;comittingProcessor{...</text></switch></g><rect x="1137" y="894.5" width="331" height="60" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 324px; height: 1px; padding-top: 925px; margin-left: 1144px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Process(message processor.Message)</div></div></div></foreignObject><text x="1144" y="928" fill="#000000" font-family="source code pro" font-size="13px">Process(message processor.Message)</text></switch></g><rect x="1548" y="871" width="352" height="107" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 345px; height: 1px; padding-top: 925px; margin-left: 1555px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">if msg, ok := message.(Message); ok {<br />    err := d.processor.Process(message)<br />    if err == nil {<br />        d.marker.MarkOffset(msg.Offset())<br />    }<br />}</div></div></div></foreignObject><text x="1555" y="928" fill="#000000" font-family="source code pro" font-size="13px">if msg, ok := message.(Message); ok {...</text></switch></g><rect x="27" y="1015" width="304" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 297px; height: 1px; padding-top: 1045px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewDecoratedProcessor(...)</div></div></div></foreignObject><text x="34" y="1049" fill="#000000" font-family="source code pro" font-size="13px">func NewDecoratedProcessor(...)</text></switch></g><rect x="405" y="1001.5" width="594" height="87" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 587px; height: 1px; padding-top: 1045px; margin-left: 412px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">m := f.Namespace(metrics.NSOptions{Name: "span-processor", Tags: nil})<br />return &amp;metricsDecorator{<br />    latency:   m.Timer(metrics.TimerOptions{Name: "latency", Tags: nil}),<br />    processor: processor,<br />}</div></div></div></foreignObject><text x="412" y="1049" fill="#000000" font-family="source code pro" font-size="13px">m := f.Namespace(metrics.NSOptions{Name: "span-processor", Tags: nil})...</text></switch></g><rect x="1137" y="1035" width="241" height="60" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 234px; height: 1px; padding-top: 1065px; margin-left: 1144px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Process(message Message)</div></div></div></foreignObject><text x="1144" y="1069" fill="#000000" font-family="source code pro" font-size="13px">Process(message Message)</text></switch></g><rect x="1472" y="1031.5" width="314" height="67" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 307px; height: 1px; padding-top: 1065px; margin-left: 1479px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">now := time.Now()<br />err := d.processor.Process(message)<br />d.latency.Record(time.Since(now))</div></div></div></foreignObject><text x="1479" y="1069" fill="#000000" font-family="source code pro" font-size="13px">now := time.Now()...</text></switch></g><rect x="27" y="1135.5" width="295" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 1166px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewParallelProcessor(...)</div></div></div></foreignObject><text x="34" y="1169" fill="#000000" font-family="source code pro" font-size="13px">func NewParallelProcessor(...)</text></switch></g><rect x="411" y="1122" width="319" height="87" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 312px; height: 1px; padding-top: 1166px; margin-left: 418px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;ParallelProcessor{<br />    messages:    make(chan Message),<br />    processor:   processor,<br />    numRoutines: parallelism,<br />}</div></div></div></foreignObject><text x="418" y="1169" fill="#000000" font-family="source code pro" font-size="13px">return &amp;ParallelProcessor{...</text></switch></g><rect x="411" y="1237" width="88" height="60" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 81px; height: 1px; padding-top: 1267px; margin-left: 418px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Start()</div></div></div></foreignObject><text x="418" y="1271" fill="#000000" font-family="source code pro" font-size="13px">Start()</text></switch></g><rect x="599" y="1218.5" width="312" height="97" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 305px; height: 1px; padding-top: 1267px; margin-left: 606px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for i := 0; i &lt; k.numRoutines; i++ {<br />    go func() {<br />        msg := &lt;-k.messages:<br />        k.processor.Process(msg)<br />    }()<br />}</div></div></div></foreignObject><text x="606" y="1271" fill="#000000" font-family="source code pro" font-size="13px">for i := 0; i &lt; k.numRoutines; i++ {...</text></switch></g><rect x="1137" y="1155.5" width="230" height="60" rx="6" ry="6" fill="#dae8fc" stroke="#6c8ebf" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 223px; height: 1px; padding-top: 1186px; margin-left: 1144px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Process(message Message)</div></div></div></foreignObject><text x="1144" y="1189" fill="#000000" font-family="source code pro" font-size="13px">Process(message Message)</text></switch></g><rect x="1427" y="1159.5" width="210" height="52" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 203px; height: 1px; padding-top: 1186px; margin-left: 1434px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">k.messages &lt;- message<br />return nil</div></div></div></foreignObject><text x="1434" y="1189" fill="#000000" font-family="source code pro" font-size="13px">k.messages &lt;- message...</text></switch></g><path d="M 322 814 L 390.63 814" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 395.88 814 L 388.88 817.5 L 390.63 814 L 388.88 810.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1436 804 L 1510.63 804" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1515.88 804 L 1508.88 807.5 L 1510.63 804 L 1508.88 800.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 340 924.5 L 417.63 924.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 422.88 924.5 L 415.88 928 L 417.63 924.5 L 415.88 921 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1468 924.5 L 1541.63 924.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1546.88 924.5 L 1539.88 928 L 1541.63 924.5 L 1539.88 921 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 331 1045 L 398.63 1045" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 403.88 1045 L 396.88 1048.5 L 398.63 1045 L 396.88 1041.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1378 1065 L 1465.63 1065" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1470.88 1065 L 1463.88 1068.5 L 1465.63 1065 L 1463.88 1061.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 322 1165.5 L 404.63 1165.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 409.88 1165.5 L 402.88 1169 L 404.63 1165.5 L 402.88 1162 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 499 1267 L 592.63 1267" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 597.88 1267 L 590.88 1270.5 L 592.63 1267 L 590.88 1263.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1367 1185.5 L 1420.63 1185.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1425.88 1185.5 L 1418.88 1189 L 1420.63 1185.5 L 1418.88 1182 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 766px; margin-left: 52px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">重试中间件</div></div></div></foreignObject><text x="52" y="769" fill="#000000" font-family="source code pro" font-size="13px">重试中间件</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 873px; margin-left: 52px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">提交中间件</div></div></div></foreignObject><text x="52" y="877" fill="#000000" font-family="source code pro" font-size="13px">提交中间件</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 992px; margin-left: 52px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">处理耗时中间件</div></div></div></foreignObject><text x="52" y="995" fill="#000000" font-family="source code pro" font-size="13px">处理耗时中间件</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1117px; margin-left: 52px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">并发处理中间件</div></div></div></foreignObject><text x="52" y="1121" fill="#000000" font-family="source code pro" font-size="13px">并发处理中间件</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 157px; margin-left: 29px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">创建存储器</div></div></div></foreignObject><text x="29" y="161" fill="#000000" font-family="source code pro" font-size="13px">创建存储器</text></switch></g><path d="M 1087 925 L 1102 925 Q 1112 925 1112 915 L 1112 814.07 Q 1112 804.07 1121.32 804.04 L 1130.63 804.02" fill="none" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1135.88 804 L 1128.89 807.52 L 1130.63 804.02 L 1128.87 800.52 Z" fill="#019ed5" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1087 925 L 1102 925 Q 1112 925 1112 924.73 L 1112 924.6 Q 1112 924.47 1121.32 924.48 L 1130.63 924.49" fill="none" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1135.88 924.5 L 1128.88 927.99 L 1130.63 924.49 L 1128.89 920.99 Z" fill="#019ed5" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1087 925 L 1102 925 Q 1112 925 1112 935 L 1112 1055 Q 1112 1065 1121.32 1065 L 1130.63 1065" fill="none" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1135.88 1065 L 1128.88 1068.5 L 1130.63 1065 L 1128.88 1061.5 Z" fill="#019ed5" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1087 925 L 1102 925 Q 1112 925 1112 935 L 1112 1175.53 Q 1112 1185.53 1121.32 1185.52 L 1130.63 1185.51" fill="none" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><path d="M 1135.88 1185.5 L 1128.89 1189.01 L 1130.63 1185.51 L 1128.88 1182.01 Z" fill="#019ed5" stroke="#019ed5" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 42px; margin-left: 29px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 18px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">Jaeger Ingester 实现</div></div></div></foreignObject><text x="29" y="47" fill="#000000" font-family="source code pro" font-size="18px">Jaeger Ingester 实现</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>