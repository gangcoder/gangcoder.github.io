<svg id="SvgjsSvg1006" width="1997.1689758300781" height="1385.8366394042969" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1068" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1069" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1072" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1073" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1076" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1077" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1092" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1093" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1144" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1145" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1310" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1311" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1314" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1315" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1318" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1319" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1322" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1323" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1326" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1327" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1388" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1389" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1392" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1393" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1396" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1397" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1400" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1401" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1404" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1405" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker><marker id="SvgjsMarker1410" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1411" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker><marker id="SvgjsMarker1414" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1415" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1430" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1431" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker></defs><g id="SvgjsG1008" transform="translate(84.67092386881515,463.95660485161676)"><path id="SvgjsPath1009" d="M 0 0L 176.03234310699585 0L 176.03234310699585 24.499999999999602L 0 24.499999999999602Z" stroke="none" fill="none"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="start" font-size="13px" width="177px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1012" dy="16" x="0"><tspan id="SvgjsTspan1013" style="text-decoration:;">go queueScanLoop</tspan></tspan></text></g></g><g id="SvgjsG1014" transform="translate(84.67092386881515,533.0954937405055)"><path id="SvgjsPath1015" d="M 0 0L 182.83333333333326 0L 182.83333333333326 34.80555555555554L 0 34.80555555555554Z" stroke="none" fill="none"></path><g id="SvgjsG1016"><text id="SvgjsText1017" font-family="微软雅黑" text-anchor="start" font-size="13px" width="183px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1018" dy="16" x="0"><tspan id="SvgjsTspan1019" style="text-decoration:;">go lookupLoop</tspan></tspan></text></g></g><g id="SvgjsG1020" transform="translate(84.67092386881515,588.3038270738383)"><path id="SvgjsPath1021" d="M 0 0L 217.02739197530863 0L 217.02739197530863 31.80555555555543L 0 31.80555555555543Z" stroke="none" fill="none"></path><g id="SvgjsG1022"><text id="SvgjsText1023" font-family="微软雅黑" text-anchor="start" font-size="13px" width="218px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1024" dy="16" x="0"><tspan id="SvgjsTspan1025" style="text-decoration:;">go statsdLoop</tspan></tspan></text></g></g><g id="SvgjsG1026" transform="translate(32.504257202148466,117.78299374050545)"><path id="SvgjsPath1027" d="M 0 0L 55.99999999999997 0L 55.99999999999997 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1028"><text id="SvgjsText1029" font-family="微软雅黑" text-anchor="start" font-size="13px" width="56px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1030" dy="16" x="0"><tspan id="SvgjsTspan1031" style="text-decoration:;">Main</tspan></tspan></text></g></g><g id="SvgjsG1032" transform="translate(84.67092386881515,240.67188262939453)"><path id="SvgjsPath1033" d="M 0 0L 648.3333333333333 0L 648.3333333333333 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1034"><text id="SvgjsText1035" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1036" dy="16" x="0"><tspan id="SvgjsTspan1037" style="text-decoration:;">go tcpListener</tspan></tspan></text></g></g><g id="SvgjsG1038" transform="translate(84.67092386881515,343.0609858529881)"><path id="SvgjsPath1039" d="M 0 0L 320.83333333333326 0L 320.83333333333326 21.148148148148152L 0 21.148148148148152Z" stroke="none" fill="none"></path><g id="SvgjsG1040"><text id="SvgjsText1041" font-family="微软雅黑" text-anchor="start" font-size="13px" width="321px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1042" dy="16" x="0"><tspan id="SvgjsTspan1043" style="text-decoration:;">go httpListener</tspan></tspan></text></g></g><g id="SvgjsG1044" transform="translate(635.754257202148,77.71123448124621)"><path id="SvgjsPath1045" d="M 0 0L 285.68055555555577 0L 285.68055555555577 154.66666666666669L 0 154.66666666666669Z" stroke="none" fill="none"></path><g id="SvgjsG1046"><text id="SvgjsText1047" font-family="微软雅黑" text-anchor="start" font-size="13px" width="286px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1048" dy="16" x="0"><tspan id="SvgjsTspan1049" style="text-decoration:;">&lt;/br&gt;type NSQD struct {&lt;/br&gt;    topicMap </tspan></tspan><tspan id="SvgjsTspan1050" dy="16" x="0"><tspan id="SvgjsTspan1051" style="text-decoration:;">map[string]*Topic&lt;/br&gt;    lookupPeers </tspan></tspan><tspan id="SvgjsTspan1052" dy="16" x="0"><tspan id="SvgjsTspan1053" style="text-decoration:;">atomic.Value&lt;/br&gt;&lt;/br&gt;    tcpListener   </tspan></tspan><tspan id="SvgjsTspan1054" dy="16" x="0"><tspan id="SvgjsTspan1055" style="text-decoration:;">net.Listener&lt;/br&gt;    httpListener  net.Listener	</tspan></tspan><tspan id="SvgjsTspan1056" dy="16" x="0"><tspan id="SvgjsTspan1057" style="text-decoration:;">&lt;/br&gt;&lt;/br&gt;    optsNotificationChan chan </tspan></tspan><tspan id="SvgjsTspan1058" dy="16" x="0"><tspan id="SvgjsTspan1059" style="text-decoration:;">struct{}&lt;/br&gt;    ci *clusterinfo.ClusterInfo&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1060" transform="translate(25.004257202148494,25.005215962727874)"><path id="SvgjsPath1061" d="M 0 0L 648.3333333333333 0L 648.3333333333333 49.66666666666667L 0 49.66666666666667Z" stroke="none" fill="none"></path><g id="SvgjsG1062"><text id="SvgjsText1063" font-family="微软雅黑" text-anchor="start" font-size="23px" width="649px" fill="#323232" font-weight="700" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="23px" weight="700" font-style="" opacity="1" y="-4.875" transform="rotate(0)"><tspan id="SvgjsTspan1064" dy="28" x="0"><tspan id="SvgjsTspan1065" style="text-decoration:;">NSQ nsqd</tspan></tspan></text></g></g><g id="SvgjsG1066"><path id="SvgjsPath1067" d="M76.33759053548187 272.8177159627288L394.0459238688151 272.8177159627288L394.0459238688151 272.8177159627288L711.7542572021484 272.8177159627288" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1068)"></path></g><g id="SvgjsG1070"><path id="SvgjsPath1071" d="M76.33759053548187 615.3177159627282L159.83759053548198 615.3177159627282L159.83759053548198 615.3177159627282L243.3375905354821 615.3177159627282" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1072)"></path></g><g id="SvgjsG1074"><path id="SvgjsPath1075" d="M76.33759053548187 556.8177159627287L158.587590535482 556.8177159627287L158.587590535482 556.8177159627287L240.83759053548215 556.8177159627287" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1076)"></path></g><g id="SvgjsG1078" transform="translate(527.2959238688145,316.5422529997647)"><path id="SvgjsPath1079" d="M 0 0L 171.38734567901315 0L 171.38734567901315 26.518732853223412L 0 26.518732853223412Z" stroke="none" fill="none"></path><g id="SvgjsG1080"><text id="SvgjsText1081" font-family="微软雅黑" text-anchor="start" font-size="13px" width="172px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1082" dy="16" x="0"><tspan id="SvgjsTspan1083" style="text-decoration:;">go messagePump</tspan></tspan></text></g></g><g id="SvgjsG1084" transform="translate(447.17092386881495,291.6533641108762)"><path id="SvgjsPath1085" d="M 0 0L 120.99999999999977 0L 120.99999999999977 24.88888888888846L 0 24.88888888888846Z" stroke="none" fill="none"></path><g id="SvgjsG1086"><text id="SvgjsText1087" font-family="微软雅黑" text-anchor="start" font-size="13px" width="121px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1088" dy="16" x="0"><tspan id="SvgjsTspan1089" style="text-decoration:;">IOLoop</tspan></tspan></text></g></g><g id="SvgjsG1090"><path id="SvgjsPath1091" d="M512.180183128074 336.9633349613561L810.8422201651113 336.9633349613561L810.8422201651113 336.9633349613561L1109.5042572021484 336.9633349613561" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1092)"></path></g><g id="SvgjsG1094" transform="translate(521.837590535482,373.23438262939464)"><path id="SvgjsPath1095" d="M 0 0L 648.3333333333333 0L 648.3333333333333 59.16666666666663L 0 59.16666666666663Z" stroke="none" fill="none"></path><g id="SvgjsG1096"><text id="SvgjsText1097" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1098" dy="16" x="0"><tspan id="SvgjsTspan1099" style="text-decoration:;">client.Reader.ReadSlice('\n')&lt;/br&gt;response, err = p.Exec(client, params)&lt;/br&gt;p.Send(client, </tspan></tspan><tspan id="SvgjsTspan1100" dy="16" x="0"><tspan id="SvgjsTspan1101" style="text-decoration:;">frameTypeResponse, response)</tspan></tspan></text></g></g><g id="SvgjsG1102" transform="translate(747.3352757206667,463.95660485161676)"><path id="SvgjsPath1103" d="M 0 0L 260.43981481481546 0L 260.43981481481546 33.33333333333377L 0 33.33333333333377Z" stroke="none" fill="none"></path><g id="SvgjsG1104"><text id="SvgjsText1105" font-family="微软雅黑" text-anchor="start" font-size="13px" width="261px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1106" dy="16" x="0"><tspan id="SvgjsTspan1107" style="text-decoration:;">IDENTIFY / RDY / PUB</tspan></tspan></text></g></g><g id="SvgjsG1108" transform="translate(747.3352757206667,497.17188262939476)"><path id="SvgjsPath1109" d="M 0 0L 422.8356481481485 0L 422.8356481481485 50.49999999999977L 0 50.49999999999977Z" stroke="none" fill="none"></path><g id="SvgjsG1110"><text id="SvgjsText1111" font-family="微软雅黑" text-anchor="start" font-size="13px" width="423px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1112" dy="16" x="0"><tspan id="SvgjsTspan1113" style="text-decoration:;">SUB:&lt;/br&gt;topic := p.ctx.nsqd.GetTopic(topicName)&lt;/br&gt;channel = </tspan></tspan><tspan id="SvgjsTspan1114" dy="16" x="0"><tspan id="SvgjsTspan1115" style="text-decoration:;">topic.GetChannel(channelName)&lt;/br&gt;client.Channel = </tspan></tspan><tspan id="SvgjsTspan1116" dy="16" x="0"><tspan id="SvgjsTspan1117" style="text-decoration:;">channel&lt;/br&gt;client.SubEventChan &lt;- channel&lt;/br&gt;</tspan></tspan></text></g></g><g id="SvgjsG1118" transform="translate(748.064442387333,601.0954937405054)"><path id="SvgjsPath1119" d="M 0 0L 422.1064814814822 0L 422.1064814814822 68.61805555555486L 0 68.61805555555486Z" stroke="none" fill="none"></path><g id="SvgjsG1120"><text id="SvgjsText1121" font-family="微软雅黑" text-anchor="start" font-size="13px" width="423px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1122" dy="16" x="0"><tspan id="SvgjsTspan1123" style="text-decoration:;">PUB: &lt;/br&gt;p.ctx.nsqd.GetTopic(topicName)&lt;/br&gt;msg := </tspan></tspan><tspan id="SvgjsTspan1124" dy="16" x="0"><tspan id="SvgjsTspan1125" style="text-decoration:;">NewMessage(topic.GenerateID(), messageBody)</tspan></tspan><tspan id="SvgjsTspan1126" dy="16" x="0"><tspan id="SvgjsTspan1127" style="text-decoration:;">&lt;/br&gt;topic.PutMessage(msg)</tspan></tspan></text></g></g><g id="SvgjsG1128" transform="translate(938.3318034984436,228.43114188865457)"><path id="SvgjsPath1129" d="M 0 0L 417.538194444445 0L 417.538194444445 103.99999999999932L 0 103.99999999999932Z" stroke="none" fill="none"></path><g id="SvgjsG1130"><text id="SvgjsText1131" font-family="微软雅黑" text-anchor="start" font-size="13px" width="418px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1132" dy="16" x="0"><tspan id="SvgjsTspan1133" style="text-decoration:;">subChannel = &lt;-subEventChan&lt;/br&gt;memoryMsgChan = </tspan></tspan><tspan id="SvgjsTspan1134" dy="16" x="0"><tspan id="SvgjsTspan1135" style="text-decoration:;">subChannel.memoryMsgChan&lt;/br&gt;msg := &lt;-</tspan></tspan><tspan id="SvgjsTspan1136" dy="16" x="0"><tspan id="SvgjsTspan1137" style="text-decoration:;">memoryMsgChan&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1138" dy="16" x="0"><tspan id="SvgjsTspan1139" style="text-decoration:;">&lt;/br&gt;subChannel.StartInFlightTimeout(msg, client.ID, </tspan></tspan><tspan id="SvgjsTspan1140" dy="16" x="0"><tspan id="SvgjsTspan1141" style="text-decoration:;">msgTimeout)&lt;/br&gt;p.SendMessage(client, msg)</tspan></tspan></text></g></g><g id="SvgjsG1142"><path id="SvgjsPath1143" d="M76.33759053548187 371.15104929606235L232.92092386881518 371.15104929606235L232.92092386881518 371.15104929606235L389.50425720214844 371.15104929606235" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1144)"></path></g><g id="SvgjsG1146" transform="translate(251.33759053548192,376.1718826293949)"><path id="SvgjsPath1147" d="M 0 0L 205.16666666666652 0L 205.16666666666652 23.49999999999966L 0 23.49999999999966Z" stroke="none" fill="none"></path><g id="SvgjsG1148"><text id="SvgjsText1149" font-family="微软雅黑" text-anchor="start" font-size="13px" width="206px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1150" dy="16" x="0"><tspan id="SvgjsTspan1151" style="text-decoration:;">newHTTPServer</tspan></tspan></text></g></g><g id="SvgjsG1152" transform="translate(312.1709238688152,416.06077151828407)"><path id="SvgjsPath1153" d="M 0 0L 158.6666666666664 0L 158.6666666666664 24.923611111110688L 0 24.923611111110688Z" stroke="none" fill="none"></path><g id="SvgjsG1154"><text id="SvgjsText1155" font-family="微软雅黑" text-anchor="start" font-size="13px" width="159px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1156" dy="16" x="0"><tspan id="SvgjsTspan1157" style="text-decoration:;">router.Handle</tspan></tspan></text></g></g><g id="SvgjsG1158" transform="translate(347.6153683132594,472.0538270738391)"><path id="SvgjsPath1159" d="M 0 0L 331.888888888889 0L 331.888888888889 106.24999999999909L 0 106.24999999999909Z" stroke="none" fill="none"></path><g id="SvgjsG1160"><text id="SvgjsText1161" font-family="微软雅黑" text-anchor="start" font-size="13px" width="332px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1162" dy="16" x="0"><tspan id="SvgjsTspan1163" style="text-decoration:;">doPUB:&lt;/br&gt;p.ctx.nsqd.GetTopic(topicName)</tspan></tspan><tspan id="SvgjsTspan1164" dy="16" x="0"><tspan id="SvgjsTspan1165" style="text-decoration:;">&lt;/br&gt;msg := NewMessage(topic.GenerateID(), body)</tspan></tspan><tspan id="SvgjsTspan1166" dy="16" x="0"><tspan id="SvgjsTspan1167" style="text-decoration:;">&lt;/br&gt;	&lt;/br&gt;//将消息投送到topic 中&lt;/br&gt;err = </tspan></tspan><tspan id="SvgjsTspan1168" dy="16" x="0"><tspan id="SvgjsTspan1169" style="text-decoration:;">topic.PutMessage(msg)</tspan></tspan></text></g></g><g id="SvgjsG1170" transform="translate(310.837590535482,709.1996604071729)"><path id="SvgjsPath1171" d="M 0 0L 246.45833333333246 0L 246.45833333333246 55.4722222222216L 0 55.4722222222216Z" stroke="none" fill="none"></path><g id="SvgjsG1172"><text id="SvgjsText1173" font-family="微软雅黑" text-anchor="start" font-size="13px" width="247px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1174" dy="16" x="0"><tspan id="SvgjsTspan1175" style="text-decoration:;">topic.PutMessage(msg)&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1176" dy="16" x="0"><tspan id="SvgjsTspan1177" style="text-decoration:;">&lt;/br&gt;t.memoryMsgChan &lt;- m</tspan></tspan></text></g></g><g id="SvgjsG1178" transform="translate(29.39314609103849,762.1718826293941)"><path id="SvgjsPath1179" d="M 0 0L 149.11111111110995 0L 149.11111111110995 30.500000000000455L 0 30.500000000000455Z" stroke="none" fill="none"></path><g id="SvgjsG1180"><text id="SvgjsText1181" font-family="微软雅黑" text-anchor="start" font-size="13px" width="150px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1182" dy="16" x="0"><tspan id="SvgjsTspan1183" style="text-decoration:;">GetTopic</tspan></tspan></text></g></g><g id="SvgjsG1184" transform="translate(134.33759053548192,856.2899381849501)"><path id="SvgjsPath1185" d="M 0 0L 648.3333333333333 0L 648.3333333333333 26.5L 0 26.5Z" stroke="none" fill="none"></path><g id="SvgjsG1186"><text id="SvgjsText1187" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1188" dy="16" x="0"><tspan id="SvgjsTspan1189" style="text-decoration:;">go messagePump</tspan></tspan></text></g></g><g id="SvgjsG1190" transform="translate(365.8375905354817,894.6718826293942)"><path id="SvgjsPath1191" d="M 0 0L 283.6666666666663 0L 283.6666666666663 101.00000000000034L 0 101.00000000000034Z" stroke="none" fill="none"></path><g id="SvgjsG1192"><text id="SvgjsText1193" font-family="微软雅黑" text-anchor="start" font-size="13px" width="284px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1194" dy="16" x="0"><tspan id="SvgjsTspan1195" style="text-decoration:;">memoryMsgChan = </tspan></tspan><tspan id="SvgjsTspan1196" dy="16" x="0"><tspan id="SvgjsTspan1197" style="text-decoration:;">t.memoryMsgChan&lt;/br&gt;msg = &lt;-</tspan></tspan><tspan id="SvgjsTspan1198" dy="16" x="0"><tspan id="SvgjsTspan1199" style="text-decoration:;">memoryMsgChan&lt;/br&gt;&lt;/br&gt;for i, channel </tspan></tspan><tspan id="SvgjsTspan1200" dy="16" x="0"><tspan id="SvgjsTspan1201" style="text-decoration:;">:= range chans {&lt;/br&gt;    err := </tspan></tspan><tspan id="SvgjsTspan1202" dy="16" x="0"><tspan id="SvgjsTspan1203" style="text-decoration:;">channel.PutMessage(chanMsg)&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1204" transform="translate(451.8180592854816,1051.755215962728)"><path id="SvgjsPath1205" d="M 0 0L 271.33333333333337 0L 271.33333333333337 26.416666666666515L 0 26.416666666666515Z" stroke="none" fill="none"></path><g id="SvgjsG1206"><text id="SvgjsText1207" font-family="微软雅黑" text-anchor="start" font-size="13px" width="272px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1208" dy="16" x="0"><tspan id="SvgjsTspan1209" style="text-decoration:;">(c *Channel) PutMessage(m *Message)</tspan></tspan></text></g></g><g id="SvgjsG1210" transform="translate(451.8180592854816,1078.1718826293945)"><path id="SvgjsPath1211" d="M 0 0L 236.5 0L 236.5 26.583333333334167L 0 26.583333333334167Z" stroke="none" fill="none"></path><g id="SvgjsG1212"><text id="SvgjsText1213" font-family="微软雅黑" text-anchor="start" font-size="13px" width="237px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1214" dy="16" x="0"><tspan id="SvgjsTspan1215" style="text-decoration:;">c.memoryMsgChan &lt;- m:</tspan></tspan></text></g></g><g id="SvgjsG1216" transform="translate(1170.1709238688152,383.23438262939464)"><path id="SvgjsPath1217" d="M 0 0L 648.3333333333333 0L 648.3333333333333 131L 0 131Z" stroke="none" fill="none"></path><g id="SvgjsG1218"><text id="SvgjsText1219" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1220" dy="16" x="0"><tspan id="SvgjsTspan1221" style="text-decoration:;">go queueScanLoop</tspan></tspan></text></g></g><g id="SvgjsG1222" transform="translate(1217.837590535482,429.65104929606207)"><path id="SvgjsPath1223" d="M 0 0L 648.3333333333333 0L 648.3333333333333 28.833333333332916L 0 28.833333333332916Z" stroke="none" fill="none"></path><g id="SvgjsG1224"><text id="SvgjsText1225" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1226" dy="16" x="0"><tspan id="SvgjsTspan1227" style="text-decoration:;">n.resizePool(len(channels), workCh, responseCh, closeCh)</tspan></tspan></text></g></g><g id="SvgjsG1228" transform="translate(1264.566757202148,468.484382629395)"><path id="SvgjsPath1229" d="M 0 0L 234.93750000000045 0L 234.93750000000045 28.687499999999773L 0 28.687499999999773Z" stroke="none" fill="none"></path><g id="SvgjsG1230"><text id="SvgjsText1231" font-family="微软雅黑" text-anchor="start" font-size="13px" width="235px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1232" dy="16" x="0"><tspan id="SvgjsTspan1233" style="text-decoration:;">queueScanWorker</tspan></tspan></text></g></g><g id="SvgjsG1234" transform="translate(1170.1709238688152,627.484382629395)"><path id="SvgjsPath1235" d="M 0 0L 299.33333333333326 0L 299.33333333333326 31.187499999999545L 0 31.187499999999545Z" stroke="none" fill="none"></path><g id="SvgjsG1236"><text id="SvgjsText1237" font-family="微软雅黑" text-anchor="start" font-size="13px" width="300px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1238" dy="16" x="0"><tspan id="SvgjsTspan1239" style="text-decoration:;">go lookupLoop</tspan></tspan></text></g></g><g id="SvgjsG1240" transform="translate(1324.1709238688154,502.0538270738391)"><path id="SvgjsPath1241" d="M 0 0L 648.3333333333333 0L 648.3333333333333 86.2499999999992L 0 86.2499999999992Z" stroke="none" fill="none"></path><g id="SvgjsG1242"><text id="SvgjsText1243" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1244" dy="16" x="0"><tspan id="SvgjsTspan1245" style="text-decoration:;">//处理 in-flight 队列任务&lt;/br&gt;c.processInFlightQueue(now)&lt;/br&gt;&lt;/br&gt;//处理 延迟队列任务</tspan></tspan><tspan id="SvgjsTspan1246" dy="16" x="0"><tspan id="SvgjsTspan1247" style="text-decoration:;">&lt;/br&gt;c.processDeferredQueue(now)</tspan></tspan></text></g></g><g id="SvgjsG1248" transform="translate(1217.837590535482,675.1510492960615)"><path id="SvgjsPath1249" d="M 0 0L 580.6666666666665 0L 580.6666666666665 30.52083333333303L 0 30.52083333333303Z" stroke="none" fill="none"></path><g id="SvgjsG1250"><text id="SvgjsText1251" font-family="微软雅黑" text-anchor="start" font-size="13px" width="581px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1252" dy="16" x="0"><tspan id="SvgjsTspan1253" style="text-decoration:;">newLookupPeer(host, n.getOpts().MaxBodySize, n.logf, connectCallback(n, hostname))</tspan></tspan></text></g></g><g id="SvgjsG1254" transform="translate(1217.837590535482,701.817715962728)"><path id="SvgjsPath1255" d="M 0 0L 648.3333333333333 0L 648.3333333333333 25.66666666666697L 0 25.66666666666697Z" stroke="none" fill="none"></path><g id="SvgjsG1256"><text id="SvgjsText1257" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1258" dy="16" x="0"><tspan id="SvgjsTspan1259" style="text-decoration:;">ticker cmd := nsq.Ping()</tspan></tspan></text></g></g><g id="SvgjsG1260" transform="translate(1170.1709238688152,822.9566048516172)"><path id="SvgjsPath1261" d="M 0 0L 247.33333333333326 0L 247.33333333333326 24.715277777777374L 0 24.715277777777374Z" stroke="none" fill="none"></path><g id="SvgjsG1262"><text id="SvgjsText1263" font-family="微软雅黑" text-anchor="start" font-size="13px" width="248px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1264" dy="16" x="0"><tspan id="SvgjsTspan1265" style="text-decoration:;">go statsdLoop</tspan></tspan></text></g></g><g id="SvgjsG1266" transform="translate(1217.837590535482,738.1510492960617)"><path id="SvgjsPath1267" d="M 0 0L 230.66666666666652 0L 230.66666666666652 30.520833333332803L 0 30.520833333332803Z" stroke="none" fill="none"></path><g id="SvgjsG1268"><text id="SvgjsText1269" font-family="微软雅黑" text-anchor="start" font-size="13px" width="231px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1270" dy="16" x="0"><tspan id="SvgjsTspan1271" style="text-decoration:;">val := &lt;-n.notifyChan</tspan></tspan></text></g></g><g id="SvgjsG1272" transform="translate(1217.837590535482,868.5954937405056)"><path id="SvgjsPath1273" d="M 0 0L 648.3333333333333 0L 648.3333333333333 34.88888888888914L 0 34.88888888888914Z" stroke="none" fill="none"></path><g id="SvgjsG1274"><text id="SvgjsText1275" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1276" dy="16" x="0"><tspan id="SvgjsTspan1277" style="text-decoration:;">conn, err := net.DialTimeout("udp", addr, time.Second)</tspan></tspan></text></g></g><g id="SvgjsG1278" transform="translate(1217.837590535482,894.3454937405061)"><path id="SvgjsPath1279" d="M 0 0L 401.6666666666665 0L 401.6666666666665 32.32638888888846L 0 32.32638888888846Z" stroke="none" fill="none"></path><g id="SvgjsG1280"><text id="SvgjsText1281" font-family="微软雅黑" text-anchor="start" font-size="13px" width="402px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1282" dy="16" x="0"><tspan id="SvgjsTspan1283" style="text-decoration:;">stats := n.GetStats("", "")</tspan></tspan></text></g></g><g id="SvgjsG1284" transform="translate(68.17092386881518,822.9566048516172)"><path id="SvgjsPath1285" d="M 0 0L 648.3333333333333 0L 648.3333333333333 33.33333333333292L 0 33.33333333333292Z" stroke="none" fill="none"></path><g id="SvgjsG1286"><text id="SvgjsText1287" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1288" dy="16" x="0"><tspan id="SvgjsTspan1289" style="text-decoration:;">NewTopic(topicName, &amp;context{n}, deleteCallback)</tspan></tspan></text></g></g><g id="SvgjsG1290" transform="translate(126.17092386881524,900.0052159627269)"><path id="SvgjsPath1291" d="M 0 0L 154.3333333333332 0L 154.3333333333332 26.666666666667652L 0 26.666666666667652Z" stroke="none" fill="none"></path><g id="SvgjsG1292"><text id="SvgjsText1293" font-family="微软雅黑" text-anchor="start" font-size="13px" width="155px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1294" dy="16" x="0"><tspan id="SvgjsTspan1295" style="text-decoration:;">t.ctx.nsqd.Notify(t)</tspan></tspan></text></g></g><g id="SvgjsG1296" transform="translate(707.5366646095554,882.7899381849501)"><path id="SvgjsPath1297" d="M 0 0L 306.16666666666674 0L 306.16666666666674 91.47916666666686L 0 91.47916666666686Z" stroke="none" fill="none"></path><g id="SvgjsG1298"><text id="SvgjsText1299" font-family="微软雅黑" text-anchor="start" font-size="13px" width="307px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1300" dy="16" x="0"><tspan id="SvgjsTspan1301" style="text-decoration:;">type Topic struct {&lt;/br&gt;    messageCount </tspan></tspan><tspan id="SvgjsTspan1302" dy="16" x="0"><tspan id="SvgjsTspan1303" style="text-decoration:;">uint64&lt;/br&gt;    channelMap        </tspan></tspan><tspan id="SvgjsTspan1304" dy="16" x="0"><tspan id="SvgjsTspan1305" style="text-decoration:;">map[string]*Channel&lt;/br&gt;    memoryMsgChan     </tspan></tspan><tspan id="SvgjsTspan1306" dy="16" x="0"><tspan id="SvgjsTspan1307" style="text-decoration:;">chan *Message&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1308"><path id="SvgjsPath1309" d="M124.00425720214821 880.1718826293937L371.2542572021483 880.1718826293937L371.2542572021483 880.1718826293937L618.5042572021484 880.1718826293937" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1310)"></path></g><g id="SvgjsG1312"><path id="SvgjsPath1313" d="M76.33759053548187 495.81771596272847L159.087590535482 495.81771596272847L159.087590535482 495.81771596272847L241.83759053548215 495.81771596272847" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1314)"></path></g><g id="SvgjsG1316"><path id="SvgjsPath1317" d="M1160.2464447021484 406.6432367960624L1316.8297780354817 406.6432367960624L1316.8297780354817 406.6432367960624L1473.413111368815 406.6432367960624" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1318)"></path></g><g id="SvgjsG1320"><path id="SvgjsPath1321" d="M1160.2464447021484 653.8828201293945L1316.8297780354817 653.8828201293945L1316.8297780354817 653.8828201293945L1473.413111368815 653.8828201293945" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1322)"></path></g><g id="SvgjsG1324"><path id="SvgjsPath1325" d="M1160.2464447021484 850.1328201293945L1316.8297780354817 850.1328201293945L1316.8297780354817 850.1328201293945L1473.413111368815 850.1328201293945" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1326)"></path></g><g id="SvgjsG1328" transform="translate(68.17092386881518,1131.2552159627264)"><path id="SvgjsPath1329" d="M 0 0L 593.3333333333333 0L 593.3333333333333 20.416666666668107L 0 20.416666666668107Z" stroke="none" fill="none"></path><g id="SvgjsG1330"><text id="SvgjsText1331" font-family="微软雅黑" text-anchor="start" font-size="13px" width="594px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1332" dy="16" x="0"><tspan id="SvgjsTspan1333" style="text-decoration:;">channelNames, err := n.ci.GetLookupdTopicChannels(t.name, lookupdHTTPAddrs)</tspan></tspan></text></g></g><g id="SvgjsG1334" transform="translate(68.17092386881518,1174.6718826293936)"><path id="SvgjsPath1335" d="M 0 0L 648.3333333333333 0L 648.3333333333333 28.416666666666515L 0 28.416666666666515Z" stroke="none" fill="none"></path><g id="SvgjsG1336"><text id="SvgjsText1337" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1338" dy="16" x="0"><tspan id="SvgjsTspan1339" style="text-decoration:;">t.GetChannel(channelName)</tspan></tspan></text></g></g><g id="SvgjsG1340" transform="translate(126.1709238688153,1217.0052159627269)"><path id="SvgjsPath1341" d="M 0 0L 648.3333333333333 0L 648.3333333333333 30.666666666667652L 0 30.666666666667652Z" stroke="none" fill="none"></path><g id="SvgjsG1342"><text id="SvgjsText1343" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1344" dy="16" x="0"><tspan id="SvgjsTspan1345" style="text-decoration:;">channel = NewChannel(t.name, channelName, t.ctx, deleteCallback)</tspan></tspan></text></g></g><g id="SvgjsG1346" transform="translate(168.50425720214844,1269.0052159627269)"><path id="SvgjsPath1347" d="M 0 0L 648.3333333333333 0L 648.3333333333333 31.833333333332916L 0 31.833333333332916Z" stroke="none" fill="none"></path><g id="SvgjsG1348"><text id="SvgjsText1349" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1350" dy="16" x="0"><tspan id="SvgjsTspan1351" style="text-decoration:;">c.initPQ()</tspan></tspan></text></g></g><g id="SvgjsG1352" transform="translate(168.50425720214844,1303.0052159627269)"><path id="SvgjsPath1353" d="M 0 0L 648.3333333333333 0L 648.3333333333333 31.833333333332916L 0 31.833333333332916Z" stroke="none" fill="none"></path><g id="SvgjsG1354"><text id="SvgjsText1355" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1356" dy="16" x="0"><tspan id="SvgjsTspan1357" style="text-decoration:;">c.ctx.nsqd.Notify(c)</tspan></tspan></text></g></g><g id="SvgjsG1358" transform="translate(707.5366646095554,1131.2552159627264)"><path id="SvgjsPath1359" d="M 0 0L 648.3333333333333 0L 648.3333333333333 177.66666666666652L 0 177.66666666666652Z" stroke="none" fill="none"></path><g id="SvgjsG1360"><text id="SvgjsText1361" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1362" dy="16" x="0"><tspan id="SvgjsTspan1363" style="text-decoration:;">type Channel struct {&lt;/br&gt;    requeueCount uint64&lt;/br&gt;    messageCount uint64&lt;/br&gt;&lt;/br&gt;    backend </tspan></tspan><tspan id="SvgjsTspan1364" dy="16" x="0"><tspan id="SvgjsTspan1365" style="text-decoration:;">BackendQueue&lt;/br&gt;    memoryMsgChan chan *Message&lt;/br&gt;&lt;/br&gt;    deferredPQ       </tspan></tspan><tspan id="SvgjsTspan1366" dy="16" x="0"><tspan id="SvgjsTspan1367" style="text-decoration:;">pqueue.PriorityQueue&lt;/br&gt;    inFlightPQ       inFlightPqueue&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1368" transform="translate(360.5667572021483,243.76447522198777)"><path id="SvgjsPath1369" d="M 0 0L 120.99999999999977 0L 120.99999999999977 24.88888888888846L 0 24.88888888888846Z" stroke="none" fill="none"></path><g id="SvgjsG1370"><text id="SvgjsText1371" font-family="微软雅黑" text-anchor="start" font-size="13px" width="121px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1372" dy="16" x="0"><tspan id="SvgjsTspan1373" style="text-decoration:;">protocolV2</tspan></tspan></text></g></g><g id="SvgjsG1374"><path id="SvgjsPath1375" d="M57.50425720214844 168.19966040717293L57.50425720214844 404.6996604071729L57.50425720214844 404.6996604071729L57.50425720214844 641.1996604071729" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1376"><path id="SvgjsPath1377" d="M335.50425720214844 443.67188262939453L335.50425720214844 501.668410407172L335.50425720214844 501.668410407172L335.50425720214844 559.6649381849495" stroke="#4d9900" stroke-width="1" fill="none"></path></g><g id="SvgjsG1378"><path id="SvgjsPath1379" d="M731.5042572021484 444.9079937405061L731.5042572021484 529.9079937405061L731.5042572021484 529.9079937405061L731.5042572021484 614.9079937405061" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1380"><path id="SvgjsPath1381" d="M1313.5042572021484 493.1996604071729L1313.5042572021484 539.1996604071729L1313.5042572021484 539.1996604071729L1313.5042572021484 585.1996604071729" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1382"><path id="SvgjsPath1383" d="M55.50425720214844 793.9079937405061L55.50425720214844 990.4079937405061L55.50425720214844 990.4079937405061L55.50425720214844 1186.907993740506" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1384"><path id="SvgjsPath1385" d="M158.50425720214844 1241.907993740506L158.50425720214844 1273.907993740506L158.50425720214844 1273.907993740506L158.50425720214844 1305.907993740506" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1386"><path id="SvgjsPath1387" d="M431.50425720214844 600.6718826293945L431.50425720214844 646.1718826293945L431.50425720214844 646.1718826293945L431.50425720214844 691.6718826293945" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1388)"></path></g><g id="SvgjsG1390"><path id="SvgjsPath1391" d="M735.5042572021484 658.6718826293945L607.5042572021484 658.6718826293945L607.5042572021484 751.6718826293945L479.50425720214844 751.6718826293945" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1392)"></path></g><g id="SvgjsG1394"><path id="SvgjsPath1395" d="M432.50425720214844 764.6718826293945L432.50425720214844 828.1718826293945L432.50425720214844 828.1718826293945L432.50425720214844 891.6718826293945" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1396)"></path></g><g id="SvgjsG1398"><path id="SvgjsPath1399" d="M527.5042572021484 988.6718826293945L527.5042572021484 1017.1718826293945L527.5042572021484 1017.1718826293945L527.5042572021484 1045.6718826293945" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1400)"></path></g><g id="SvgjsG1402"><path id="SvgjsPath1403" d="M658.5042572021484 1039.6718826293945L658.5042572021484 771.0978085553204L1118.5042572021484 771.0978085553204L1118.5042572021484 342.5237344812464" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1404)"></path></g><g id="SvgjsG1406"><path id="SvgjsPath1407" d="M495.50425720214844 327.1996604071729L495.50425720214844 374.6996604071729L495.50425720214844 374.6996604071729L495.50425720214844 422.1996604071729" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1408"><path id="SvgjsPath1409" d="M922.5631764729816 308.67188262939453L822.158716837565 308.67188262939453L822.158716837565 272.42188262939453L721.7542572021484 272.42188262939453" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1410)"></path></g><g id="SvgjsG1412"><path id="SvgjsPath1413" d="M678.5042572021484 288.67188262939453L678.5042572021484 328.67188262939453L678.5042572021484 328.67188262939453L678.5042572021484 368.67188262939453" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1414)"></path></g><g id="SvgjsG1416" transform="translate(151.17092386881524,931.8385492960605)"><path id="SvgjsPath1417" d="M 0 0L 154.3333333333332 0L 154.3333333333332 26.666666666667652L 0 26.666666666667652Z" stroke="none" fill="none"></path><g id="SvgjsG1418"><text id="SvgjsText1419" font-family="微软雅黑" text-anchor="start" font-size="13px" width="155px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1420" dy="16" x="0"><tspan id="SvgjsTspan1421" style="text-decoration:;">n.notifyChan &lt;- v</tspan></tspan></text></g></g><g id="SvgjsG1422" transform="translate(206.23342386881512,1334.8385492960597)"><path id="SvgjsPath1423" d="M 0 0L 154.3333333333332 0L 154.3333333333332 26.666666666667652L 0 26.666666666667652Z" stroke="none" fill="none"></path><g id="SvgjsG1424"><text id="SvgjsText1425" font-family="微软雅黑" text-anchor="start" font-size="13px" width="155px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1426" dy="16" x="0"><tspan id="SvgjsTspan1427" style="text-decoration:;">n.notifyChan &lt;- v</tspan></tspan></text></g></g><g id="SvgjsG1428"><path id="SvgjsPath1429" d="M329.50425720214844 1343.6718826293945L1142.5042572021484 1343.6718826293945L1142.5042572021484 746.6718826293945L1199.5042572021484 746.6718826293945" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1430)"></path></g></svg>