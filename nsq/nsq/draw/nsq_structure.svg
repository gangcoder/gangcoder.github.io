<svg id="SvgjsSvg1006" width="3918.1390686035156" height="2028.2073364257812" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:svgjs="http://svgjs.com/svgjs"><defs id="SvgjsDefs1007"><marker id="SvgjsMarker1130" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1131" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1134" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1135" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1208" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1209" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1212" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1213" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1216" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1217" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1232" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1233" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1284" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1285" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1442" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1443" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1446" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1447" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1450" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1451" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1454" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1455" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1458" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1459" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1514" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1515" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1518" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1519" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1522" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1523" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1526" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1527" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1530" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1531" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker><marker id="SvgjsMarker1536" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1537" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker><marker id="SvgjsMarker1540" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1541" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1678" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1679" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1682" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1683" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1686" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1687" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1710" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1711" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker><marker id="SvgjsMarker1714" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1715" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1720" markerWidth="12" markerHeight="8" refX="3" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1721" d="M12,0 L0,4 L12,8 L12,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1730" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1731" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1764" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1765" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1800" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1801" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1810" markerWidth="16" markerHeight="16" refX="3" refY="8" viewBox="0 0 16 16" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><circle id="SvgjsCircle1811" r="4" cx="8" cy="8" fill="#323232" stroke="#323232" stroke-width="1"></circle></marker><marker id="SvgjsMarker1902" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1903" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1906" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1907" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1910" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1911" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1914" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1915" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker><marker id="SvgjsMarker1918" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1919" d="M0,0 L12,4 L0,8 L0,0" fill="#ff6666" stroke="#ff6666" stroke-width="1"></path></marker><marker id="SvgjsMarker1922" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1923" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker><marker id="SvgjsMarker1964" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1965" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1974" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1975" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1984" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1985" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker1994" markerWidth="14" markerHeight="10" refX="10" refY="5" viewBox="0 0 14 10" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath1995" d="M0,0 L14,5 L0,10 L0,0" fill="#323232" stroke="#323232" stroke-width="1"></path></marker><marker id="SvgjsMarker2010" markerWidth="12" markerHeight="8" refX="9" refY="4" viewBox="0 0 12 8" orient="auto" markerUnits="userSpaceOnUse" stroke-dasharray="0,0"><path id="SvgjsPath2011" d="M0,0 L12,4 L0,8 L0,0" fill="#6666ff" stroke="#6666ff" stroke-width="1"></path></marker></defs><g id="SvgjsG1008" transform="translate(1408.3041375146515,196.006433847986)"><path id="SvgjsPath1009" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1010"><text id="SvgjsText1011" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1012" dy="16" x="0"><tspan id="SvgjsTspan1013" style="text-decoration:;">go tcpListener</tspan></tspan></text></g></g><g id="SvgjsG1014" transform="translate(1557.3041375146515,350.006433847986)"><path id="SvgjsPath1015" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1016"><text id="SvgjsText1017" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1018" dy="16" x="0"><tspan id="SvgjsTspan1019" style="text-decoration:;">newHTTPServer</tspan></tspan></text></g></g><g id="SvgjsG1020" transform="translate(1408.3041375146515,307.006433847986)"><path id="SvgjsPath1021" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1022"><text id="SvgjsText1023" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1024" dy="16" x="0"><tspan id="SvgjsTspan1025" style="text-decoration:;">go httpListener</tspan></tspan></text></g></g><g id="SvgjsG1026" transform="translate(1612.3041375146515,385.00643384798605)"><path id="SvgjsPath1027" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1028"><text id="SvgjsText1029" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1030" dy="16" x="0"><tspan id="SvgjsTspan1031" style="text-decoration:;">router.Handle</tspan></tspan></text></g></g><g id="SvgjsG1032" transform="translate(1767.3041375146515,192.006433847986)"><path id="SvgjsPath1033" d="M 0 0L 367 0L 367 74L 0 74Z" stroke="none" fill="none"></path><g id="SvgjsG1034"><text id="SvgjsText1035" font-family="微软雅黑" text-anchor="start" font-size="13px" width="367px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1036" dy="16" x="0"><tspan id="SvgjsTspan1037" style="text-decoration:;">reader.ReadString('\n')&lt;/br&gt;&lt;/br&gt;p.Exec(client, reader, </tspan></tspan><tspan id="SvgjsTspan1038" dy="16" x="0"><tspan id="SvgjsTspan1039" style="text-decoration:;">params)&lt;/br&gt;protocol.SendResponse(client, response)</tspan></tspan></text></g></g><g id="SvgjsG1040" transform="translate(1665.3041375146515,432.00643384798605)"><path id="SvgjsPath1041" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1042"><text id="SvgjsText1043" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1044" dy="16" x="0"><tspan id="SvgjsTspan1045" style="text-decoration:;">doCreateTopic</tspan></tspan></text></g></g><g id="SvgjsG1046" transform="translate(1709.304137514651,467.00643384798605)"><path id="SvgjsPath1047" d="M 0 0L 306 0L 306 56L 0 56Z" stroke="none" fill="none"></path><g id="SvgjsG1048"><text id="SvgjsText1049" font-family="微软雅黑" text-anchor="start" font-size="13px" width="306px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1050" dy="16" x="0"><tspan id="SvgjsTspan1051" style="text-decoration:;">key := Registration{"topic", topicName, ""}</tspan></tspan><tspan id="SvgjsTspan1052" dy="16" x="0"><tspan id="SvgjsTspan1053" style="text-decoration:;">&lt;/br&gt;s.ctx.nsqlookupd.DB.AddRegistration(key)</tspan></tspan></text></g></g><g id="SvgjsG1054" transform="translate(1689.3041375146513,228.006433847986)"><path id="SvgjsPath1055" d="M 0 0L 83 0L 83 30L 0 30Z" stroke="none" fill="none"></path><g id="SvgjsG1056"><text id="SvgjsText1057" font-family="微软雅黑" text-anchor="start" font-size="13px" width="83px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1058" dy="16" x="0"><tspan id="SvgjsTspan1059" style="text-decoration:;">IOLoop</tspan></tspan></text></g></g><g id="SvgjsG1060" transform="translate(1859.3041375146513,303.006433847986)"><path id="SvgjsPath1061" d="M 0 0L 278 0L 278 26L 0 26Z" stroke="none" fill="none"></path><g id="SvgjsG1062"><text id="SvgjsText1063" font-family="微软雅黑" text-anchor="start" font-size="13px" width="278px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1064" dy="16" x="0"><tspan id="SvgjsTspan1065" style="text-decoration:;">PING, IDENTIFY, REGISTER, UNREGISTER</tspan></tspan></text></g></g><g id="SvgjsG1066" transform="translate(1859.3041375146513,333.006433847986)"><path id="SvgjsPath1067" d="M 0 0L 375 0L 375 74L 0 74Z" stroke="none" fill="none"></path><g id="SvgjsG1068"><text id="SvgjsText1069" font-family="微软雅黑" text-anchor="start" font-size="13px" width="375px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1070" dy="16" x="0"><tspan id="SvgjsTspan1071" style="text-decoration:;">REGISTER:&lt;/br&gt;topic, channel, err := </tspan></tspan><tspan id="SvgjsTspan1072" dy="16" x="0"><tspan id="SvgjsTspan1073" style="text-decoration:;">getTopicChan("REGISTER", params)&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1074" dy="16" x="0"><tspan id="SvgjsTspan1075" style="text-decoration:;">&lt;/br&gt;p.ctx.nsqlookupd.DB.AddProducer</tspan></tspan></text></g></g><g id="SvgjsG1076" transform="translate(1347.3041375146515,126.00643384798599)"><path id="SvgjsPath1077" d="M 0 0L 138 0L 138 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1078"><text id="SvgjsText1079" font-family="微软雅黑" text-anchor="start" font-size="13px" width="138px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1080" dy="16" x="0"><tspan id="SvgjsTspan1081" style="text-decoration:;">Main</tspan></tspan></text></g></g><g id="SvgjsG1082" transform="translate(1289.3041375146515,25.006433847986074)"><path id="SvgjsPath1083" d="M 0 0L 218 0L 218 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1084"><text id="SvgjsText1085" font-family="微软雅黑" text-anchor="start" font-size="23px" width="218px" fill="#323232" font-weight="700" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="23px" weight="700" font-style="" opacity="1" y="-4.875" transform="rotate(0)"><tspan id="SvgjsTspan1086" dy="28" x="0"><tspan id="SvgjsTspan1087" style="text-decoration:;">NSQ Lookupd</tspan></tspan></text></g></g><g id="SvgjsG1088" transform="translate(2254.3041375146513,131.006433847986)"><path id="SvgjsPath1089" d="M 0 0L 397 0L 397 447L 0 447Z" stroke="none" fill="none"></path><g id="SvgjsG1090"><text id="SvgjsText1091" font-family="微软雅黑" text-anchor="start" font-size="13px" width="397px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1092" dy="16" x="0"><tspan id="SvgjsTspan1093" style="text-decoration:;">type NSQLookupd struct {&lt;/br&gt;	DB           *RegistrationDB&lt;/br&gt;}</tspan></tspan><tspan id="SvgjsTspan1094" dy="16" x="0"><tspan id="SvgjsTspan1095" style="text-decoration:;">&lt;/br&gt;&lt;/br&gt;type RegistrationDB struct {&lt;/br&gt;	registrationMap </tspan></tspan><tspan id="SvgjsTspan1096" dy="16" x="0"><tspan id="SvgjsTspan1097" style="text-decoration:;">map[Registration]ProducerMap&lt;/br&gt;}&lt;/br&gt;&lt;/br&gt;type </tspan></tspan><tspan id="SvgjsTspan1098" dy="16" x="0"><tspan id="SvgjsTspan1099" style="text-decoration:;">Registration struct {&lt;/br&gt;	Category string //类型，topic 还是</tspan></tspan><tspan id="SvgjsTspan1100" dy="16" x="0"><tspan id="SvgjsTspan1101" style="text-decoration:;">channel&lt;/br&gt;	Key      string //topic&lt;/br&gt;	SubKey   string </tspan></tspan><tspan id="SvgjsTspan1102" dy="16" x="0"><tspan id="SvgjsTspan1103" style="text-decoration:;">//channel&lt;/br&gt;}&lt;/br&gt;&lt;/br&gt;type ProducerMap </tspan></tspan><tspan id="SvgjsTspan1104" dy="16" x="0"><tspan id="SvgjsTspan1105" style="text-decoration:;">map[string]*Producer&lt;/br&gt;&lt;/br&gt;type Producer struct {&lt;/br&gt;	</tspan></tspan><tspan id="SvgjsTspan1106" dy="16" x="0"><tspan id="SvgjsTspan1107" style="text-decoration:;">peerInfo     *PeerInfo&lt;/br&gt;}&lt;/br&gt;&lt;/br&gt;type PeerInfo struct </tspan></tspan><tspan id="SvgjsTspan1108" dy="16" x="0"><tspan id="SvgjsTspan1109" style="text-decoration:;">{&lt;/br&gt;	lastUpdate       int64&lt;/br&gt;	id               string&lt;/br&gt;	RemoteAddress    </tspan></tspan><tspan id="SvgjsTspan1110" dy="16" x="0"><tspan id="SvgjsTspan1111" style="text-decoration:;">string `json:"remote_address"`&lt;/br&gt;	Hostname         string </tspan></tspan><tspan id="SvgjsTspan1112" dy="16" x="0"><tspan id="SvgjsTspan1113" style="text-decoration:;">`json:"hostname"`&lt;/br&gt;	BroadcastAddress string </tspan></tspan><tspan id="SvgjsTspan1114" dy="16" x="0"><tspan id="SvgjsTspan1115" style="text-decoration:;">`json:"broadcast_address"`&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1116" transform="translate(1665.3041375146515,542.006433847986)"><path id="SvgjsPath1117" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1118"><text id="SvgjsText1119" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1120" dy="16" x="0"><tspan id="SvgjsTspan1121" style="text-decoration:;">doLookup</tspan></tspan></text></g></g><g id="SvgjsG1122" transform="translate(1703.304137514651,576.006433847986)"><path id="SvgjsPath1123" d="M 0 0L 522 0L 522 31L 0 31Z" stroke="none" fill="none"></path><g id="SvgjsG1124"><text id="SvgjsText1125" font-family="微软雅黑" text-anchor="start" font-size="13px" width="522px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1126" dy="16" x="0"><tspan id="SvgjsTspan1127" style="text-decoration:;">producers := s.ctx.nsqlookupd.DB.FindProducers("topic", topicName, "")</tspan></tspan></text></g></g><g id="SvgjsG1128"><path id="SvgjsPath1129" d="M1393.3041375146515 219.006433847986L1566.3041375146515 219.006433847986L1566.3041375146515 219.006433847986L1739.3041375146513 219.006433847986" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1130)"></path></g><g id="SvgjsG1132"><path id="SvgjsPath1133" d="M1393.3041375146515 333.006433847986L1541.0541375146515 333.006433847986L1541.0541375146515 333.006433847986L1688.8041375146513 333.006433847986" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1134)"></path></g><g id="SvgjsG1136"><path id="SvgjsPath1137" d="M1646.3041375146515 413.00643384798605L1646.3041375146515 492.00643384798605L1646.3041375146515 492.00643384798605L1646.3041375146515 571.006433847986" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1138"><path id="SvgjsPath1139" d="M1755.3041375146513 196.2921481337002L1755.3041375146513 242.2921481337002L1755.3041375146513 242.2921481337002L1755.3041375146513 288.2921481337002" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1140"><path id="SvgjsPath1141" d="M1373.4469946575086 153.29214813370044L1373.4469946575086 250.1492909908432L1373.4469946575086 250.1492909908432L1373.4469946575086 347.006433847986" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1142" transform="translate(1582.3041375146515,196.006433847986)"><path id="SvgjsPath1143" d="M 0 0L 135 0L 135 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1144"><text id="SvgjsText1145" font-family="微软雅黑" text-anchor="start" font-size="13px" width="135px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1146" dy="16" x="0"><tspan id="SvgjsTspan1147" style="text-decoration:;">LookupProtocolV1</tspan></tspan></text></g></g><g id="SvgjsG1148" transform="translate(1348.9708041813183,1105.3285079168777)"><path id="SvgjsPath1149" d="M 0 0L 176.03234310699585 0L 176.03234310699585 24.499999999999602L 0 24.499999999999602Z" stroke="none" fill="none"></path><g id="SvgjsG1150"><text id="SvgjsText1151" font-family="微软雅黑" text-anchor="start" font-size="13px" width="177px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1152" dy="16" x="0"><tspan id="SvgjsTspan1153" style="text-decoration:;">go queueScanLoop</tspan></tspan></text></g></g><g id="SvgjsG1154" transform="translate(1348.9708041813183,1174.4673968057666)"><path id="SvgjsPath1155" d="M 0 0L 182.83333333333326 0L 182.83333333333326 34.80555555555554L 0 34.80555555555554Z" stroke="none" fill="none"></path><g id="SvgjsG1156"><text id="SvgjsText1157" font-family="微软雅黑" text-anchor="start" font-size="13px" width="183px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1158" dy="16" x="0"><tspan id="SvgjsTspan1159" style="text-decoration:;">go lookupLoop</tspan></tspan></text></g></g><g id="SvgjsG1160" transform="translate(1348.9708041813183,1229.6757301390994)"><path id="SvgjsPath1161" d="M 0 0L 217.02739197530863 0L 217.02739197530863 31.80555555555543L 0 31.80555555555543Z" stroke="none" fill="none"></path><g id="SvgjsG1162"><text id="SvgjsText1163" font-family="微软雅黑" text-anchor="start" font-size="13px" width="218px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1164" dy="16" x="0"><tspan id="SvgjsTspan1165" style="text-decoration:;">go statsdLoop</tspan></tspan></text></g></g><g id="SvgjsG1166" transform="translate(1296.8041375146513,759.1548968057665)"><path id="SvgjsPath1167" d="M 0 0L 55.99999999999997 0L 55.99999999999997 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1168"><text id="SvgjsText1169" font-family="微软雅黑" text-anchor="start" font-size="13px" width="56px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1170" dy="16" x="0"><tspan id="SvgjsTspan1171" style="text-decoration:;">Main</tspan></tspan></text></g></g><g id="SvgjsG1172" transform="translate(1348.9708041813183,882.0437856946553)"><path id="SvgjsPath1173" d="M 0 0L 648.3333333333333 0L 648.3333333333333 20L 0 20Z" stroke="none" fill="none"></path><g id="SvgjsG1174"><text id="SvgjsText1175" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1176" dy="16" x="0"><tspan id="SvgjsTspan1177" style="text-decoration:;">go tcpListener</tspan></tspan></text></g></g><g id="SvgjsG1178" transform="translate(1348.9708041813183,984.4328889182491)"><path id="SvgjsPath1179" d="M 0 0L 320.83333333333326 0L 320.83333333333326 21.148148148148152L 0 21.148148148148152Z" stroke="none" fill="none"></path><g id="SvgjsG1180"><text id="SvgjsText1181" font-family="微软雅黑" text-anchor="start" font-size="13px" width="321px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1182" dy="16" x="0"><tspan id="SvgjsTspan1183" style="text-decoration:;">go httpListener</tspan></tspan></text></g></g><g id="SvgjsG1184" transform="translate(1900.0541375146495,719.0831375465071)"><path id="SvgjsPath1185" d="M 0 0L 285.68055555555577 0L 285.68055555555577 154.66666666666669L 0 154.66666666666669Z" stroke="none" fill="none"></path><g id="SvgjsG1186"><text id="SvgjsText1187" font-family="微软雅黑" text-anchor="start" font-size="13px" width="286px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1188" dy="16" x="0"><tspan id="SvgjsTspan1189" style="text-decoration:;">&lt;/br&gt;type NSQD struct {&lt;/br&gt;    topicMap </tspan></tspan><tspan id="SvgjsTspan1190" dy="16" x="0"><tspan id="SvgjsTspan1191" style="text-decoration:;">map[string]*Topic&lt;/br&gt;    lookupPeers </tspan></tspan><tspan id="SvgjsTspan1192" dy="16" x="0"><tspan id="SvgjsTspan1193" style="text-decoration:;">atomic.Value&lt;/br&gt;&lt;/br&gt;    tcpListener   </tspan></tspan><tspan id="SvgjsTspan1194" dy="16" x="0"><tspan id="SvgjsTspan1195" style="text-decoration:;">net.Listener&lt;/br&gt;    httpListener  net.Listener	</tspan></tspan><tspan id="SvgjsTspan1196" dy="16" x="0"><tspan id="SvgjsTspan1197" style="text-decoration:;">&lt;/br&gt;&lt;/br&gt;    optsNotificationChan chan </tspan></tspan><tspan id="SvgjsTspan1198" dy="16" x="0"><tspan id="SvgjsTspan1199" style="text-decoration:;">struct{}&lt;/br&gt;    ci *clusterinfo.ClusterInfo&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1200" transform="translate(1289.3041375146515,666.3771190279888)"><path id="SvgjsPath1201" d="M 0 0L 648.3333333333333 0L 648.3333333333333 49.66666666666667L 0 49.66666666666667Z" stroke="none" fill="none"></path><g id="SvgjsG1202"><text id="SvgjsText1203" font-family="微软雅黑" text-anchor="start" font-size="23px" width="649px" fill="#323232" font-weight="700" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="23px" weight="700" font-style="" opacity="1" y="-4.875" transform="rotate(0)"><tspan id="SvgjsTspan1204" dy="28" x="0"><tspan id="SvgjsTspan1205" style="text-decoration:;">NSQ nsqd</tspan></tspan></text></g></g><g id="SvgjsG1206"><path id="SvgjsPath1207" d="M1340.6374708479848 914.1896190279899L1658.345804181318 914.1896190279899L1658.345804181318 914.1896190279899L1976.0541375146495 914.1896190279899" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1208)"></path></g><g id="SvgjsG1210"><path id="SvgjsPath1211" d="M1340.6374708479848 1256.6896190279892L1424.137470847985 1256.6896190279892L1424.137470847985 1256.6896190279892L1507.637470847985 1256.6896190279892" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1212)"></path></g><g id="SvgjsG1214"><path id="SvgjsPath1215" d="M1340.6374708479848 1198.1896190279897L1422.887470847985 1198.1896190279897L1422.887470847985 1198.1896190279897L1505.1374708479852 1198.1896190279897" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1216)"></path></g><g id="SvgjsG1218" transform="translate(1791.595804181316,957.9141560650257)"><path id="SvgjsPath1219" d="M 0 0L 171.38734567901315 0L 171.38734567901315 26.518732853223412L 0 26.518732853223412Z" stroke="none" fill="none"></path><g id="SvgjsG1220"><text id="SvgjsText1221" font-family="微软雅黑" text-anchor="start" font-size="13px" width="172px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1222" dy="16" x="0"><tspan id="SvgjsTspan1223" style="text-decoration:;">go messagePump</tspan></tspan></text></g></g><g id="SvgjsG1224" transform="translate(1711.4708041813178,933.0252671761373)"><path id="SvgjsPath1225" d="M 0 0L 120.99999999999977 0L 120.99999999999977 24.88888888888846L 0 24.88888888888846Z" stroke="none" fill="none"></path><g id="SvgjsG1226"><text id="SvgjsText1227" font-family="微软雅黑" text-anchor="start" font-size="13px" width="121px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1228" dy="16" x="0"><tspan id="SvgjsTspan1229" style="text-decoration:;">IOLoop</tspan></tspan></text></g></g><g id="SvgjsG1230"><path id="SvgjsPath1231" d="M1776.4800634405765 978.3352380266172L2075.1421004776125 978.3352380266172L2075.1421004776125 978.3352380266172L2373.8041375146495 978.3352380266172" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1232)"></path></g><g id="SvgjsG1234" transform="translate(1786.1374708479843,1014.6062856946558)"><path id="SvgjsPath1235" d="M 0 0L 648.3333333333333 0L 648.3333333333333 59.16666666666663L 0 59.16666666666663Z" stroke="none" fill="none"></path><g id="SvgjsG1236"><text id="SvgjsText1237" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1238" dy="16" x="0"><tspan id="SvgjsTspan1239" style="text-decoration:;">client.Reader.ReadSlice('\n')&lt;/br&gt;response, err = p.Exec(client, params)&lt;/br&gt;p.Send(client, </tspan></tspan><tspan id="SvgjsTspan1240" dy="16" x="0"><tspan id="SvgjsTspan1241" style="text-decoration:;">frameTypeResponse, response)</tspan></tspan></text></g></g><g id="SvgjsG1242" transform="translate(2011.6351560331677,1105.3285079168777)"><path id="SvgjsPath1243" d="M 0 0L 260.43981481481546 0L 260.43981481481546 33.33333333333377L 0 33.33333333333377Z" stroke="none" fill="none"></path><g id="SvgjsG1244"><text id="SvgjsText1245" font-family="微软雅黑" text-anchor="start" font-size="13px" width="261px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1246" dy="16" x="0"><tspan id="SvgjsTspan1247" style="text-decoration:;">IDENTIFY / RDY / PUB</tspan></tspan></text></g></g><g id="SvgjsG1248" transform="translate(2011.6351560331677,1138.5437856946558)"><path id="SvgjsPath1249" d="M 0 0L 422.8356481481485 0L 422.8356481481485 50.49999999999977L 0 50.49999999999977Z" stroke="none" fill="none"></path><g id="SvgjsG1250"><text id="SvgjsText1251" font-family="微软雅黑" text-anchor="start" font-size="13px" width="423px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1252" dy="16" x="0"><tspan id="SvgjsTspan1253" style="text-decoration:;">SUB:&lt;/br&gt;topic := p.ctx.nsqd.GetTopic(topicName)&lt;/br&gt;channel = </tspan></tspan><tspan id="SvgjsTspan1254" dy="16" x="0"><tspan id="SvgjsTspan1255" style="text-decoration:;">topic.GetChannel(channelName)&lt;/br&gt;client.Channel = </tspan></tspan><tspan id="SvgjsTspan1256" dy="16" x="0"><tspan id="SvgjsTspan1257" style="text-decoration:;">channel&lt;/br&gt;client.SubEventChan &lt;- channel&lt;/br&gt;</tspan></tspan></text></g></g><g id="SvgjsG1258" transform="translate(2012.3643226998342,1242.4673968057664)"><path id="SvgjsPath1259" d="M 0 0L 422.1064814814822 0L 422.1064814814822 68.61805555555486L 0 68.61805555555486Z" stroke="none" fill="none"></path><g id="SvgjsG1260"><text id="SvgjsText1261" font-family="微软雅黑" text-anchor="start" font-size="13px" width="423px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1262" dy="16" x="0"><tspan id="SvgjsTspan1263" style="text-decoration:;">PUB: &lt;/br&gt;p.ctx.nsqd.GetTopic(topicName)&lt;/br&gt;msg := </tspan></tspan><tspan id="SvgjsTspan1264" dy="16" x="0"><tspan id="SvgjsTspan1265" style="text-decoration:;">NewMessage(topic.GenerateID(), messageBody)</tspan></tspan><tspan id="SvgjsTspan1266" dy="16" x="0"><tspan id="SvgjsTspan1267" style="text-decoration:;">&lt;/br&gt;topic.PutMessage(msg)</tspan></tspan></text></g></g><g id="SvgjsG1268" transform="translate(2202.6316838109447,869.8030449539158)"><path id="SvgjsPath1269" d="M 0 0L 417.538194444445 0L 417.538194444445 103.99999999999932L 0 103.99999999999932Z" stroke="none" fill="none"></path><g id="SvgjsG1270"><text id="SvgjsText1271" font-family="微软雅黑" text-anchor="start" font-size="13px" width="418px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1272" dy="16" x="0"><tspan id="SvgjsTspan1273" style="text-decoration:;">subChannel = &lt;-subEventChan&lt;/br&gt;memoryMsgChan = </tspan></tspan><tspan id="SvgjsTspan1274" dy="16" x="0"><tspan id="SvgjsTspan1275" style="text-decoration:;">subChannel.memoryMsgChan&lt;/br&gt;msg := &lt;-</tspan></tspan><tspan id="SvgjsTspan1276" dy="16" x="0"><tspan id="SvgjsTspan1277" style="text-decoration:;">memoryMsgChan&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1278" dy="16" x="0"><tspan id="SvgjsTspan1279" style="text-decoration:;">&lt;/br&gt;subChannel.StartInFlightTimeout(msg, client.ID, </tspan></tspan><tspan id="SvgjsTspan1280" dy="16" x="0"><tspan id="SvgjsTspan1281" style="text-decoration:;">msgTimeout)&lt;/br&gt;p.SendMessage(client, msg)</tspan></tspan></text></g></g><g id="SvgjsG1282"><path id="SvgjsPath1283" d="M1340.6374708479848 1012.5229523613234L1497.2208041813183 1012.5229523613234L1497.2208041813183 1012.5229523613234L1653.8041375146513 1012.5229523613234" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1284)"></path></g><g id="SvgjsG1286" transform="translate(1515.6374708479848,1017.543785694656)"><path id="SvgjsPath1287" d="M 0 0L 205.16666666666652 0L 205.16666666666652 23.49999999999966L 0 23.49999999999966Z" stroke="none" fill="none"></path><g id="SvgjsG1288"><text id="SvgjsText1289" font-family="微软雅黑" text-anchor="start" font-size="13px" width="206px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1290" dy="16" x="0"><tspan id="SvgjsTspan1291" style="text-decoration:;">newHTTPServer</tspan></tspan></text></g></g><g id="SvgjsG1292" transform="translate(1576.4708041813183,1057.4326745835451)"><path id="SvgjsPath1293" d="M 0 0L 158.6666666666664 0L 158.6666666666664 24.923611111110688L 0 24.923611111110688Z" stroke="none" fill="none"></path><g id="SvgjsG1294"><text id="SvgjsText1295" font-family="微软雅黑" text-anchor="start" font-size="13px" width="159px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1296" dy="16" x="0"><tspan id="SvgjsTspan1297" style="text-decoration:;">router.Handle</tspan></tspan></text></g></g><g id="SvgjsG1298" transform="translate(1611.9152486257624,1113.4257301391)"><path id="SvgjsPath1299" d="M 0 0L 331.888888888889 0L 331.888888888889 106.24999999999909L 0 106.24999999999909Z" stroke="none" fill="none"></path><g id="SvgjsG1300"><text id="SvgjsText1301" font-family="微软雅黑" text-anchor="start" font-size="13px" width="332px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1302" dy="16" x="0"><tspan id="SvgjsTspan1303" style="text-decoration:;">doPUB:&lt;/br&gt;p.ctx.nsqd.GetTopic(topicName)</tspan></tspan><tspan id="SvgjsTspan1304" dy="16" x="0"><tspan id="SvgjsTspan1305" style="text-decoration:;">&lt;/br&gt;msg := NewMessage(topic.GenerateID(), body)</tspan></tspan><tspan id="SvgjsTspan1306" dy="16" x="0"><tspan id="SvgjsTspan1307" style="text-decoration:;">&lt;/br&gt;	&lt;/br&gt;//将消息投送到topic 中&lt;/br&gt;err = </tspan></tspan><tspan id="SvgjsTspan1308" dy="16" x="0"><tspan id="SvgjsTspan1309" style="text-decoration:;">topic.PutMessage(msg)</tspan></tspan></text></g></g><g id="SvgjsG1310" transform="translate(1575.137470847985,1350.571563472434)"><path id="SvgjsPath1311" d="M 0 0L 246.45833333333246 0L 246.45833333333246 55.4722222222216L 0 55.4722222222216Z" stroke="none" fill="none"></path><g id="SvgjsG1312"><text id="SvgjsText1313" font-family="微软雅黑" text-anchor="start" font-size="13px" width="247px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1314" dy="16" x="0"><tspan id="SvgjsTspan1315" style="text-decoration:;">topic.PutMessage(msg)&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1316" dy="16" x="0"><tspan id="SvgjsTspan1317" style="text-decoration:;">&lt;/br&gt;t.memoryMsgChan &lt;- m</tspan></tspan></text></g></g><g id="SvgjsG1318" transform="translate(1293.6930264035414,1403.543785694655)"><path id="SvgjsPath1319" d="M 0 0L 149.11111111110995 0L 149.11111111110995 30.500000000000455L 0 30.500000000000455Z" stroke="none" fill="none"></path><g id="SvgjsG1320"><text id="SvgjsText1321" font-family="微软雅黑" text-anchor="start" font-size="13px" width="150px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1322" dy="16" x="0"><tspan id="SvgjsTspan1323" style="text-decoration:;">GetTopic</tspan></tspan></text></g></g><g id="SvgjsG1324" transform="translate(1398.6374708479848,1497.6618412502112)"><path id="SvgjsPath1325" d="M 0 0L 648.3333333333333 0L 648.3333333333333 26.5L 0 26.5Z" stroke="none" fill="none"></path><g id="SvgjsG1326"><text id="SvgjsText1327" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1328" dy="16" x="0"><tspan id="SvgjsTspan1329" style="text-decoration:;">go messagePump</tspan></tspan></text></g></g><g id="SvgjsG1330" transform="translate(1630.1374708479848,1536.0437856946553)"><path id="SvgjsPath1331" d="M 0 0L 283.6666666666663 0L 283.6666666666663 101.00000000000034L 0 101.00000000000034Z" stroke="none" fill="none"></path><g id="SvgjsG1332"><text id="SvgjsText1333" font-family="微软雅黑" text-anchor="start" font-size="13px" width="284px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1334" dy="16" x="0"><tspan id="SvgjsTspan1335" style="text-decoration:;">memoryMsgChan = </tspan></tspan><tspan id="SvgjsTspan1336" dy="16" x="0"><tspan id="SvgjsTspan1337" style="text-decoration:;">t.memoryMsgChan&lt;/br&gt;msg = &lt;-</tspan></tspan><tspan id="SvgjsTspan1338" dy="16" x="0"><tspan id="SvgjsTspan1339" style="text-decoration:;">memoryMsgChan&lt;/br&gt;&lt;/br&gt;for i, channel </tspan></tspan><tspan id="SvgjsTspan1340" dy="16" x="0"><tspan id="SvgjsTspan1341" style="text-decoration:;">:= range chans {&lt;/br&gt;    err := </tspan></tspan><tspan id="SvgjsTspan1342" dy="16" x="0"><tspan id="SvgjsTspan1343" style="text-decoration:;">channel.PutMessage(chanMsg)&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1344" transform="translate(1716.1179395979848,1693.127119027989)"><path id="SvgjsPath1345" d="M 0 0L 271.33333333333337 0L 271.33333333333337 26.416666666666515L 0 26.416666666666515Z" stroke="none" fill="none"></path><g id="SvgjsG1346"><text id="SvgjsText1347" font-family="微软雅黑" text-anchor="start" font-size="13px" width="272px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1348" dy="16" x="0"><tspan id="SvgjsTspan1349" style="text-decoration:;">(c *Channel) PutMessage(m *Message)</tspan></tspan></text></g></g><g id="SvgjsG1350" transform="translate(1716.1179395979848,1719.5437856946555)"><path id="SvgjsPath1351" d="M 0 0L 236.5 0L 236.5 26.583333333334167L 0 26.583333333334167Z" stroke="none" fill="none"></path><g id="SvgjsG1352"><text id="SvgjsText1353" font-family="微软雅黑" text-anchor="start" font-size="13px" width="237px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1354" dy="16" x="0"><tspan id="SvgjsTspan1355" style="text-decoration:;">c.memoryMsgChan &lt;- m:</tspan></tspan></text></g></g><g id="SvgjsG1356" transform="translate(2434.4708041813165,1024.6062856946558)"><path id="SvgjsPath1357" d="M 0 0L 648.3333333333333 0L 648.3333333333333 131L 0 131Z" stroke="none" fill="none"></path><g id="SvgjsG1358"><text id="SvgjsText1359" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1360" dy="16" x="0"><tspan id="SvgjsTspan1361" style="text-decoration:;">go queueScanLoop</tspan></tspan></text></g></g><g id="SvgjsG1362" transform="translate(2482.137470847983,1071.0229523613232)"><path id="SvgjsPath1363" d="M 0 0L 648.3333333333333 0L 648.3333333333333 28.833333333332916L 0 28.833333333332916Z" stroke="none" fill="none"></path><g id="SvgjsG1364"><text id="SvgjsText1365" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1366" dy="16" x="0"><tspan id="SvgjsTspan1367" style="text-decoration:;">n.resizePool(len(channels), workCh, responseCh, closeCh)</tspan></tspan></text></g></g><g id="SvgjsG1368" transform="translate(2528.866637514649,1109.856285694656)"><path id="SvgjsPath1369" d="M 0 0L 234.93750000000045 0L 234.93750000000045 28.687499999999773L 0 28.687499999999773Z" stroke="none" fill="none"></path><g id="SvgjsG1370"><text id="SvgjsText1371" font-family="微软雅黑" text-anchor="start" font-size="13px" width="235px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1372" dy="16" x="0"><tspan id="SvgjsTspan1373" style="text-decoration:;">queueScanWorker</tspan></tspan></text></g></g><g id="SvgjsG1374" transform="translate(2434.4708041813165,1268.856285694656)"><path id="SvgjsPath1375" d="M 0 0L 299.33333333333326 0L 299.33333333333326 31.187499999999545L 0 31.187499999999545Z" stroke="none" fill="none"></path><g id="SvgjsG1376"><text id="SvgjsText1377" font-family="微软雅黑" text-anchor="start" font-size="13px" width="300px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1378" dy="16" x="0"><tspan id="SvgjsTspan1379" style="text-decoration:;">go lookupLoop</tspan></tspan></text></g></g><g id="SvgjsG1380" transform="translate(2482.137470847983,1316.5229523613225)"><path id="SvgjsPath1381" d="M 0 0L 580.6666666666665 0L 580.6666666666665 30.52083333333303L 0 30.52083333333303Z" stroke="none" fill="none"></path><g id="SvgjsG1382"><text id="SvgjsText1383" font-family="微软雅黑" text-anchor="start" font-size="13px" width="581px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1384" dy="16" x="0"><tspan id="SvgjsTspan1385" style="text-decoration:;">newLookupPeer(host, n.getOpts().MaxBodySize, n.logf, connectCallback(n, hostname))</tspan></tspan></text></g></g><g id="SvgjsG1386" transform="translate(2482.137470847983,1343.189619027989)"><path id="SvgjsPath1387" d="M 0 0L 648.3333333333333 0L 648.3333333333333 25.66666666666697L 0 25.66666666666697Z" stroke="none" fill="none"></path><g id="SvgjsG1388"><text id="SvgjsText1389" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1390" dy="16" x="0"><tspan id="SvgjsTspan1391" style="text-decoration:;">ticker cmd := nsq.Ping()</tspan></tspan></text></g></g><g id="SvgjsG1392" transform="translate(2434.4708041813165,1464.3285079168782)"><path id="SvgjsPath1393" d="M 0 0L 247.33333333333326 0L 247.33333333333326 24.715277777777374L 0 24.715277777777374Z" stroke="none" fill="none"></path><g id="SvgjsG1394"><text id="SvgjsText1395" font-family="微软雅黑" text-anchor="start" font-size="13px" width="248px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1396" dy="16" x="0"><tspan id="SvgjsTspan1397" style="text-decoration:;">go statsdLoop</tspan></tspan></text></g></g><g id="SvgjsG1398" transform="translate(2482.137470847983,1379.5229523613227)"><path id="SvgjsPath1399" d="M 0 0L 230.66666666666652 0L 230.66666666666652 30.520833333332803L 0 30.520833333332803Z" stroke="none" fill="none"></path><g id="SvgjsG1400"><text id="SvgjsText1401" font-family="微软雅黑" text-anchor="start" font-size="13px" width="231px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1402" dy="16" x="0"><tspan id="SvgjsTspan1403" style="text-decoration:;">val := &lt;-n.notifyChan</tspan></tspan></text></g></g><g id="SvgjsG1404" transform="translate(2482.137470847983,1509.9673968057666)"><path id="SvgjsPath1405" d="M 0 0L 648.3333333333333 0L 648.3333333333333 34.88888888888914L 0 34.88888888888914Z" stroke="none" fill="none"></path><g id="SvgjsG1406"><text id="SvgjsText1407" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1408" dy="16" x="0"><tspan id="SvgjsTspan1409" style="text-decoration:;">conn, err := net.DialTimeout("udp", addr, time.Second)</tspan></tspan></text></g></g><g id="SvgjsG1410" transform="translate(2482.137470847983,1535.717396805767)"><path id="SvgjsPath1411" d="M 0 0L 401.6666666666665 0L 401.6666666666665 32.32638888888846L 0 32.32638888888846Z" stroke="none" fill="none"></path><g id="SvgjsG1412"><text id="SvgjsText1413" font-family="微软雅黑" text-anchor="start" font-size="13px" width="402px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1414" dy="16" x="0"><tspan id="SvgjsTspan1415" style="text-decoration:;">stats := n.GetStats("", "")</tspan></tspan></text></g></g><g id="SvgjsG1416" transform="translate(1332.4708041813183,1464.3285079168782)"><path id="SvgjsPath1417" d="M 0 0L 648.3333333333333 0L 648.3333333333333 33.33333333333292L 0 33.33333333333292Z" stroke="none" fill="none"></path><g id="SvgjsG1418"><text id="SvgjsText1419" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1420" dy="16" x="0"><tspan id="SvgjsTspan1421" style="text-decoration:;">NewTopic(topicName, &amp;context{n}, deleteCallback)</tspan></tspan></text></g></g><g id="SvgjsG1422" transform="translate(1390.4708041813183,1541.3771190279879)"><path id="SvgjsPath1423" d="M 0 0L 648.3333333333333 0L 648.3333333333333 31.833333333332916L 0 31.833333333332916Z" stroke="none" fill="none"></path><g id="SvgjsG1424"><text id="SvgjsText1425" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1426" dy="16" x="0"><tspan id="SvgjsTspan1427" style="text-decoration:;">t.ctx.nsqd.Notify(t)</tspan></tspan></text></g></g><g id="SvgjsG1428" transform="translate(1971.8365449220564,1524.161841250211)"><path id="SvgjsPath1429" d="M 0 0L 306.16666666666674 0L 306.16666666666674 91.47916666666686L 0 91.47916666666686Z" stroke="none" fill="none"></path><g id="SvgjsG1430"><text id="SvgjsText1431" font-family="微软雅黑" text-anchor="start" font-size="13px" width="307px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1432" dy="16" x="0"><tspan id="SvgjsTspan1433" style="text-decoration:;">type Topic struct {&lt;/br&gt;    messageCount </tspan></tspan><tspan id="SvgjsTspan1434" dy="16" x="0"><tspan id="SvgjsTspan1435" style="text-decoration:;">uint64&lt;/br&gt;    channelMap        </tspan></tspan><tspan id="SvgjsTspan1436" dy="16" x="0"><tspan id="SvgjsTspan1437" style="text-decoration:;">map[string]*Channel&lt;/br&gt;    memoryMsgChan     </tspan></tspan><tspan id="SvgjsTspan1438" dy="16" x="0"><tspan id="SvgjsTspan1439" style="text-decoration:;">chan *Message&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1440"><path id="SvgjsPath1441" d="M1388.3041375146513 1521.5437856946548L1635.5541375146513 1521.5437856946548L1635.5541375146513 1521.5437856946548L1882.80413751465 1521.5437856946548" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1442)"></path></g><g id="SvgjsG1444"><path id="SvgjsPath1445" d="M1340.6374708479848 1137.1896190279895L1423.387470847985 1137.1896190279895L1423.387470847985 1137.1896190279895L1506.1374708479852 1137.1896190279895" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1446)"></path></g><g id="SvgjsG1448"><path id="SvgjsPath1449" d="M2424.5463250146495 1048.0151398613234L2581.129658347983 1048.0151398613234L2581.129658347983 1048.0151398613234L2737.712991681316 1048.0151398613234" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1450)"></path></g><g id="SvgjsG1452"><path id="SvgjsPath1453" d="M2424.5463250146495 1295.2547231946555L2581.129658347983 1295.2547231946555L2581.129658347983 1295.2547231946555L2737.712991681316 1295.2547231946555" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1454)"></path></g><g id="SvgjsG1456"><path id="SvgjsPath1457" d="M2424.5463250146495 1491.5047231946555L2581.129658347983 1491.5047231946555L2581.129658347983 1491.5047231946555L2737.712991681316 1491.5047231946555" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1458)"></path></g><g id="SvgjsG1460" transform="translate(1332.4708041813183,1772.6271190279874)"><path id="SvgjsPath1461" d="M 0 0L 593.3333333333333 0L 593.3333333333333 20.416666666668107L 0 20.416666666668107Z" stroke="none" fill="none"></path><g id="SvgjsG1462"><text id="SvgjsText1463" font-family="微软雅黑" text-anchor="start" font-size="13px" width="594px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1464" dy="16" x="0"><tspan id="SvgjsTspan1465" style="text-decoration:;">channelNames, err := n.ci.GetLookupdTopicChannels(t.name, lookupdHTTPAddrs)</tspan></tspan></text></g></g><g id="SvgjsG1466" transform="translate(1390.4708041813183,1858.377119027988)"><path id="SvgjsPath1467" d="M 0 0L 648.3333333333333 0L 648.3333333333333 30.666666666667652L 0 30.666666666667652Z" stroke="none" fill="none"></path><g id="SvgjsG1468"><text id="SvgjsText1469" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1470" dy="16" x="0"><tspan id="SvgjsTspan1471" style="text-decoration:;">channel = NewChannel(t.name, channelName, t.ctx, deleteCallback)</tspan></tspan></text></g></g><g id="SvgjsG1472" transform="translate(1432.8041375146513,1910.3771190279886)"><path id="SvgjsPath1473" d="M 0 0L 648.3333333333333 0L 648.3333333333333 31.833333333332916L 0 31.833333333332916Z" stroke="none" fill="none"></path><g id="SvgjsG1474"><text id="SvgjsText1475" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1476" dy="16" x="0"><tspan id="SvgjsTspan1477" style="text-decoration:;">c.initPQ()</tspan></tspan></text></g></g><g id="SvgjsG1478" transform="translate(1432.8041375146513,1944.3771190279886)"><path id="SvgjsPath1479" d="M 0 0L 648.3333333333333 0L 648.3333333333333 31.833333333332916L 0 31.833333333332916Z" stroke="none" fill="none"></path><g id="SvgjsG1480"><text id="SvgjsText1481" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1482" dy="16" x="0"><tspan id="SvgjsTspan1483" style="text-decoration:;">c.ctx.nsqd.Notify(c)</tspan></tspan></text></g></g><g id="SvgjsG1484" transform="translate(1971.8365449220564,1774.6271190279874)"><path id="SvgjsPath1485" d="M 0 0L 648.3333333333333 0L 648.3333333333333 177.66666666666652L 0 177.66666666666652Z" stroke="none" fill="none"></path><g id="SvgjsG1486"><text id="SvgjsText1487" font-family="微软雅黑" text-anchor="start" font-size="13px" width="649px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1488" dy="16" x="0"><tspan id="SvgjsTspan1489" style="text-decoration:;">type Channel struct {&lt;/br&gt;    requeueCount uint64&lt;/br&gt;    messageCount uint64&lt;/br&gt;&lt;/br&gt;    backend </tspan></tspan><tspan id="SvgjsTspan1490" dy="16" x="0"><tspan id="SvgjsTspan1491" style="text-decoration:;">BackendQueue&lt;/br&gt;    memoryMsgChan chan *Message&lt;/br&gt;&lt;/br&gt;    deferredPQ       </tspan></tspan><tspan id="SvgjsTspan1492" dy="16" x="0"><tspan id="SvgjsTspan1493" style="text-decoration:;">pqueue.PriorityQueue&lt;/br&gt;    inFlightPQ       inFlightPqueue&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1494" transform="translate(1624.8666375146513,885.1363782872486)"><path id="SvgjsPath1495" d="M 0 0L 120.99999999999977 0L 120.99999999999977 24.88888888888846L 0 24.88888888888846Z" stroke="none" fill="none"></path><g id="SvgjsG1496"><text id="SvgjsText1497" font-family="微软雅黑" text-anchor="start" font-size="13px" width="121px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1498" dy="16" x="0"><tspan id="SvgjsTspan1499" style="text-decoration:;">protocolV2</tspan></tspan></text></g></g><g id="SvgjsG1500"><path id="SvgjsPath1501" d="M1321.8041375146513 809.5715634724339L1321.8041375146513 1046.071563472434L1321.8041375146513 1046.071563472434L1321.8041375146513 1282.571563472434" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1502"><path id="SvgjsPath1503" d="M1599.8041375146513 1085.0437856946555L1599.8041375146513 1143.0403134724331L1599.8041375146513 1143.0403134724331L1599.8041375146513 1201.0368412502105" stroke="#4d9900" stroke-width="1" fill="none"></path></g><g id="SvgjsG1504"><path id="SvgjsPath1505" d="M1995.8041375146495 1086.279896805767L1995.8041375146495 1171.279896805767L1995.8041375146495 1171.279896805767L1995.8041375146495 1256.279896805767" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1506"><path id="SvgjsPath1507" d="M2577.8041375146495 1134.571563472434L2577.8041375146495 1180.571563472434L2577.8041375146495 1180.571563472434L2577.8041375146495 1226.571563472434" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1508"><path id="SvgjsPath1509" d="M1319.8041375146513 1435.279896805767L1319.8041375146513 1631.779896805767L1319.8041375146513 1631.779896805767L1319.8041375146513 1828.279896805767" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1510"><path id="SvgjsPath1511" d="M1422.8041375146513 1883.279896805767L1422.8041375146513 1915.2798968057677L1422.8041375146513 1915.2798968057677L1422.8041375146513 1947.2798968057677" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1512"><path id="SvgjsPath1513" d="M1695.8041375146513 1242.0437856946555L1695.8041375146513 1287.5437856946555L1695.8041375146513 1287.5437856946555L1695.8041375146513 1333.0437856946555" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1514)"></path></g><g id="SvgjsG1516"><path id="SvgjsPath1517" d="M1999.8041375146495 1300.0437856946555L1871.8041375146497 1300.0437856946555L1871.8041375146497 1393.0437856946555L1743.8041375146513 1393.0437856946555" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1518)"></path></g><g id="SvgjsG1520"><path id="SvgjsPath1521" d="M1696.8041375146513 1406.0437856946555L1696.8041375146513 1469.5437856946555L1696.8041375146513 1469.5437856946555L1696.8041375146513 1533.0437856946555" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1522)"></path></g><g id="SvgjsG1524"><path id="SvgjsPath1525" d="M1791.80413751465 1630.0437856946555L1791.80413751465 1658.5437856946555L1791.80413751465 1658.5437856946555L1791.80413751465 1687.0437856946555" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1526)"></path></g><g id="SvgjsG1528"><path id="SvgjsPath1529" d="M1922.8041375146495 1681.0437856946555L1922.8041375146495 1412.4697116205814L2382.8041375146495 1412.4697116205814L2382.8041375146495 983.8956375465075" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1530)"></path></g><g id="SvgjsG1532"><path id="SvgjsPath1533" d="M1759.8041375146513 968.571563472434L1759.8041375146513 1016.071563472434L1759.8041375146513 1016.071563472434L1759.8041375146513 1063.571563472434" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1534"><path id="SvgjsPath1535" d="M2186.863056785483 950.0437856946555L2086.458597150066 950.0437856946555L2086.458597150066 913.7937856946555L1986.0541375146495 913.7937856946555" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1536)"></path></g><g id="SvgjsG1538"><path id="SvgjsPath1539" d="M1942.8041375146495 930.0437856946555L1942.8041375146495 970.0437856946555L1942.8041375146495 970.0437856946555L1942.8041375146495 1010.0437856946555" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1540)"></path></g><g id="SvgjsG1542" transform="translate(588.622353690011,624.6078882587581)"><path id="SvgjsPath1543" d="M 0 0L 454.6153846153845 0L 454.6153846153845 178.76923076923077L 0 178.76923076923077Z" stroke="none" fill="none"></path><g id="SvgjsG1544"><text id="SvgjsText1545" font-family="微软雅黑" text-anchor="start" font-size="13px" width="455px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1546" dy="16" x="0"><tspan id="SvgjsTspan1547" style="text-decoration:;">type Producer struct {&lt;/br&gt;	id     int64&lt;/br&gt;	addr   string //nsqd tcp 地址</tspan></tspan><tspan id="SvgjsTspan1548" dy="16" x="0"><tspan id="SvgjsTspan1549" style="text-decoration:;">&lt;/br&gt;	conn   producerConn&lt;/br&gt;	&lt;/br&gt;	responseChan chan []byte //收到</tspan></tspan><tspan id="SvgjsTspan1550" dy="16" x="0"><tspan id="SvgjsTspan1551" style="text-decoration:;">响应数据后，数据写入chan&lt;/br&gt;&lt;/br&gt;	transactionChan chan </tspan></tspan><tspan id="SvgjsTspan1552" dy="16" x="0"><tspan id="SvgjsTspan1553" style="text-decoration:;">*ProducerTransaction //消息写入chan&lt;/br&gt;	transactions    </tspan></tspan><tspan id="SvgjsTspan1554" dy="16" x="0"><tspan id="SvgjsTspan1555" style="text-decoration:;">[]*ProducerTransaction //投递中的传输&lt;/br&gt;}</tspan></tspan></text></g></g><g id="SvgjsG1556" transform="translate(33.289020356677725,531.3771190279888)"><path id="SvgjsPath1557" d="M 0 0L 230.33333333333331 0L 230.33333333333331 34.00000000000003L 0 34.00000000000003Z" stroke="none" fill="none"></path><g id="SvgjsG1558"><text id="SvgjsText1559" font-family="微软雅黑" text-anchor="start" font-size="23px" width="231px" fill="#323232" font-weight="700" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="23px" weight="700" font-style="" opacity="1" y="-4.875" transform="rotate(0)"><tspan id="SvgjsTspan1560" dy="28" x="0"><tspan id="SvgjsTspan1561" style="text-decoration:;">NSQ producer</tspan></tspan></text></g></g><g id="SvgjsG1562" transform="translate(61.62235369001121,617.3771190279888)"><path id="SvgjsPath1563" d="M 0 0L 332 0L 332 65L 0 65Z" stroke="none" fill="none"></path><g id="SvgjsG1564"><text id="SvgjsText1565" font-family="微软雅黑" text-anchor="start" font-size="13px" width="332px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1566" dy="16" x="0"><tspan id="SvgjsTspan1567" style="text-decoration:;">nsq.NewProducer(addr, cfg)</tspan></tspan></text></g></g><g id="SvgjsG1568" transform="translate(61.62235369001121,666.3771190279888)"><path id="SvgjsPath1569" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1570"><text id="SvgjsText1571" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1572" dy="16" x="0"><tspan id="SvgjsTspan1573" style="text-decoration:;">r.ReadBytes(delim)</tspan></tspan></text></g></g><g id="SvgjsG1574" transform="translate(61.62235369001121,714.3771190279888)"><path id="SvgjsPath1575" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1576"><text id="SvgjsText1577" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1578" dy="16" x="0"><tspan id="SvgjsTspan1579" style="text-decoration:;">Publish(*topic, line)</tspan></tspan></text></g></g><g id="SvgjsG1580" transform="translate(123.62235369001121,758.3771190279888)"><path id="SvgjsPath1581" d="M 0 0L 321 0L 321 24L 0 24Z" stroke="none" fill="none"></path><g id="SvgjsG1582"><text id="SvgjsText1583" font-family="微软雅黑" text-anchor="start" font-size="13px" width="321px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1584" dy="16" x="0"><tspan id="SvgjsTspan1585" style="text-decoration:;">&amp;Command{[]byte("PUB"), params, body}</tspan></tspan></text></g></g><g id="SvgjsG1586" transform="translate(123.62235369001121,794.3771190279888)"><path id="SvgjsPath1587" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1588"><text id="SvgjsText1589" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1590" dy="16" x="0"><tspan id="SvgjsTspan1591" style="text-decoration:;">sendCommandAsync</tspan></tspan></text></g></g><g id="SvgjsG1592" transform="translate(182.62235369001093,843.3771190279889)"><path id="SvgjsPath1593" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1594"><text id="SvgjsText1595" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1596" dy="16" x="0"><tspan id="SvgjsTspan1597" style="text-decoration:;">Producer.connect&lt;/br&gt;</tspan></tspan></text></g></g><g id="SvgjsG1598" transform="translate(391.84457591223304,848.5364614759054)"><path id="SvgjsPath1599" d="M 0 0L 476 0L 476 58.5L 0 58.5Z" stroke="none" fill="none"></path><g id="SvgjsG1600"><text id="SvgjsText1601" font-family="微软雅黑" text-anchor="start" font-size="13px" width="476px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1602" dy="16" x="0"><tspan id="SvgjsTspan1603" style="text-decoration:;">w.conn = NewConn(w.addr, &amp;w.config, &amp;producerConnDelegate{w})&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1604" dy="16" x="0"><tspan id="SvgjsTspan1605" style="text-decoration:;">&lt;/br&gt;_, err := w.conn.Connect()</tspan></tspan></text></g></g><g id="SvgjsG1606" transform="translate(182.62235369001093,900.3771190279892)"><path id="SvgjsPath1607" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1608"><text id="SvgjsText1609" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1610" dy="16" x="0"><tspan id="SvgjsTspan1611" style="text-decoration:;">w.transactionChan &lt;- t</tspan></tspan></text></g></g><g id="SvgjsG1612" transform="translate(519.5112425789001,1044.8771190279892)"><path id="SvgjsPath1613" d="M 0 0L 293 0L 293 47L 0 47Z" stroke="none" fill="none"></path><g id="SvgjsG1614"><text id="SvgjsText1615" font-family="微软雅黑" text-anchor="start" font-size="13px" width="293px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1616" dy="16" x="0"><tspan id="SvgjsTspan1617" style="text-decoration:;">(c *Conn) WriteCommand(cmd *Command)</tspan></tspan><tspan id="SvgjsTspan1618" dy="16" x="0"><tspan id="SvgjsTspan1619" style="text-decoration:;">&lt;/br&gt;cmd.WriteTo(c)</tspan></tspan></text></g></g><g id="SvgjsG1620" transform="translate(392.6779092455663,935.8215634724336)"><path id="SvgjsPath1621" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1622"><text id="SvgjsText1623" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1624" dy="16" x="0"><tspan id="SvgjsTspan1625" style="text-decoration:;">go w.router()</tspan></tspan></text></g></g><g id="SvgjsG1626" transform="translate(731.3445759122338,884.4882301391003)"><path id="SvgjsPath1627" d="M 0 0L 234 0L 234 43L 0 43Z" stroke="none" fill="none"></path><g id="SvgjsG1628"><text id="SvgjsText1629" font-family="微软雅黑" text-anchor="start" font-size="13px" width="234px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1630" dy="16" x="0"><tspan id="SvgjsTspan1631" style="text-decoration:;">(c *Conn) Connect()&lt;/br&gt;dialer.Dial</tspan></tspan></text></g></g><g id="SvgjsG1632" transform="translate(728.8445759122341,984.5437856946553)"><path id="SvgjsPath1633" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1634"><text id="SvgjsText1635" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1636" dy="16" x="0"><tspan id="SvgjsTspan1637" style="text-decoration:;">go c.writeLoop()</tspan></tspan></text></g></g><g id="SvgjsG1638" transform="translate(730.9279092455671,940.6548968057671)"><path id="SvgjsPath1639" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1640"><text id="SvgjsText1641" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1642" dy="16" x="0"><tspan id="SvgjsTspan1643" style="text-decoration:;">go c.readLoop()</tspan></tspan></text></g></g><g id="SvgjsG1644" transform="translate(905.6665970283725,977.3518567824715)"><path id="SvgjsPath1645" d="M 0 0L 337 0L 337 42L 0 42Z" stroke="none" fill="none"></path><g id="SvgjsG1646"><text id="SvgjsText1647" font-family="微软雅黑" text-anchor="start" font-size="13px" width="337px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1648" dy="16" x="0"><tspan id="SvgjsTspan1649" style="text-decoration:;">frameType, data, err := ReadUnpackedResponse(c)</tspan></tspan><tspan id="SvgjsTspan1650" dy="16" x="0"><tspan id="SvgjsTspan1651" style="text-decoration:;">&lt;/br&gt;c.delegate.OnResponse(c, data)</tspan></tspan></text></g></g><g id="SvgjsG1652" transform="translate(463.84457591223315,997.0437856946558)"><path id="SvgjsPath1653" d="M 0 0L 251 0L 251 46L 0 46Z" stroke="none" fill="none"></path><g id="SvgjsG1654"><text id="SvgjsText1655" font-family="微软雅黑" text-anchor="start" font-size="13px" width="251px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1656" dy="16" x="0"><tspan id="SvgjsTspan1657" style="text-decoration:;">t := &lt;-</tspan></tspan><tspan id="SvgjsTspan1658" dy="16" x="0"><tspan id="SvgjsTspan1659" style="text-decoration:;">w.transactionChan&lt;/br&gt;w.conn.WriteCo</tspan></tspan><tspan id="SvgjsTspan1660" dy="16" x="0"><tspan id="SvgjsTspan1661" style="text-decoration:;">mmand(t.cmd)</tspan></tspan></text></g></g><g id="SvgjsG1662"><path id="SvgjsPath1663" d="M52.52513146778813 588.9694041842388L52.52513146778813 664.3860708509054L52.52513146778813 664.3860708509054L52.52513146778813 739.8027375175723" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1664"><path id="SvgjsPath1665" d="M170.85846480112122 828.9694041842382L170.85846480112122 882.3027375175725L170.85846480112122 882.3027375175725L170.85846480112122 935.636070850906" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1666"><path id="SvgjsPath1667" d="M448.8445759122336 966.2360933869629L448.8445759122336 1055.806606207476L448.8445759122336 1055.806606207476L448.8445759122336 1145.3771190279892" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1668"><path id="SvgjsPath1669" d="M377.525131467788 845.1152375175719L377.525131467788 898.4485708509058L377.525131467788 898.4485708509058L377.525131467788 951.7819041842392" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1670"><path id="SvgjsPath1671" d="M713.8445759122336 886.0437856946555L713.8445759122336 949.7104523613225L713.8445759122336 949.7104523613225L713.8445759122336 1013.3771190279892" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1672"><path id="SvgjsPath1673" d="M568.3584648011214 886.0657583509055L641.6917981344551 886.0657583509055L641.6917981344551 886.0657583509055L715.0251314677886 886.0657583509055" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1674"><path id="SvgjsPath1675" d="M311.1035628403369 845.1540447071148L344.43689617367016 845.1540447071148L344.43689617367016 845.1540447071148L377.7702295070037 845.1540447071148" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1676"><path id="SvgjsPath1677" d="M723.3870595723637 967.3182954985775L963.9752948664818 967.3182954985775L963.9752948664818 967.3182954985775L1204.5635301605996 967.3182954985775" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1678)"></path></g><g id="SvgjsG1680"><path id="SvgjsPath1681" d="M723.3870595723632 1012.0241778515185L800.5816297081104 1012.0241778515185L800.5816297081104 1012.0241778515185L877.7761998438572 1012.0241778515185" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1682)"></path></g><g id="SvgjsG1684"><path id="SvgjsPath1685" d="M382.3915844592418 960.5309651818354L494.3146613823186 960.5309651818354L494.3146613823186 960.5309651818354L606.2377383053957 960.5309651818354" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1686)"></path></g><g id="SvgjsG1688" transform="translate(463.84457591223315,1119.0437856946558)"><path id="SvgjsPath1689" d="M 0 0L 332 0L 332 40.3333333333336L 0 40.3333333333336Z" stroke="none" fill="none"></path><g id="SvgjsG1690"><text id="SvgjsText1691" font-family="微软雅黑" text-anchor="start" font-size="13px" width="332px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1692" dy="16" x="0"><tspan id="SvgjsTspan1693" style="text-decoration:;">data := &lt;-</tspan></tspan><tspan id="SvgjsTspan1694" dy="16" x="0"><tspan id="SvgjsTspan1695" style="text-decoration:;">w.responseChan&lt;/br&gt;w.popTransaction(FrameTypeR</tspan></tspan><tspan id="SvgjsTspan1696" dy="16" x="0"><tspan id="SvgjsTspan1697" style="text-decoration:;">esponse, data)</tspan></tspan></text></g></g><g id="SvgjsG1698" transform="translate(940.6665970283727,1040.5437856946553)"><path id="SvgjsPath1699" d="M 0 0L 340.9557566616387 0L 340.9557566616387 74.83333333333394L 0 74.83333333333394Z" stroke="none" fill="none"></path><g id="SvgjsG1700"><text id="SvgjsText1701" font-family="微软雅黑" text-anchor="start" font-size="13px" width="341px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1702" dy="16" x="0"><tspan id="SvgjsTspan1703" style="text-decoration:;">producerConnDelegate:&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1704" dy="16" x="0"><tspan id="SvgjsTspan1705" style="text-decoration:;">&lt;/br&gt;onConnResponse(c *Conn, data []byte)</tspan></tspan><tspan id="SvgjsTspan1706" dy="16" x="0"><tspan id="SvgjsTspan1707" style="text-decoration:;">&lt;/br&gt;w.responseChan &lt;- data </tspan></tspan></text></g></g><g id="SvgjsG1708"><path id="SvgjsPath1709" d="M243.62235369001093 927.3771190279892L340.6223536900108 927.3771190279892L340.6223536900108 1019.3518567824715L437.622353690011 1019.3518567824715" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1710)"></path></g><g id="SvgjsG1712"><path id="SvgjsPath1713" d="M928.6223536900113 1085.3771190279892L845.122353690011 1085.3771190279892L845.122353690011 1141.3771190279892L761.622353690011 1141.3771190279892" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1714)"></path></g><g id="SvgjsG1716"><path id="SvgjsPath1717" d="M805.3870595723637 910.3182954985775L1036.0047066311874 910.3182954985775L1036.0047066311874 910.3182954985775L1266.6223536900113 910.3182954985775" stroke="#323232" stroke-width="1" fill="none"></path></g><g id="SvgjsG1718"><path id="SvgjsPath1719" d="M1055.6223536900113 955.3771190279892C 1055.6223536900113 940.1771190279892 1055.6223536900113 932.5771190279893 1055.6223536900113 917.3771190279892" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1720)"></path></g><g id="SvgjsG1722" transform="translate(2771.0486467808423,396.40208046165776)"><path id="SvgjsPath1723" d="M 0 0L 222.57598524690937 0L 222.57598524690937 39.00000000000001L 0 39.00000000000001Z" stroke="none" fill="none"></path><g id="SvgjsG1724"><text id="SvgjsText1725" font-family="微软雅黑" text-anchor="start" font-size="23px" width="223px" fill="#323232" font-weight="700" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="23px" weight="700" font-style="" opacity="1" y="0.12500000000000355" transform="rotate(0)"><tspan id="SvgjsTspan1726" dy="28" x="0"><tspan id="SvgjsTspan1727" style="text-decoration:;">NSQ consumer</tspan></tspan></text></g></g><g id="SvgjsG1728"><path id="SvgjsPath1729" d="M2945.946946077338 612.9475350071125L3135.037855168248 612.9475350071125L3135.037855168248 612.9475350071125L3324.128764259157 612.9475350071125" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1730)"></path></g><g id="SvgjsG1732" transform="translate(2957.0167935169693,567.4929895525668)"><path id="SvgjsPath1733" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1734"><text id="SvgjsText1735" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1736" dy="16" x="0"><tspan id="SvgjsTspan1737" style="text-decoration:;">go handlerLoop</tspan></tspan></text></g></g><g id="SvgjsG1738" transform="translate(2791.786959489239,469.31117137074864)"><path id="SvgjsPath1739" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1740"><text id="SvgjsText1741" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1742" dy="16" x="0"><tspan id="SvgjsTspan1743" style="text-decoration:;">NewConsumer</tspan></tspan></text></g></g><g id="SvgjsG1744" transform="translate(2791.786959489239,584.1872044285999)"><path id="SvgjsPath1745" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1746"><text id="SvgjsText1747" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1748" dy="16" x="0"><tspan id="SvgjsTspan1749" style="text-decoration:;">AddHandler</tspan></tspan></text></g></g><g id="SvgjsG1750" transform="translate(2791.786959489239,683.278113519509)"><path id="SvgjsPath1751" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1752"><text id="SvgjsText1753" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1754" dy="16" x="0"><tspan id="SvgjsTspan1755" style="text-decoration:;">ConnectToNSQLookupd</tspan></tspan></text></g></g><g id="SvgjsG1756" transform="translate(2861.786959489239,790.5508407922362)"><path id="SvgjsPath1757" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1758"><text id="SvgjsText1759" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1760" dy="16" x="0"><tspan id="SvgjsTspan1761" style="text-decoration:;">ConnectToNSQD</tspan></tspan></text></g></g><g id="SvgjsG1762"><path id="SvgjsPath1763" d="M2945.946946077338 710.2202622798395L3100.0378551682475 710.2202622798395L3100.0378551682475 710.2202622798395L3254.1287642591565 710.2202622798395" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1764)"></path></g><g id="SvgjsG1766"><path id="SvgjsPath1767" d="M3183.5944769580387 909.0383876506285L3391.109554492895 909.0383876506285L3391.109554492895 909.0383876506285L3598.6246320277514 909.0383876506285" stroke="#323232" stroke-width="1" fill="none"></path></g><g id="SvgjsG1768" transform="translate(3613.1700865732064,888.1293018731183)"><path id="SvgjsPath1769" d="M 0 0L 59.96984493028708 0L 59.96984493028708 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1770"><text id="SvgjsText1771" font-family="微软雅黑" text-anchor="start" font-size="13px" width="60px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1772" dy="16" x="0"><tspan id="SvgjsTspan1773" style="text-decoration:;">nsqd</tspan></tspan></text></g></g><g id="SvgjsG1774" transform="translate(2996.5944769580387,812.0383876506282)"><path id="SvgjsPath1775" d="M 0 0L 405.03015506971263 0L 405.03015506971263 32.371905958027526L 0 32.371905958027526Z" stroke="none" fill="none"></path><g id="SvgjsG1776"><text id="SvgjsText1777" font-family="微软雅黑" text-anchor="start" font-size="13px" width="406px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.560952979013763" transform="rotate(0)"><tspan id="SvgjsTspan1778" dy="16" x="0"><tspan id="SvgjsTspan1779" style="text-decoration:;">conn := NewConn(addr, &amp;r.config, &amp;consumerConnDelegate{r})</tspan></tspan></text></g></g><g id="SvgjsG1780" transform="translate(2996.5944769580387,1056.765716825294)"><path id="SvgjsPath1781" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1782"><text id="SvgjsText1783" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1784" dy="16" x="0"><tspan id="SvgjsTspan1785" style="text-decoration:;">cmd: SUB</tspan></tspan></text></g></g><g id="SvgjsG1786" transform="translate(3150.568934540694,888.1293018731183)"><path id="SvgjsPath1787" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1788"><text id="SvgjsText1789" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1790" dy="16" x="0"><tspan id="SvgjsTspan1791" style="text-decoration:;">Dial</tspan></tspan></text></g></g><g id="SvgjsG1792" transform="translate(3150.568934540694,920.2160453773454)"><path id="SvgjsPath1793" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1794"><text id="SvgjsText1795" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1796" dy="16" x="0"><tspan id="SvgjsTspan1797" style="text-decoration:;">identify</tspan></tspan></text></g></g><g id="SvgjsG1798"><path id="SvgjsPath1799" d="M3148.015964561345 997.3978635591639L3371.1440637348983 997.3978635591639L3371.1440637348983 997.3978635591639L3594.2721629084517 997.3978635591639" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1800)"></path></g><g id="SvgjsG1802" transform="translate(3156.5944769580387,960.0508027718852)"><path id="SvgjsPath1803" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1804"><text id="SvgjsText1805" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1806" dy="16" x="0"><tspan id="SvgjsTspan1807" style="text-decoration:;">go readloop</tspan></tspan></text></g></g><g id="SvgjsG1808"><path id="SvgjsPath1809" d="M3149.2796783423473 1075.1251927338294L3290.6431764098706 1075.1251927338294L3290.6431764098706 1075.1251927338294L3432.006674477394 1075.1251927338294" stroke="#323232" stroke-width="1" fill="none" marker-start="url(#SvgjsMarker1810)"></path></g><g id="SvgjsG1812" transform="translate(3156.5944769580387,1030.0508027718852)"><path id="SvgjsPath1813" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1814"><text id="SvgjsText1815" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1816" dy="16" x="0"><tspan id="SvgjsTspan1817" style="text-decoration:;">go writeloop</tspan></tspan></text></g></g><g id="SvgjsG1818" transform="translate(3212.561419106799,1086.765716825294)"><path id="SvgjsPath1819" d="M 0 0L 265.45454545454606 0L 265.45454545454606 23.636363636363626L 0 23.636363636363626Z" stroke="none" fill="none"></path><g id="SvgjsG1820"><text id="SvgjsText1821" font-family="微软雅黑" text-anchor="start" font-size="13px" width="266px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.193181818181813" transform="rotate(0)"><tspan id="SvgjsTspan1822" dy="16" x="0"><tspan id="SvgjsTspan1823" style="text-decoration:;">resp := &lt;- c.msgResponseChan</tspan></tspan></text></g></g><g id="SvgjsG1824" transform="translate(3212.561419106799,1122.9475350071125)"><path id="SvgjsPath1825" d="M 0 0L 265.45454545454606 0L 265.45454545454606 23.636363636363626L 0 23.636363636363626Z" stroke="none" fill="none"></path><g id="SvgjsG1826"><text id="SvgjsText1827" font-family="微软雅黑" text-anchor="start" font-size="13px" width="266px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="2.193181818181813" transform="rotate(0)"><tspan id="SvgjsTspan1828" dy="16" x="0"><tspan id="SvgjsTspan1829" style="text-decoration:;">cmd: FIN/REQ</tspan></tspan></text></g></g><g id="SvgjsG1830" transform="translate(3443.3591435966937,990.0508027718852)"><path id="SvgjsPath1831" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1832"><text id="SvgjsText1833" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1834" dy="16" x="0"><tspan id="SvgjsTspan1835" style="text-decoration:;">ReadUnpackedResponse</tspan></tspan></text></g></g><g id="SvgjsG1836" transform="translate(3443.3591435966937,1016.765716825294)"><path id="SvgjsPath1837" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1838"><text id="SvgjsText1839" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1840" dy="16" x="0"><tspan id="SvgjsTspan1841" style="text-decoration:;">DecodeMessage</tspan></tspan></text></g></g><g id="SvgjsG1842" transform="translate(2957.0167935169693,668.0489625052339)"><path id="SvgjsPath1843" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1844"><text id="SvgjsText1845" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1846" dy="16" x="0"><tspan id="SvgjsTspan1847" style="text-decoration:;">go lookupdLoop</tspan></tspan></text></g></g><g id="SvgjsG1848" transform="translate(3347.3519047550244,542.9475350071122)"><path id="SvgjsPath1849" d="M 0 0L 291.81818181818187 0L 291.81818181818187 74.5454545454545L 0 74.5454545454545Z" stroke="none" fill="none"></path><g id="SvgjsG1850"><text id="SvgjsText1851" font-family="微软雅黑" text-anchor="start" font-size="13px" width="292px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.147727272727252" transform="rotate(0)"><tspan id="SvgjsTspan1852" dy="16" x="0"><tspan id="SvgjsTspan1853" style="text-decoration:;">msg := &lt;-</tspan></tspan><tspan id="SvgjsTspan1854" dy="16" x="0"><tspan id="SvgjsTspan1855" style="text-decoration:;">r.incomingMessages&lt;/br&gt;handle.HandleMess</tspan></tspan><tspan id="SvgjsTspan1856" dy="16" x="0"><tspan id="SvgjsTspan1857" style="text-decoration:;">age(msg)&lt;/br&gt;message.Finish()</tspan></tspan></text></g></g><g id="SvgjsG1858" transform="translate(3343.0541326463895,469.765716825294)"><path id="SvgjsPath1859" d="M 0 0L 285.4545454545455 0L 285.4545454545455 39.09090909090909L 0 39.09090909090909Z" stroke="none" fill="none"></path><g id="SvgjsG1860"><text id="SvgjsText1861" font-family="微软雅黑" text-anchor="start" font-size="13px" width="286px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.920454545454547" transform="rotate(0)"><tspan id="SvgjsTspan1862" dy="16" x="0"><tspan id="SvgjsTspan1863" style="text-decoration:;">Interface: HandleMessage</tspan></tspan></text></g></g><g id="SvgjsG1864" transform="translate(3183.0541326463895,718.4020804616575)"><path id="SvgjsPath1865" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1866"><text id="SvgjsText1867" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1868" dy="16" x="0"><tspan id="SvgjsTspan1869" style="text-decoration:;">nsqds</tspan></tspan></text></g></g><g id="SvgjsG1870" transform="translate(3028.2609956641154,718.4020804616575)"><path id="SvgjsPath1871" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1872"><text id="SvgjsText1873" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1874" dy="16" x="0"><tspan id="SvgjsTspan1875" style="text-decoration:;">ticker querylookupd</tspan></tspan></text></g></g><g id="SvgjsG1876" transform="translate(3347.3519047550244,634.1872044285998)"><path id="SvgjsPath1877" d="M 0 0L 359.5041322314048 0L 359.5041322314048 74.54545454545479L 0 74.54545454545479Z" stroke="none" fill="none"></path><g id="SvgjsG1878"><text id="SvgjsText1879" font-family="微软雅黑" text-anchor="start" font-size="13px" width="360px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="11.147727272727394" transform="rotate(0)"><tspan id="SvgjsTspan1880" dy="16" x="0"><tspan id="SvgjsTspan1881" style="text-decoration:;">connMessageDelegate:&lt;/br&gt;</tspan></tspan><tspan id="SvgjsTspan1882" dy="16" x="0"><tspan id="SvgjsTspan1883" style="text-decoration:;">&lt;/br&gt;m.Delegate.OnFinish(m)</tspan></tspan><tspan id="SvgjsTspan1884" dy="16" x="0"><tspan id="SvgjsTspan1885" style="text-decoration:;">&lt;/br&gt;Conn.msgResponseChan &lt;- msgResponse</tspan></tspan></text></g></g><g id="SvgjsG1886" transform="translate(3673.1399315034932,862.3069544682544)"><path id="SvgjsPath1887" d="M 0 0L 220.4847005242582 0L 220.4847005242582 41.095125993403144L 0 41.095125993403144Z" stroke="none" fill="none"></path><g id="SvgjsG1888"><text id="SvgjsText1889" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="221px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.922562996701572" transform="rotate(0)"><tspan id="SvgjsTspan1890" dy="16" x="110.5"><tspan id="SvgjsTspan1891" style="text-decoration:;">c.delegate.OnMessage(c, msg)</tspan></tspan></text></g></g><g id="SvgjsG1892" transform="translate(3619.1700865732064,539.3111713707486)"><path id="SvgjsPath1893" d="M 0 0L 266.36363636363603 0L 266.36363636363603 54.87603305785126L 0 54.87603305785126Z" stroke="none" fill="none"></path><g id="SvgjsG1894"><text id="SvgjsText1895" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="267px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="9.31301652892563" transform="rotate(0)"><tspan id="SvgjsTspan1896" dy="16" x="133.5"><tspan id="SvgjsTspan1897" style="text-decoration:;">Consumer.onConnMessage&lt;/br&gt;r.incomin</tspan></tspan><tspan id="SvgjsTspan1898" dy="16" x="133.5"><tspan id="SvgjsTspan1899" style="text-decoration:;">gMessages &lt;- msg</tspan></tspan></text></g></g><g id="SvgjsG1900"><path id="SvgjsPath1901" d="M3558.6246320277514 1039.4020804616575L3684.1246320277514 1039.4020804616575L3684.1246320277514 908.678860426282L3809.6246320277514 908.678860426282" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1902)"></path></g><g id="SvgjsG1904"><path id="SvgjsPath1905" d="M3756.4428138459334 852.0383876506285L3756.4428138459334 724.720234056143L3756.4428138459334 724.720234056143L3756.4428138459334 597.4020804616576" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1906)"></path></g><g id="SvgjsG1908"><path id="SvgjsPath1909" d="M3641.508678100935 563.9475350071123L3600.475745973434 563.9475350071123L3600.475745973434 563.9475350071123L3559.4428138459334 563.9475350071123" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1910)"></path></g><g id="SvgjsG1912"><path id="SvgjsPath1913" d="M3433.6246320277514 715.4020804616575L3433.6246320277514 949.4020804616575L3359.6246320277514 949.4020804616575L3359.6246320277514 1075.4020804616575" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1914)"></path></g><g id="SvgjsG1916"><path id="SvgjsPath1917" d="M3511.7267083629977 921.1293018731185L3511.7267083629977 952.3545200307467L3511.7267083629977 952.3545200307467L3511.7267083629977 983.5797381883749" stroke-dasharray="8,5" stroke="#ff6666" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1918)"></path></g><g id="SvgjsG1920"><path id="SvgjsPath1921" d="M3323.7267083629977 1076.1251927338294L3323.7267083629977 996.2636365977437L3323.7267083629977 996.2636365977437L3323.7267083629977 916.4020804616575" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker1922)"></path></g><g id="SvgjsG1924"><path id="SvgjsPath1925" d="M3422.8064502095694 502.40208046165765L3422.8064502095694 556.4020804616576" stroke-dasharray="8,5" stroke="#99ff99" stroke-width="1" fill="none"></path></g><g id="SvgjsG1926" transform="translate(2996.5944769580387,1084.765716825294)"><path id="SvgjsPath1927" d="M 0 0L 160 0L 160 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1928"><text id="SvgjsText1929" font-family="微软雅黑" text-anchor="start" font-size="13px" width="160px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="10.375" transform="rotate(0)"><tspan id="SvgjsTspan1930" dy="16" x="0"><tspan id="SvgjsTspan1931" style="text-decoration:;">cmd: RDY</tspan></tspan></text></g></g><g id="SvgjsG1932"><path id="SvgjsPath1933" d="M2781.6246320277514 450.40208046165776L2781.6246320277514 578.2399330673541L2781.6246320277514 578.2399330673541L2781.6246320277514 706.0777856730506" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1934"><path id="SvgjsPath1935" d="M2975.685386048948 822.4020804616578L2975.685386048948 964.9020804616575L2975.685386048948 964.9020804616575L2975.685386048948 1107.4020804616575" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1936"><path id="SvgjsPath1937" d="M3130.6246320277514 891.6788604262817L3130.6246320277514 986.0308861728508L3130.6246320277514 986.0308861728508L3130.6246320277514 1080.3829119194197" stroke="#990000" stroke-width="1" fill="none"></path></g><g id="SvgjsG1938" transform="translate(2996.5944769580387,859.3069544682544)"><path id="SvgjsPath1939" d="M 0 0L 176.03015506971263 0L 176.03015506971263 32.37190595802758L 0 32.37190595802758Z" stroke="none" fill="none"></path><g id="SvgjsG1940"><text id="SvgjsText1941" font-family="微软雅黑" text-anchor="start" font-size="13px" width="177px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="6.560952979013791" transform="rotate(0)"><tspan id="SvgjsTspan1942" dy="16" x="0"><tspan id="SvgjsTspan1943" style="text-decoration:;">resp, err := conn.Connect()</tspan></tspan></text></g></g><g id="SvgjsG1944" transform="translate(25.00330607096322,61.06280743633761)"><path id="SvgjsPath1945" d="M 0 0L 266 0L 266 40L 0 40Z" stroke="none" fill="none"></path><g id="SvgjsG1946"><text id="SvgjsText1947" font-family="微软雅黑" text-anchor="start" font-size="23px" width="266px" fill="#323232" font-weight="700" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="23px" weight="700" font-style="" opacity="1" y="-4.875" transform="rotate(0)"><tspan id="SvgjsTspan1948" dy="28" x="0"><tspan id="SvgjsTspan1949" style="text-decoration:;">NSQ 总体架构图</tspan></tspan></text></g></g><g id="SvgjsG1950" transform="translate(25.00330607096322,121.06280743633761)"><path id="SvgjsPath1951" d="M 0 0L 210.33333333333366 0L 210.33333333333366 41.40740740741239L 0 41.40740740741239Z" stroke="none" fill="none"></path><g id="SvgjsG1952"><text id="SvgjsText1953" font-family="微软雅黑" text-anchor="start" font-size="13px" width="211px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan1954" dy="16" x="0"><tspan id="SvgjsTspan1955" style="text-decoration:;">author: 好刚</tspan></tspan></text></g></g><g id="SvgjsG1956" transform="translate(372.8366394042969,302.00643384798605)"><path id="SvgjsPath1957" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1958"><text id="SvgjsText1959" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.375" transform="rotate(0)"><tspan id="SvgjsTspan1960" dy="16" x="50"><tspan id="SvgjsTspan1961" style="text-decoration:;">producer</tspan></tspan></text></g></g><g id="SvgjsG1962"><path id="SvgjsPath1963" d="M473.8366394042969 337.00643384798605L575.8366394042969 337.00643384798605L575.8366394042969 337.00643384798605L675.2366394042969 337.00643384798605" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1964)"></path></g><g id="SvgjsG1966" transform="translate(678.8366394042969,302.00643384798605)"><path id="SvgjsPath1967" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1968"><text id="SvgjsText1969" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.375" transform="rotate(0)"><tspan id="SvgjsTspan1970" dy="16" x="50"><tspan id="SvgjsTspan1971" style="text-decoration:;">nsqd</tspan></tspan></text></g></g><g id="SvgjsG1972"><path id="SvgjsPath1973" d="M779.8366394042969 337.00643384798605L882.8366394042973 337.00643384798605L882.8366394042973 337.00643384798605L983.2366394042974 337.00643384798605" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1974)"></path></g><g id="SvgjsG1976" transform="translate(986.8366394042973,302.00643384798605)"><path id="SvgjsPath1977" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1978"><text id="SvgjsText1979" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.375" transform="rotate(0)"><tspan id="SvgjsTspan1980" dy="16" x="50"><tspan id="SvgjsTspan1981" style="text-decoration:;">consumer</tspan></tspan></text></g></g><g id="SvgjsG1982"><path id="SvgjsPath1983" d="M728.8366394042969 301.00643384798605L728.8366394042969 259.006433847986L728.8366394042969 259.006433847986L728.8366394042969 219.606433847986" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1984)"></path></g><g id="SvgjsG1986" transform="translate(678.8366394042969,146.006433847986)"><path id="SvgjsPath1987" d="M 0 4Q 0 0 4 0L 96 0Q 100 0 100 4L 100 66Q 100 70 96 70L 4 70Q 0 70 0 66Z" stroke="rgba(50,50,50,1)" stroke-width="2" fill-opacity="1" fill="#ffffff"></path><g id="SvgjsG1988"><text id="SvgjsText1989" font-family="微软雅黑" text-anchor="middle" font-size="13px" width="80px" fill="#323232" font-weight="400" align="middle" lineHeight="125%" anchor="middle" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="25.375" transform="rotate(0)"><tspan id="SvgjsTspan1990" dy="16" x="50"><tspan id="SvgjsTspan1991" style="text-decoration:;">lookupd</tspan></tspan></text></g></g><g id="SvgjsG1992"><path id="SvgjsPath1993" d="M779.7420140340746 181.43104753094372L1033.5772907370977 300.4778245893382" stroke="#323232" stroke-width="2" fill="none" marker-end="url(#SvgjsMarker1994)"></path></g><g id="SvgjsG1996" transform="translate(1418.435089895603,1573.210452361321)"><path id="SvgjsPath1997" d="M 0 0L 154.3333333333332 0L 154.3333333333332 26.666666666667652L 0 26.666666666667652Z" stroke="none" fill="none"></path><g id="SvgjsG1998"><text id="SvgjsText1999" font-family="微软雅黑" text-anchor="start" font-size="13px" width="155px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan2000" dy="16" x="0"><tspan id="SvgjsTspan2001" style="text-decoration:;">n.notifyChan &lt;- v</tspan></tspan></text></g></g><g id="SvgjsG2002" transform="translate(1473.497589895603,1976.2104523613198)"><path id="SvgjsPath2003" d="M 0 0L 154.3333333333332 0L 154.3333333333332 26.666666666667652L 0 26.666666666667652Z" stroke="none" fill="none"></path><g id="SvgjsG2004"><text id="SvgjsText2005" font-family="微软雅黑" text-anchor="start" font-size="13px" width="155px" fill="#323232" font-weight="400" align="top" lineHeight="125%" anchor="start" family="微软雅黑" size="13px" weight="400" font-style="" opacity="1" y="-1.625" transform="rotate(0)"><tspan id="SvgjsTspan2006" dy="16" x="0"><tspan id="SvgjsTspan2007" style="text-decoration:;">n.notifyChan &lt;- v</tspan></tspan></text></g></g><g id="SvgjsG2008"><path id="SvgjsPath2009" d="M1596.7684232289362 1983.5808227316938L2409.7684232289357 1983.5808227316938L2409.7684232289357 1386.5808227316945L2466.7684232289357 1386.5808227316945" stroke-dasharray="8,5" stroke="#6666ff" stroke-width="1" fill="none" marker-end="url(#SvgjsMarker2010)"></path></g></svg>