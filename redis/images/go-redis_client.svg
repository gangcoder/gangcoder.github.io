<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="4237px" height="1501px" viewBox="-0.5 -0.5 4237 1501" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-11-15T14:03:35.349Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/12.6.5 Chrome/80.0.3987.86 Electron/8.0.0 Safari/537.36&quot; etag=&quot;k1GZY4uZNYsKohOzpBiZ&quot; version=&quot;12.6.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;jZFyDZuk8lLCigE1D3V7&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-2005-171-143-26-0"><rect x="2005" y="171" width="143" height="26"/></clipPath><clipPath id="mx-clip-1039-391-161-26-0"><rect x="1039" y="391" width="161" height="26"/></clipPath><clipPath id="mx-clip-1039-417-161-26-0"><rect x="1039" y="417" width="161" height="26"/></clipPath><clipPath id="mx-clip-1039-443-161-26-0"><rect x="1039" y="443" width="161" height="26"/></clipPath><clipPath id="mx-clip-425-461-303-26-0"><rect x="425" y="461" width="303" height="26"/></clipPath><clipPath id="mx-clip-425-487-303-26-0"><rect x="425" y="487" width="303" height="26"/></clipPath><clipPath id="mx-clip-425-513-303-26-0"><rect x="425" y="513" width="303" height="26"/></clipPath><clipPath id="mx-clip-1255-783-197-26-0"><rect x="1255" y="783" width="197" height="26"/></clipPath><clipPath id="mx-clip-1255-809-197-26-0"><rect x="1255" y="809" width="197" height="26"/></clipPath><clipPath id="mx-clip-1255-835-197-26-0"><rect x="1255" y="835" width="197" height="26"/></clipPath><clipPath id="mx-clip-1255-861-197-26-0"><rect x="1255" y="861" width="197" height="26"/></clipPath></defs><g><path d="M 2000 166 L 2000 140 L 2148 140 L 2148 166" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 2000 166 L 2000 192 L 2148 192 L 2148 166" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 2000 166 L 2148 166" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="2006.5" y="158">Options</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2005-171-143-26-0)" font-size="13px"><text x="2006.5" y="184.5">- Addr: string</text></g><path d="M 1034 386 L 1034 360 L 1200 360 L 1200 386" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1034 386 L 1034 464 L 1200 464 L 1200 386" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1034 386 L 1200 386" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="1040.5" y="378">Client</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1039-391-161-26-0)" font-size="13px"><text x="1040.5" y="404.5">- : *baseClient</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1039-417-161-26-0)" font-size="13px"><text x="1040.5" y="430.5">- : cmdable</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1039-443-161-26-0)" font-size="13px"><text x="1040.5" y="456.5">- : hooks</text></g><path d="M 420 456 L 420 430 L 728 430 L 728 456" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 420 456 L 420 534 L 728 534 L 728 456" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 420 456 L 728 456" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="426.5" y="448">ConnPool</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-425-461-303-26-0)" font-size="13px"><text x="426.5" y="474.5">- opt: *Options</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-425-487-303-26-0)" font-size="13px"><text x="426.5" y="500.5">- conns: []*Conn</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-425-513-303-26-0)" font-size="13px"><text x="426.5" y="526.5">- idleConns: []*Conn</text></g><path d="M 1250 777.5 L 1250 751.5 L 1452 751.5 L 1452 777.5" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1250 777.5 L 1250 881.5 L 1452 881.5 L 1452 777.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1250 777.5 L 1452 777.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="1256.5" y="769.5">Conn</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1255-783-197-26-0)" font-size="13px"><text x="1256.5" y="796">- netConn: net.Conn</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1255-809-197-26-0)" font-size="13px"><text x="1256.5" y="822">- rd: *proto.Reader</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1255-835-197-26-0)" font-size="13px"><text x="1256.5" y="848">- bw: *bufio.Writer</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1255-861-197-26-0)" font-size="13px"><text x="1256.5" y="874">- wr: *proto.Writer</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 173px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">1. 创建redis 客户端</div></div></div></foreignObject><text x="32" y="177" fill="#000000" font-family="source code pro" font-size="13px">1. 创建redis 客户端</text></switch></g><rect x="30" y="190" width="268" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 261px; height: 1px; padding-top: 220px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">rdb := redis.NewClient(...)</div></div></div></foreignObject><text x="37" y="224" fill="#000000" font-family="source code pro" font-size="13px">rdb := redis.NewClient(...)</text></switch></g><rect x="390" y="190" width="252" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 245px; height: 1px; padding-top: 220px; margin-left: 397px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewClient(opt *Options)</div></div></div></foreignObject><text x="397" y="224" fill="#000000" font-family="source code pro" font-size="13px">func NewClient(opt *Options)</text></switch></g><rect x="750" y="190" width="115" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 108px; height: 1px; padding-top: 220px; margin-left: 757px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">opt.init()</div></div></div></foreignObject><text x="757" y="224" fill="#000000" font-family="source code pro" font-size="13px">opt.init()</text></switch></g><rect x="750" y="260" width="450" height="67" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 443px; height: 1px; padding-top: 294px; margin-left: 757px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">c := Client{<br />    baseClient: newBaseClient(opt, newConnPool(opt)),<br />}</div></div></div></foreignObject><text x="757" y="297" fill="#000000" font-family="source code pro" font-size="13px">c := Client{...</text></switch></g><rect x="750" y="340" width="198" height="57" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 191px; height: 1px; padding-top: 369px; margin-left: 757px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">c.cmdable = c.Process<br />return &amp;c</div></div></div></foreignObject><text x="757" y="372" fill="#000000" font-family="source code pro" font-size="13px">c.cmdable = c.Process...</text></switch></g><rect x="1020" y="190" width="79" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 72px; height: 1px; padding-top: 220px; margin-left: 1027px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">init()</div></div></div></foreignObject><text x="1027" y="224" fill="#000000" font-family="source code pro" font-size="13px">init()</text></switch></g><path d="M 2000 153 L 1954 153 Q 1944 153 1944 163 L 1944 185 Q 1944 195 1934 195 L 1894.37 195" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1889.12 195 L 1896.12 191.5 L 1894.37 195 L 1896.12 198.5 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><rect x="1233" y="140" width="655" height="110" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 648px; height: 1px; padding-top: 195px; margin-left: 1240px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">opt.Dialer = func(ctx context.Context, network, addr string) (net.Conn, error) {<br />    netDialer := &amp;net.Dialer{<br />        KeepAlive: 5 * time.Minute,<br />    }<br />    return netDialer.DialContext(ctx, network, addr)<br />}</div></div></div></foreignObject><text x="1240" y="199" fill="#000000" font-family="source code pro" font-size="13px">opt.Dialer = func(ctx context.Context, network, addr string) (net.Conn, error) {...</text></switch></g><rect x="1671" y="263.5" width="799" height="156" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 792px; height: 1px; padding-top: 342px; margin-left: 1678px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return pool.NewConnPool(&amp;pool.Options{<br />    Dialer: func(ctx context.Context) (net.Conn, error) {<br />        err := internal.WithSpan(ctx, "dialer", func(ctx context.Context, span trace.Span) error {<br />            conn, err = opt.Dialer(ctx, opt.Network, opt.Addr)<br />            return err<br />        })<br />        return conn, err<br />    },<br />})</div></div></div></foreignObject><text x="1678" y="345" fill="#000000" font-family="source code pro" font-size="13px">return pool.NewConnPool(&amp;pool.Options{...</text></switch></g><rect x="1280" y="448" width="232" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 225px; height: 1px; padding-top: 478px; margin-left: 1287px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func newBaseClient(...)</div></div></div></foreignObject><text x="1287" y="482" fill="#000000" font-family="source code pro" font-size="13px">func newBaseClient(...)</text></switch></g><rect x="1654" y="430" width="234" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 227px; height: 1px; padding-top: 478px; margin-left: 1661px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;baseClient{<br />    opt:      opt,<br />    connPool: connPool,<br />}</div></div></div></foreignObject><text x="1661" y="482" fill="#000000" font-family="source code pro" font-size="13px">return &amp;baseClient{...</text></switch></g><path d="M 298 220 L 383.63 220" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 388.88 220 L 381.88 223.5 L 383.63 220 L 381.88 216.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 642 220 L 743.63 220" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 748.88 220 L 741.88 223.5 L 743.63 220 L 741.88 216.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 642 220 L 690 220 Q 700 220 700 230 L 700 284 Q 700 294 710 294 L 743.63 294" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 748.88 294 L 741.88 297.5 L 743.63 294 L 741.88 290.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 642 220 L 690 220 Q 700 220 700 230 L 700 359 Q 700 369 710 369 L 743.63 369" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 748.88 369 L 741.88 372.5 L 743.63 369 L 741.88 365.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 865 220 L 1013.63 220" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1018.88 220 L 1011.88 223.5 L 1013.63 220 L 1011.88 216.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1099 220 L 1156 220 Q 1166 220 1166 210 L 1166 202.5 Q 1166 195 1176 195 L 1226.63 195" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1231.88 195 L 1224.88 198.5 L 1226.63 195 L 1224.88 191.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1200 293.5 L 1273.63 293.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1278.88 293.5 L 1271.88 297 L 1273.63 293.5 L 1271.88 290 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1575 293.5 L 1613 293.5 Q 1623 293.5 1623 303.5 L 1623 331.5 Q 1623 341.5 1633 341.5 L 1664.63 341.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1669.88 341.5 L 1662.88 345 L 1664.63 341.5 L 1662.88 338 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1200 293.5 L 1230 293.5 Q 1240 293.5 1240 303.5 L 1240 468 Q 1240 478 1250 478 L 1273.63 478" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1278.88 478 L 1271.88 481.5 L 1273.63 478 L 1271.88 474.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1512 478 L 1647.63 478" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1652.88 478 L 1645.88 481.5 L 1647.63 478 L 1645.88 474.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 560px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">2. 连接池</div></div></div></foreignObject><text x="32" y="564" fill="#000000" font-family="source code pro" font-size="13px">2. 连接池</text></switch></g><rect x="30" y="580" width="295" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 610px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewConnPool(opt *Options)</div></div></div></foreignObject><text x="37" y="614" fill="#000000" font-family="source code pro" font-size="13px">func NewConnPool(opt *Options)</text></switch></g><rect x="420" y="564.5" width="420" height="91" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 413px; height: 1px; padding-top: 610px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">p := &amp;ConnPool{<br />    opt: opt,<br />    conns:     make([]*Conn, 0, opt.PoolSize),<br />    idleConns: make([]*Conn, 0, opt.PoolSize),<br />}</div></div></div></foreignObject><text x="427" y="614" fill="#000000" font-family="source code pro" font-size="13px">p := &amp;ConnPool{...</text></switch></g><rect x="948" y="580" width="214" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 207px; height: 1px; padding-top: 610px; margin-left: 955px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">p.checkMinIdleConns()</div></div></div></foreignObject><text x="955" y="614" fill="#000000" font-family="source code pro" font-size="13px">p.checkMinIdleConns()</text></switch></g><rect x="948" y="655.5" width="340" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 333px; height: 1px; padding-top: 692px; margin-left: 955px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">go p.reaper(opt.IdleCheckFrequency)<br />return p</div></div></div></foreignObject><text x="955" y="695" fill="#000000" font-family="source code pro" font-size="13px">go p.reaper(opt.IdleCheckFrequency)...</text></switch></g><rect x="1240" y="580" width="196" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 189px; height: 1px; padding-top: 610px; margin-left: 1247px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">checkMinIdleConns()</div></div></div></foreignObject><text x="1247" y="614" fill="#000000" font-family="source code pro" font-size="13px">checkMinIdleConns()</text></switch></g><rect x="1530" y="564.5" width="610" height="91" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 603px; height: 1px; padding-top: 610px; margin-left: 1537px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for p.poolSize &lt; p.opt.PoolSize &amp;&amp; p.idleConnsLen &lt; p.opt.MinIdleConns {<br />    go func() {<br />        err := p.addIdleConn()<br />    }()<br />}</div></div></div></foreignObject><text x="1537" y="614" fill="#000000" font-family="source code pro" font-size="13px">for p.poolSize &lt; p.opt.PoolSize &amp;&amp; p.idleConnsLen &lt; p.opt.MinIdleConns {...</text></switch></g><rect x="2230" y="580" width="142" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 135px; height: 1px; padding-top: 610px; margin-left: 2237px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">addIdleConn()</div></div></div></foreignObject><text x="2237" y="614" fill="#000000" font-family="source code pro" font-size="13px">addIdleConn()</text></switch></g><rect x="2458" y="562" width="412" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 405px; height: 1px; padding-top: 610px; margin-left: 2465px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">cn, err := p.dialConn(context.TODO(), true)<br />p.conns = append(p.conns, cn)<br />p.idleConns = append(p.idleConns, cn)<br />return nil</div></div></div></foreignObject><text x="2465" y="614" fill="#000000" font-family="source code pro" font-size="13px">cn, err := p.dialConn(context.TODO(), true)...</text></switch></g><rect x="2952" y="580" width="142" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 135px; height: 1px; padding-top: 610px; margin-left: 2959px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">dialConn(...)</div></div></div></foreignObject><text x="2959" y="614" fill="#000000" font-family="source code pro" font-size="13px">dialConn(...)</text></switch></g><rect x="3166" y="562" width="322" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 315px; height: 1px; padding-top: 610px; margin-left: 3173px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">netConn, err := p.opt.Dialer(ctx)<br />cn := NewConn(netConn)<br />cn.pooled = pooled<br />return cn, nil</div></div></div></foreignObject><text x="3173" y="614" fill="#000000" font-family="source code pro" font-size="13px">netConn, err := p.opt.Dialer(ctx)...</text></switch></g><rect x="1367" y="661.5" width="293" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 286px; height: 1px; padding-top: 692px; margin-left: 1374px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">reaper(frequency time.Duration)</div></div></div></foreignObject><text x="1374" y="695" fill="#000000" font-family="source code pro" font-size="13px">reaper(frequency time.Duration)</text></switch></g><rect x="1740" y="661.5" width="361" height="120" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 354px; height: 1px; padding-top: 722px; margin-left: 1747px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for {<br />    select {<br />    case &lt;-ticker.C:<br />        _, err := p.ReapStaleConns()<br />    }<br />}</div></div></div></foreignObject><text x="1747" y="725" fill="#000000" font-family="source code pro" font-size="13px">for {...</text></switch></g><rect x="2190" y="691.5" width="169" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 162px; height: 1px; padding-top: 722px; margin-left: 2197px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">ReapStaleConns()</div></div></div></foreignObject><text x="2197" y="725" fill="#000000" font-family="source code pro" font-size="13px">ReapStaleConns()</text></switch></g><rect x="2458" y="673.5" width="291" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 284px; height: 1px; padding-top: 722px; margin-left: 2465px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for {<br />    cn := p.reapStaleConn()<br />}<br />return n, nil</div></div></div></foreignObject><text x="2465" y="725" fill="#000000" font-family="source code pro" font-size="13px">for {...</text></switch></g><rect x="2845" y="691.5" width="160" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 153px; height: 1px; padding-top: 722px; margin-left: 2852px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">reapStaleConn()</div></div></div></foreignObject><text x="2852" y="725" fill="#000000" font-family="source code pro" font-size="13px">reapStaleConn()</text></switch></g><rect x="3107" y="661.5" width="241" height="120" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 234px; height: 1px; padding-top: 722px; margin-left: 3114px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">cn := p.idleConns[0]<br />if !p.isStaleConn(cn) {<br />    return nil<br />}<br />p.removeConn(cn)<br />return cn</div></div></div></foreignObject><text x="3114" y="725" fill="#000000" font-family="source code pro" font-size="13px">cn := p.idleConns[0]...</text></switch></g><rect x="3407" y="691.5" width="205" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 198px; height: 1px; padding-top: 722px; margin-left: 3414px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">removeConn(cn *Conn)</div></div></div></foreignObject><text x="3414" y="725" fill="#000000" font-family="source code pro" font-size="13px">removeConn(cn *Conn)</text></switch></g><rect x="3745" y="661.5" width="461" height="120" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 454px; height: 1px; padding-top: 722px; margin-left: 3752px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for i, c := range p.conns {<br />    if c == cn {<br />        p.conns = append(p.conns[:i], p.conns[i+1:]...)<br />        return<br />    }<br />}</div></div></div></foreignObject><text x="3752" y="725" fill="#000000" font-family="source code pro" font-size="13px">for i, c := range p.conns {...</text></switch></g><path d="M 325 610 L 413.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 418.88 610 L 411.88 613.5 L 413.63 610 L 411.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 840 610 L 941.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 946.88 610 L 939.88 613.5 L 941.63 610 L 939.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 840 610 L 884 610 Q 894 610 894 620 L 894 681.5 Q 894 691.5 904 691.5 L 941.63 691.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 946.88 691.5 L 939.88 695 L 941.63 691.5 L 939.88 688 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1162 610 L 1233.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1238.88 610 L 1231.88 613.5 L 1233.63 610 L 1231.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1436 610 L 1523.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1528.88 610 L 1521.88 613.5 L 1523.63 610 L 1521.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2140 610 L 2223.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2228.88 610 L 2221.88 613.5 L 2223.63 610 L 2221.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2372 610 L 2451.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2456.88 610 L 2449.88 613.5 L 2451.63 610 L 2449.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2870 610 L 2945.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2950.88 610 L 2943.88 613.5 L 2945.63 610 L 2943.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3094 610 L 3159.63 610" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3164.88 610 L 3157.88 613.5 L 3159.63 610 L 3157.88 606.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1288 691.5 L 1360.63 691.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1365.88 691.5 L 1358.88 695 L 1360.63 691.5 L 1358.88 688 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1660 691.5 L 1690 691.5 Q 1700 691.5 1700 701.5 L 1700 711.5 Q 1700 721.5 1710 721.5 L 1733.63 721.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1738.88 721.5 L 1731.88 725 L 1733.63 721.5 L 1731.88 718 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2101 721.5 L 2183.63 721.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2188.88 721.5 L 2181.88 725 L 2183.63 721.5 L 2181.88 718 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2359 721.5 L 2451.63 721.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2456.88 721.5 L 2449.88 725 L 2451.63 721.5 L 2449.88 718 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2749 721.5 L 2838.63 721.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2843.88 721.5 L 2836.88 725 L 2838.63 721.5 L 2836.88 718 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3005 721.5 L 3100.63 721.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3105.88 721.5 L 3098.88 725 L 3100.63 721.5 L 3098.88 718 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3348 721.5 L 3400.63 721.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3405.88 721.5 L 3398.88 725 L 3400.63 721.5 L 3398.88 718 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3612 721.5 L 3738.63 721.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3743.88 721.5 L 3736.88 725 L 3738.63 721.5 L 3736.88 718 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 723px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">3. 连接实例</div></div></div></foreignObject><text x="32" y="727" fill="#000000" font-family="source code pro" font-size="13px">3. 连接实例</text></switch></g><rect x="30" y="743" width="295" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 773px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewConn(netConn net.Conn)</div></div></div></foreignObject><text x="37" y="777" fill="#000000" font-family="source code pro" font-size="13px">func NewConn(netConn net.Conn)</text></switch></g><path d="M 724.09 790.03 L 977.04 790 Q 987.04 790 987.04 790.25 L 987.04 790.38 Q 987.04 790.5 997.04 790.5 L 1243.63 790.5" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1248.88 790.5 L 1241.88 794 L 1243.63 790.5 L 1241.88 787 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><rect x="420" y="707" width="305" height="132" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 298px; height: 1px; padding-top: 773px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">cn := &amp;Conn{<br />    netConn:   netConn,<br />}<br />cn.rd = proto.NewReader(netConn)<br />cn.bw = bufio.NewWriter(netConn)<br />cn.wr = proto.NewWriter(cn.bw)<br />return cn</div></div></div></foreignObject><text x="427" y="777" fill="#000000" font-family="source code pro" font-size="13px">cn := &amp;Conn{...</text></switch></g><rect x="220" y="867" width="140" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 133px; height: 1px; padding-top: 897px; margin-left: 227px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">WithWriter(...)</div></div></div></foreignObject><text x="227" y="901" fill="#000000" font-family="source code pro" font-size="13px">WithWriter(...)</text></switch></g><rect x="420" y="847" width="780" height="100" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 773px; height: 1px; padding-top: 897px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return internal.WithSpan(ctx, "with_writer", func(ctx context.Context, span trace.Span) error {<br />    fn(cn.wr)<br />    cn.bw.Flush()<br />    return nil<br />})</div></div></div></foreignObject><text x="427" y="901" fill="#000000" font-family="source code pro" font-size="13px">return internal.WithSpan(ctx, "with_writer", func(ctx context.Context, span trace.Span) error {...</text></switch></g><rect x="220" y="975" width="160" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 153px; height: 1px; padding-top: 1005px; margin-left: 227px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">WithReader(...)</div></div></div></foreignObject><text x="227" y="1009" fill="#000000" font-family="source code pro" font-size="13px">WithReader(...)</text></switch></g><rect x="420" y="957" width="790" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 783px; height: 1px; padding-top: 1005px; margin-left: 427px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return internal.WithSpan(ctx, "with_reader", func(ctx context.Context, span trace.Span) error {<br />    fn(cn.rd)<br />    return nil<br />})</div></div></div></foreignObject><text x="427" y="1009" fill="#000000" font-family="source code pro" font-size="13px">return internal.WithSpan(ctx, "with_reader", func(ctx context.Context, span trace.Span) error {...</text></switch></g><path d="M 325 773 L 413.63 773" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 418.88 773 L 411.88 776.5 L 413.63 773 L 411.88 769.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 360 897 L 413.63 897" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 418.88 897 L 411.88 900.5 L 413.63 897 L 411.88 893.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 380 1005 L 413.63 1005" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 418.88 1005 L 411.88 1008.5 L 413.63 1005 L 411.88 1001.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 1087px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">4. 请求处理</div></div></div></foreignObject><text x="32" y="1091" fill="#000000" font-family="source code pro" font-size="13px">4. 请求处理</text></switch></g><rect x="30" y="1107" width="360" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 353px; height: 1px; padding-top: 1137px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Process(ctx context.Context, cmd Cmder)</div></div></div></foreignObject><text x="37" y="1141" fill="#000000" font-family="source code pro" font-size="13px">Process(ctx context.Context, cmd Cmder)</text></switch></g><rect x="480" y="1107" width="470" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 463px; height: 1px; padding-top: 1137px; margin-left: 487px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return c.hooks.process(ctx, cmd, c.baseClient.process)</div></div></div></foreignObject><text x="487" y="1141" fill="#000000" font-family="source code pro" font-size="13px">return c.hooks.process(ctx, cmd, c.baseClient.process)</text></switch></g><rect x="1040" y="1107" width="277" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 270px; height: 1px; padding-top: 1137px; margin-left: 1047px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func (hs hooks) process(...)</div></div></div></foreignObject><text x="1047" y="1141" fill="#000000" font-family="source code pro" font-size="13px">func (hs hooks) process(...)</text></switch></g><rect x="1393" y="1083" width="356" height="108" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 349px; height: 1px; padding-top: 1137px; margin-left: 1400px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">err := hs.withContext(ctx, func() error {<br />    return fn(ctx, cmd)<br />})<br />cmd.SetErr(err)<br />return err</div></div></div></foreignObject><text x="1400" y="1141" fill="#000000" font-family="source code pro" font-size="13px">err := hs.withContext(ctx, func() error {...</text></switch></g><rect x="1831" y="1107" width="169" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 162px; height: 1px; padding-top: 1137px; margin-left: 1838px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">withContext(...)</div></div></div></foreignObject><text x="1838" y="1141" fill="#000000" font-family="source code pro" font-size="13px">withContext(...)</text></switch></g><rect x="2090" y="1107" width="124" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 117px; height: 1px; padding-top: 1137px; margin-left: 2097px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return fn()</div></div></div></foreignObject><text x="2097" y="1141" fill="#000000" font-family="source code pro" font-size="13px">return fn()</text></switch></g><rect x="1040" y="1246" width="565" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 558px; height: 1px; padding-top: 1276px; margin-left: 1047px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func (c *baseClient) process(ctx context.Context, cmd Cmder)</div></div></div></foreignObject><text x="1047" y="1280" fill="#000000" font-family="source code pro" font-size="13px">func (c *baseClient) process(ctx context.Context, cmd Cmder)</text></switch></g><rect x="1687" y="1204" width="673" height="144" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 666px; height: 1px; padding-top: 1276px; margin-left: 1694px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">err := c.withConn(ctx, func(ctx context.Context, cn *pool.Conn) error {<br />    err := cn.WithWriter(ctx, c.opt.WriteTimeout, func(wr *proto.Writer) error {<br />        return writeCmd(wr, cmd)<br />    })<br />    err = cn.WithReader(ctx, c.cmdTimeout(cmd), cmd.readReply)<br />    return nil<br />})<br />return err</div></div></div></foreignObject><text x="1694" y="1280" fill="#000000" font-family="source code pro" font-size="13px">err := c.withConn(ctx, func(ctx context.Context, cn *pool.Conn) error {...</text></switch></g><rect x="1040" y="1392" width="142" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 135px; height: 1px; padding-top: 1422px; margin-left: 1047px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">withConn(...)</div></div></div></foreignObject><text x="1047" y="1426" fill="#000000" font-family="source code pro" font-size="13px">withConn(...)</text></switch></g><rect x="1260" y="1387" width="278" height="70" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 271px; height: 1px; padding-top: 1422px; margin-left: 1267px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">cn, err := c.getConn(ctx)<br />err = fn(ctx, cn)<br />return err</div></div></div></foreignObject><text x="1267" y="1426" fill="#000000" font-family="source code pro" font-size="13px">cn, err := c.getConn(ctx)...</text></switch></g><rect x="1610" y="1392" width="277" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 270px; height: 1px; padding-top: 1422px; margin-left: 1617px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">getConn(ctx context.Context)</div></div></div></foreignObject><text x="1617" y="1426" fill="#000000" font-family="source code pro" font-size="13px">getConn(ctx context.Context)</text></switch></g><rect x="1964" y="1386" width="246" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 239px; height: 1px; padding-top: 1422px; margin-left: 1971px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">cn, err := c._getConn(ctx)<br />return cn, nil</div></div></div></foreignObject><text x="1971" y="1426" fill="#000000" font-family="source code pro" font-size="13px">cn, err := c._getConn(ctx)...</text></switch></g><rect x="2300" y="1386" width="270" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 263px; height: 1px; padding-top: 1422px; margin-left: 2307px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">cn, err := c.connPool.Get(ctx)<br />return cn, nil</div></div></div></foreignObject><text x="2307" y="1426" fill="#000000" font-family="source code pro" font-size="13px">cn, err := c.connPool.Get(ctx)...</text></switch></g><rect x="2670" y="1392" width="241" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 234px; height: 1px; padding-top: 1422px; margin-left: 2677px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Get(ctx context.Context)</div></div></div></foreignObject><text x="2677" y="1426" fill="#000000" font-family="source code pro" font-size="13px">Get(ctx context.Context)</text></switch></g><rect x="3006" y="1374" width="224" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 217px; height: 1px; padding-top: 1422px; margin-left: 3013px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for {<br />    cn := p.popIdle()<br />    return cn, nil<br />}</div></div></div></foreignObject><text x="3013" y="1426" fill="#000000" font-family="source code pro" font-size="13px">for {...</text></switch></g><path d="M 390 1137 L 473.63 1137" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 478.88 1137 L 471.88 1140.5 L 473.63 1137 L 471.88 1133.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 950 1137 L 1033.63 1137" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1038.88 1137 L 1031.88 1140.5 L 1033.63 1137 L 1031.88 1133.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1317 1137 L 1386.63 1137" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1391.88 1137 L 1384.88 1140.5 L 1386.63 1137 L 1384.88 1133.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1749 1137 L 1824.63 1137" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1829.88 1137 L 1822.88 1140.5 L 1824.63 1137 L 1822.88 1133.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2000 1137 L 2083.63 1137" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2088.88 1137 L 2081.88 1140.5 L 2083.63 1137 L 2081.88 1133.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 950 1137 L 990 1137 Q 1000 1137 1000 1147 L 1000 1266 Q 1000 1276 1010 1276 L 1033.63 1276" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1038.88 1276 L 1031.88 1279.5 L 1033.63 1276 L 1031.88 1272.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1605 1276 L 1680.63 1276" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1685.88 1276 L 1678.88 1279.5 L 1680.63 1276 L 1678.88 1272.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2360 1276 L 2370 1276 Q 2380 1276 2380 1286 L 2380 1360 Q 2380 1370 2370 1370 L 1121 1370 Q 1111 1370 1111 1377.82 L 1111 1385.63" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1111 1390.88 L 1107.5 1383.88 L 1111 1385.63 L 1114.5 1383.88 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1182 1422 L 1253.63 1422" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1258.88 1422 L 1251.88 1425.5 L 1253.63 1422 L 1251.88 1418.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1538 1422 L 1603.63 1422" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1608.88 1422 L 1601.88 1425.5 L 1603.63 1422 L 1601.88 1418.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1887 1422 L 1957.63 1422" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1962.88 1422 L 1955.88 1425.5 L 1957.63 1422 L 1955.88 1418.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2210 1422 L 2293.63 1422" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2298.88 1422 L 2291.88 1425.5 L 2293.63 1422 L 2291.88 1418.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2570 1422 L 2663.63 1422" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2668.88 1422 L 2661.88 1425.5 L 2663.63 1422 L 2661.88 1418.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2911 1422 L 2999.63 1422" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3004.88 1422 L 2997.88 1425.5 L 2999.63 1422 L 2997.88 1418.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><rect x="1280" y="263.5" width="295" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 288px; height: 1px; padding-top: 294px; margin-left: 1287px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func newConnPool(opt *Options)</div></div></div></foreignObject><text x="1287" y="297" fill="#000000" font-family="source code pro" font-size="13px">func newConnPool(opt *Options)</text></switch></g><path d="M 1200 293.5 L 1273.63 293.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1278.88 293.5 L 1271.88 297 L 1273.63 293.5 L 1271.88 290 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 45px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 18px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">Go-redis 连接</div></div></div></foreignObject><text x="32" y="50" fill="#000000" font-family="source code pro" font-size="18px">Go-redis 连接</text></switch></g><path d="M 1200 399 L 1210 399 Q 1220 399 1220 389 L 1220 303.5 Q 1220 293.5 1213.18 293.5 L 1206.37 293.5" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1201.12 293.5 L 1208.12 290 L 1206.37 293.5 L 1208.12 297 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 420 469 L 410 469 Q 400 469 400 479 L 400 577.3 Q 400 587.3 406.82 587.28 L 413.63 587.27" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 418.88 587.25 L 411.89 590.77 L 413.63 587.27 L 411.87 583.77 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>