<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2130px" height="1000px" viewBox="-0.5 -0.5 2130 1000" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-08-16T12:49:37.191Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/12.6.5 Chrome/80.0.3987.86 Electron/8.0.0 Safari/537.36&quot; etag=&quot;R5R6LLYSgQWegKIyE_oR&quot; version=&quot;12.6.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;wPSxUdoko976NVPvlNEn&quot; name=&quot;Page-1&quot;&gt;7Vxtc+I4Ev41riJbNS78ivkIhOxcbbKXmzA3u/dlS8ECvGMsRhYhzK8/tSXhF5nEkDjJHVSlZnC7ZbXUT7da3bINZ7R8/JWi1eKGhDg27G74aDiXhm3bXd/n/wFlKygWpwnKnEahpOWEu+gnlkTFto5CnJYYGSExi1Zl4pQkCZ6yEg1RSjZlthmJy72u0BxrhLspinXqtyhkC0EN7F5O/4yj+UL1bPl9cWeJFLMcSbpAIdkUSM7YcEaUECZ+LR9HOIbZU/Mi2l3tubsTjOKENWnQ/4GWX/8z+cePMf5z89u3+J/R7PaTfMoDitdywFJYtlUzgEM+IfKSULYgc5KgeJxTh5SskxBDNxa/ynmuCVlJ4t+Ysa3ULlozwkkLtozl3ZRR8h2PSExo1qdjXQ6v+j1+R0gDIuwdtSSlZE2nkusvb/K1H9+wu0X/X3/c2qPl5MtADZUhOsfsKT5/pxwOa0yWmNEtb0hxjFj0UBYESXjNd3yy6YBStC0wrEiUsLTw5FsgcIZHBRxP4kRaSs+tqPPABvyHkEFdFQaTkzKM1OPlqUks4GXDDX+Fw5v1o4acdBMtY5QARGYkYQpEXX49XURxeI22ZA2qSBmafldXwwWh0U/OjxQ8csIdMMpHUJxyPN0qJFgV0g16LDFeo5Spzkkco1Ua3WfiQMMlB0WUDAljZCmZQOIrtIximF4JLnAzIfy3okQNSmDacgDGKzSNkvk1nkFPHqegOJon/HeckTjOEVUtbH8vlB8wZfixQNLBqO7u/KQCQbdreoKyyd3VjmtRcFW9YD+ECyA6HCO2hpFP4A85QJwB//HLgrGVeYfpA64DDR8501xCQgSKojiukCozDFMXce89kGQGHqhGMZLyRU4HKJzwtrM489CLKAxxknk2hhi638FWWjEX1BvyPz6rI5hvjws+4tdWfs3/gJ2yEUn4WFCU6RhzEG4wAPEYfOmAedJGn0eRBI2C4nOIUXyvjhinFjELlIQxpgI1GWg+S8oZM++OGc9+Z8y4GmYsk18bY8/od43BFfwIBsYgGMxxtm5+5gjKGHyjPzKCS8Vg7YNTIUB5BjFLrnsRCcFSs1f3oF4IflKpnxp1NdDwKywbQXnRsAJLU6bl2zXK7LakTE9TZgrrA03BRnj8RylojjsCuNdFZhylDCefJ5PbzoWmvnI4ullEDN9x04W7EKyUNXuESVUXdX3Vp1PFb8PlfUriNcODnNyKGnf2V7TJXo1N+m2p0dfUeFYU3HXd5zVl2W+pqZ5ucBCbFq1stk6mHT6xfLMGWqN86oQ1ojAEw+wKn5ZgZg445ULYKckstcdnzYd9XDebQB8tQZvJfbrKrrs1JIGU/SafyXetmDqZEBcH9zLL5PtL9BEXe6AomeOyHEeNoxkppQ/Fzncc4l+wlyxApu1J0IwkpchCsIqQeRj/7lI2IwFKs5Ec2T7OcN65MO8yYwCHNnrfYfcu31uEOHnJjNY9sMURwXS1Zc3SEvItSldYNtySG5kOMqckmUVzc5xAjHiJ79fzw11YQ5FU/CTlgCRNEnZKYRWX7Yjuy7NYuqo47cxld3bP4FyOKx2HRpRLi5oh8ICDqounmK1pUhwctEmi+HQjC79BDOjVRRY8emwptAjqQ4vK0l0XP5yqEi0tku+7eiQf1GixtfiwrymxFDmBCuuCp51qjwgI0k3EpotsVoqBH3+i2WHbFb448rlTlIJovwDQJqPbPApow+3G5egVRgD9CvDrrpBN93nCx12U8WIX3XQhrywVQMmi5Iu9/n7nkBXvSftiy/fcshnXJMkcZdpFM7ZctyU7VsvBRyvwXY1dx/eOUzh+jNgf8sHw+0/+GzKo4upSlX2yi6282KveZ8uGMjX1bNlQ5j4qpcqDU3Cvj4APWuL930GA3xABvY+KAL0gd0bAQQjoNURA8FERoBfYzgg4CAFBQwT0PyoC9HKZDeUyWRRb5FmLsWcMXCNwjXEPCmmBryHl1Mpju+z9u5XHLL0+pnJKOE8lcYZ7QuIT3khXFdfTFWd7b7mNtvSKGJyDKexvsyz673ijzsN0irstoeSrdTK94eJE07TYUtRnEGNY5MQKFZrcnIvHJuA5x26ixSkvqvXPLXqluvnCf5Mkxd8oBxgVklD8w1BHfr7gH2ucsmNFaJhFqJaxWLTE5u9k02kr06osUUyFHHRbnS0FDswbjNI1xXdRMsWd73grE7ow+LfJF3AYS1zlGAQR5j+jlcTb/ryByCWV2s2SotJUPgknoTo4eRRm2CJKr0pPhn4OfMg9uM/XQn6HjwbTGXjf3lAVcEThtF3D2OVqxJx0UiXmy1B7BHQ0r1ZGUGqCs+nIWR8J0C9ImF40SERVapSFw6lHTKw6sthsxjP2I4pX5WNulSf0Lk93NXed55fzXrdmOXfsflvruX5uIgNrvuAqj1VCrqGKHWKRPuEITTuw7HfdmgPLzttGaXrJaudQ3jrKSTH7jFEIdbLcNacmgkOMxeKoEkMyH+65yf3feq3ilWIZaG4KyeC4BK4pAo84QvmQPk22K7ynBDIVLBNR+zlGhExHUg5QzojbyEse1blfz7RF6GRNuVru8PygxpTdvqebsuXYbdmyXrlEZnZeIDuEKI48nKrKKvvjwKk59+sFurq81l4V0ctTJV2BV80Pw52w5hy1Rj2hOtutWTTbU51eV5oTtWAeu/pVDxCpc1WABTNOKr73lI8U+14FEMrxFQHh1wAiaMvzqprCuchwbJHBalprtl5WbP7kthZK2+dK00tB0LTcbL2s3twmCPRi0xkEh4GgacXZelnJuU0Q6KWPMwgOA0G/IQhUFN0UBNxAe3YZB1Y3aCtnZus5szMQDgKC0u/zQLA+NBD0NJsjXtn1jaFjDILsjVzfCEYL9apuYAx72bu8PaPvGsPzq7r9mjCfq0wP81s7i2DrCRbY8kGzJGKnvCWrqsqtUZVdc/q3tSXY0bMrFM/hKDodyzKFnpjlPT3wcV59f4DO6zOzxWKG2OaXuX4dT/a1rJJvvzZmvRxfjydjnVsVUTvFVJH527/v1CBPGJNO130WlD0Vqr0NKPW8kfQfGjZN0zxh1Vm7N8Kf0F1tzq893ekpnvyEhjdUZXz4tIksKMFxi5NVoKsi3acUqOb0bRR4Ts+8NBZvuilzDtyUVXfmVt9v6zCwc87PvBAFTtMdmXPgjuwtUaAfKj6j4DAUNP2kpPLx74uC2g+A6iu6/gWt/68vZ2kLeI3ym2qm16/Z41k1IdlrbMdr9acv6PDxuDW0+7BqO8Cog3bUVvNCR93r9c7hWuOX+Sd9xVdX8y8jO+P/Ag==&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-1165-692-205-26-0"><rect x="1165" y="692" width="205" height="26"/></clipPath><clipPath id="mx-clip-1165-718-205-26-0"><rect x="1165" y="718" width="205" height="26"/></clipPath></defs><g><path d="M 1160 699.5 L 1110 699.5 Q 1100 699.5 1093.18 699.5 L 1086.37 699.5" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1081.12 699.5 L 1088.12 696 L 1086.37 699.5 L 1088.12 703 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="all"/><path d="M 1160 686.5 L 1160 660.5 L 1370 660.5 L 1370 686.5" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1160 686.5 L 1160 738.5 L 1370 738.5 L 1370 686.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1160 686.5 L 1370 686.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="1166.5" y="678.5">wrappedMux</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1165-692-205-26-0)" font-size="13px"><text x="1166.5" y="705">- mux: *http.ServeMux</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1165-718-205-26-0)" font-size="13px"><text x="1166.5" y="731">- handler: http.Handler</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 151px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">1. 启动Agent Http 服务</div></div></div></foreignObject><text x="32" y="155" fill="#000000" font-family="source code pro" font-size="13px">1. 启动Agent Http 服务</text></switch></g><rect x="30" y="170" width="270" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 263px; height: 1px; padding-top: 200px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">servers, err := a.listenHTTP()</div></div></div></foreignObject><text x="37" y="204" fill="#000000" font-family="source code pro" font-size="13px">servers, err := a.listenHTTP()</text></switch></g><rect x="390" y="170" width="120" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 113px; height: 1px; padding-top: 200px; margin-left: 397px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">listenHTTP()</div></div></div></foreignObject><text x="397" y="204" fill="#000000" font-family="source code pro" font-size="13px">listenHTTP()</text></switch></g><rect x="630" y="170" width="520" height="228" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 513px; height: 1px; padding-top: 284px; margin-left: 637px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">start := func(proto string, addrs []net.Addr) error {<br />    listeners, err := a.startListeners(addrs)<br />    for _, l := range listeners {<br />        srv := &amp;HTTPServer{<br />            Server: &amp;http.Server{<br />                Addr:      l.Addr().String(),<br />            },<br />            ln:        l,<br />        }<br />        srv.Server.Handler = srv.handler(a.config.EnableDebug)<br />        servers = append(servers, srv)<br />    }<br />}<br />err := start("http", a.config.HTTPAddrs)<br />return servers, nil</div></div></div></foreignObject><text x="637" y="288" fill="#000000" font-family="source code pro" font-size="13px">start := func(proto string, addrs []net.Addr) error {...</text></switch></g><rect x="1230" y="254" width="280" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 273px; height: 1px; padding-top: 284px; margin-left: 1237px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">startListeners(addrs []net.Addr)</div></div></div></foreignObject><text x="1237" y="288" fill="#000000" font-family="source code pro" font-size="13px">startListeners(addrs []net.Addr)</text></switch></g><rect x="1604" y="212" width="394" height="144" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 387px; height: 1px; padding-top: 284px; margin-left: 1611px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for _, addr := range addrs {<br />    switch x := addr.(type) {<br />    case *net.TCPAddr:<br />        l, err = net.Listen("tcp", x.String())<br />    }<br />    ln = append(ln, l)<br />}<br />return ln, nil</div></div></div></foreignObject><text x="1611" y="288" fill="#000000" font-family="source code pro" font-size="13px">for _, addr := range addrs {...</text></switch></g><path d="M 300 200 L 383.63 200" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 388.88 200 L 381.88 203.5 L 383.63 200 L 381.88 196.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 510 200 L 560 200 Q 570 200 570 210 L 570 274 Q 570 284 580 284 L 623.63 284" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 628.88 284 L 621.88 287.5 L 623.63 284 L 621.88 280.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1150 284 L 1223.63 284" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1228.88 284 L 1221.88 287.5 L 1223.63 284 L 1221.88 280.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1510 284 L 1597.63 284" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1602.88 284 L 1595.88 287.5 L 1597.63 284 L 1595.88 280.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 410px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">2. Http handler 处理</div></div></div></foreignObject><text x="32" y="414" fill="#000000" font-family="source code pro" font-size="13px">2. Http handler 处理</text></switch></g><rect x="30" y="430" width="250" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 243px; height: 1px; padding-top: 460px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">handler(enableDebug bool)</div></div></div></foreignObject><text x="37" y="464" fill="#000000" font-family="source code pro" font-size="13px">handler(enableDebug bool)</text></switch></g><rect x="380" y="430" width="700" height="329" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 693px; height: 1px; padding-top: 595px; margin-left: 387px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">mux := http.NewServeMux()<br />handleFuncMetrics := func(pattern string, handler http.HandlerFunc) {<br />    wrapper := func(resp http.ResponseWriter, req *http.Request) {<br />        start := time.Now()<br />        handler(resp, req)<br />        metrics.MeasureSince(key, start)<br />    }<br />    mux.Handle(pattern, gzipHandler)<br />}<br />for pattern, fn := range endpoints {<br />    thisFn := fn<br />    bound := func(resp http.ResponseWriter, req *http.Request) (interface{}, error) {<br />        return thisFn(s, resp, req)<br />    }<br />    handleFuncMetrics(pattern, s.wrap(bound, methods))<br />}<br />return &amp;wrappedMux{<br />    mux:     mux,<br />    handler: h,<br />}</div></div></div></foreignObject><text x="387" y="598" fill="#000000" font-family="source code pro" font-size="13px">mux := http.NewServeMux()...</text></switch></g><rect x="1160" y="564.5" width="350" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 343px; height: 1px; padding-top: 595px; margin-left: 1167px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">wrap(handler endpoint, methods []string)</div></div></div></foreignObject><text x="1167" y="598" fill="#000000" font-family="source code pro" font-size="13px">wrap(handler endpoint, methods []string)</text></switch></g><rect x="1604" y="528.5" width="495" height="132" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 488px; height: 1px; padding-top: 595px; margin-left: 1611px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return func(resp http.ResponseWriter, req *http.Request) {<br />    setHeaders(resp, s.agent.config.HTTPResponseHeaders)<br />    obj, err = handler(resp, req)<br />    resp.Header().Set("Content-Type", contentType)<br />    resp.WriteHeader(httpCode)<br />    resp.Write(buf)<br />}</div></div></div></foreignObject><text x="1611" y="598" fill="#000000" font-family="source code pro" font-size="13px">return func(resp http.ResponseWriter, req *http.Request) {...</text></switch></g><rect x="30" y="791" width="158" height="58" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 151px; height: 1px; padding-top: 820px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.serveHTTP(srv)</div></div></div></foreignObject><text x="37" y="824" fill="#000000" font-family="source code pro" font-size="13px">a.serveHTTP(srv)</text></switch></g><rect x="268" y="791" width="240" height="58" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 233px; height: 1px; padding-top: 820px; margin-left: 275px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">serveHTTP(srv *HTTPServer)</div></div></div></foreignObject><text x="275" y="824" fill="#000000" font-family="source code pro" font-size="13px">serveHTTP(srv *HTTPServer)</text></switch></g><rect x="608" y="779" width="260" height="82" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 253px; height: 1px; padding-top: 820px; margin-left: 615px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">go func() {<br />    err := srv.Serve(srv.ln)<br />}()</div></div></div></foreignObject><text x="615" y="824" fill="#000000" font-family="source code pro" font-size="13px">go func() {...</text></switch></g><path d="M 280 460 L 320 460 Q 330 460 330 470 L 330 584.5 Q 330 594.5 340 594.5 L 373.63 594.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 378.88 594.5 L 371.88 598 L 373.63 594.5 L 371.88 591 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1080 594.5 L 1153.63 594.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1158.88 594.5 L 1151.88 598 L 1153.63 594.5 L 1151.88 591 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1510 594.5 L 1597.63 594.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1602.88 594.5 L 1595.88 598 L 1597.63 594.5 L 1595.88 591 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 188 820 L 261.63 820" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 266.88 820 L 259.88 823.5 L 261.63 820 L 259.88 816.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 508 820 L 601.63 820" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 606.88 820 L 599.88 823.5 L 601.63 820 L 599.88 816.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 889px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">3. 注册http 路由</div></div></div></foreignObject><text x="32" y="893" fill="#000000" font-family="source code pro" font-size="13px">3. 注册http 路由</text></switch></g><rect x="30" y="909" width="124" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 117px; height: 1px; padding-top: 939px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func init()</div></div></div></foreignObject><text x="37" y="943" fill="#000000" font-family="source code pro" font-size="13px">func init()</text></switch></g><rect x="254" y="909" width="726" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 719px; height: 1px; padding-top: 939px; margin-left: 261px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">registerEndpoint("/v1/kv/", []string{"GET", "PUT", "DELETE"}, (*HTTPServer).KVSEndpoint)</div></div></div></foreignObject><text x="261" y="943" fill="#000000" font-family="source code pro" font-size="13px">registerEndpoint("/v1/kv/", []string{"GET", "PUT", "DELETE"}, (*HTTPServer).KVSEndpoint)</text></switch></g><rect x="1070" y="909" width="240" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 233px; height: 1px; padding-top: 939px; margin-left: 1077px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func registerEndpoint(...)</div></div></div></foreignObject><text x="1077" y="943" fill="#000000" font-family="source code pro" font-size="13px">func registerEndpoint(...)</text></switch></g><rect x="1372" y="909" width="232" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 225px; height: 1px; padding-top: 939px; margin-left: 1379px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">endpoints[pattern] = fn</div></div></div></foreignObject><text x="1379" y="943" fill="#000000" font-family="source code pro" font-size="13px">endpoints[pattern] = fn</text></switch></g><path d="M 154 939 L 247.63 939" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 252.88 939 L 245.88 942.5 L 247.63 939 L 245.88 935.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 980 939 L 1063.63 939" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1068.88 939 L 1061.88 942.5 L 1063.63 939 L 1061.88 935.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1310 939 L 1365.63 939" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1370.88 939 L 1363.88 942.5 L 1365.63 939 L 1363.88 935.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 769px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">启动Http 服务</div></div></div></foreignObject><text x="32" y="773" fill="#000000" font-family="source code pro" font-size="13px">启动Http 服务</text></switch></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 45px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 18px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">Consul Http 服务</div></div></div></foreignObject><text x="32" y="50" fill="#000000" font-family="source code pro" font-size="18px">Consul Http 服务</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>