<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="2986px" height="1049px" viewBox="-0.5 -0.5 2986 1049" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-08-19T01:15:42.451Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/12.6.5 Chrome/80.0.3987.86 Electron/8.0.0 Safari/537.36&quot; etag=&quot;2k68xXTEXMx_tG1q60xh&quot; version=&quot;12.6.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;nYPvKJG8ubfEN6YmPxC7&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-1115-598-185-26-0"><rect x="1115" y="598" width="185" height="26"/></clipPath><clipPath id="mx-clip-1115-624-185-26-0"><rect x="1115" y="624" width="185" height="26"/></clipPath><clipPath id="mx-clip-1115-650-185-26-0"><rect x="1115" y="650" width="185" height="26"/></clipPath><clipPath id="mx-clip-2205-476-335-26-0"><rect x="2205" y="476" width="335" height="26"/></clipPath><clipPath id="mx-clip-2205-502-335-26-0"><rect x="2205" y="502" width="335" height="26"/></clipPath><clipPath id="mx-clip-1515-221-286-26-0"><rect x="1515" y="221" width="286" height="26"/></clipPath><clipPath id="mx-clip-1515-247-286-26-0"><rect x="1515" y="247" width="286" height="26"/></clipPath></defs><g><path d="M 1110 593 L 1110 567 L 1300 567 L 1300 593" fill="#1dbf97" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1110 593 L 1110 671 L 1300 671 L 1300 593" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1110 593 L 1300 593" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="1116.5" y="585">Raft</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1115-598-185-26-0)" font-size="13px"><text x="1116.5" y="611.5">- fsm: FSM</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1115-624-185-26-0)" font-size="13px"><text x="1116.5" y="637.5">- stable: StableStore</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1115-650-185-26-0)" font-size="13px"><text x="1116.5" y="663.5">- trans: Transport</text></g><path d="M 2200 470.5 L 2200 444.5 L 2540 444.5 L 2540 470.5" fill="#1dbf97" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 2200 470.5 L 2200 522.5 L 2540 522.5 L 2540 470.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 2200 470.5 L 2540 470.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="2206.5" y="462.5">FSM</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2205-476-335-26-0)" font-size="13px"><text x="2206.5" y="489">- apply: map[structs.MessageType]command</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2205-502-335-26-0)" font-size="13px"><text x="2206.5" y="515">- state: *state.Store</text></g><path d="M 1510 215.5 L 1510 189.5 L 1801 189.5 L 1801 215.5" fill="#1dbf97" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1510 215.5 L 1510 267.5 L 1801 267.5 L 1801 215.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1510 215.5 L 1801 215.5" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="1516.5" y="207.5">ChunkingFSM</text></g><rect x="1510" y="215.5" width="291" height="26" fill="#ffffff" stroke="none" pointer-events="none"/><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1515-221-286-26-0)" font-size="13px"><text x="1516.5" y="234">- underlying: raft.FSM</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1515-247-286-26-0)" font-size="13px"><text x="1516.5" y="260">- store: ChunkStorage</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 197px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">1. 创建Raft 服务</div></div></div></foreignObject><text x="32" y="201" fill="#000000" font-family="source code pro" font-size="13px">1. 创建Raft 服务</text></switch></g><rect x="30" y="220" width="124" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 117px; height: 1px; padding-top: 250px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">setupRaft()</div></div></div></foreignObject><text x="37" y="254" fill="#000000" font-family="source code pro" font-size="13px">setupRaft()</text></switch></g><rect x="240" y="220" width="410" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 403px; height: 1px; padding-top: 250px; margin-left: 247px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">s.fsm, err = fsm.New(s.tombstoneGC, s.logger)</div></div></div></foreignObject><text x="247" y="254" fill="#000000" font-family="source code pro" font-size="13px">s.fsm, err = fsm.New(s.tombstoneGC, s.logger)</text></switch></g><rect x="240" y="290" width="470" height="132" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 463px; height: 1px; padding-top: 356px; margin-left: 247px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">trans := raft.NewNetworkTransportWithConfig(transConfig)<br />s.raftTransport = trans<br />store := raft.NewInmemStore()<br />s.raftInmem = store<br />stable = store<br />log = store<br />snap = raft.NewInmemSnapshotStore()</div></div></div></foreignObject><text x="247" y="360" fill="#000000" font-family="source code pro" font-size="13px">trans := raft.NewNetworkTransportWithConfig(transConfig)...</text></switch></g><rect x="241" y="432" width="677" height="156" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 670px; height: 1px; padding-top: 510px; margin-left: 248px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">configuration := raft.Configuration{<br />    Servers: []raft.Server{<br />        {<br />            ID:      s.config.RaftConfig.LocalID,<br />            Address: trans.LocalAddr(),<br />        },<br />    },<br />}<br />raft.BootstrapCluster(s.config.RaftConfig, log, stable, snap, trans, configuration)</div></div></div></foreignObject><text x="248" y="514" fill="#000000" font-family="source code pro" font-size="13px">configuration := raft.Configuration{...</text></switch></g><rect x="240" y="599" width="760" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 753px; height: 1px; padding-top: 635px; margin-left: 247px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">s.raft, err = raft.NewRaft(s.config.RaftConfig, s.fsm.ChunkingFSM(), log, stable, snap, trans)<br />return nil</div></div></div></foreignObject><text x="247" y="639" fill="#000000" font-family="source code pro" font-size="13px">s.raft, err = raft.NewRaft(s.config.RaftConfig, s.fsm.ChunkingFSM(), log, stable, snap, trans)...</text></switch></g><rect x="740" y="220" width="142" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 135px; height: 1px; padding-top: 250px; margin-left: 747px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func New(...)</div></div></div></foreignObject><text x="747" y="254" fill="#000000" font-family="source code pro" font-size="13px">func New(...)</text></switch></g><rect x="982" y="189.5" width="427" height="120" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 420px; height: 1px; padding-top: 250px; margin-left: 989px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">stateNew, err := state.NewStateStore(gc)<br />fsm := &amp;FSM{<br />    apply:  make(map[structs.MessageType]command),<br />    state:  stateNew,<br />    gc:     gc,<br />}</div></div></div></foreignObject><text x="989" y="253" fill="#000000" font-family="source code pro" font-size="13px">stateNew, err := state.NewStateStore(gc)...</text></switch></g><rect x="982" y="319.5" width="547" height="120" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 540px; height: 1px; padding-top: 380px; margin-left: 989px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for msg, fn := range commands {<br />    thisFn := fn<br />    fsm.apply[msg] = func(buf []byte, index uint64) interface{} {<br />        return thisFn(fsm, buf, index)<br />    }<br />}</div></div></div></foreignObject><text x="989" y="383" fill="#000000" font-family="source code pro" font-size="13px">for msg, fn := range commands {...</text></switch></g><rect x="982" y="450.5" width="484" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 477px; height: 1px; padding-top: 487px; margin-left: 989px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">fsm.chunker = raftchunking.NewChunkingFSM(fsm, nil)<br />return fsm, nil</div></div></div></foreignObject><text x="989" y="490" fill="#000000" font-family="source code pro" font-size="13px">fsm.chunker = raftchunking.NewChunkingFSM(fsm, nil)...</text></switch></g><rect x="1670" y="650" width="250" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 243px; height: 1px; padding-top: 680px; margin-left: 1677px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func registerCommand(...)</div></div></div></foreignObject><text x="1677" y="684" fill="#000000" font-family="source code pro" font-size="13px">func registerCommand(...)</text></switch></g><path d="M 2553 680 L 2563 680 Q 2573 680 2573 670 L 2573 359.5 Q 2573 349.5 2563 349.5 L 1535.37 349.5" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1530.12 349.5 L 1537.12 346 L 1535.37 349.5 L 1537.12 353 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><rect x="1993" y="644" width="560" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 553px; height: 1px; padding-top: 680px; margin-left: 2000px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">registerCommand(structs.KVSRequestType, (*FSM).applyKVSOperation)<br />commands[msg] = fn</div></div></div></foreignObject><text x="2000" y="684" fill="#000000" font-family="source code pro" font-size="13px">registerCommand(structs.KVSRequestType, (*FSM).applyKVSOperation)...</text></switch></g><rect x="1550" y="456.5" width="241" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 234px; height: 1px; padding-top: 487px; margin-left: 1557px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewChunkingFSM(...)</div></div></div></foreignObject><text x="1557" y="490" fill="#000000" font-family="source code pro" font-size="13px">func NewChunkingFSM(...)</text></switch></g><rect x="1873" y="432.5" width="262" height="108" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 255px; height: 1px; padding-top: 487px; margin-left: 1880px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">ret := &amp;ChunkingFSM{<br />    underlying: underlying,<br />    store:      store,<br />}<br />return ret</div></div></div></foreignObject><text x="1880" y="490" fill="#000000" font-family="source code pro" font-size="13px">ret := &amp;ChunkingFSM{...</text></switch></g><path d="M 154 250 L 233.63 250" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 250 L 231.88 253.5 L 233.63 250 L 231.88 246.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 154 250 L 190 250 Q 200 250 200 260 L 200 346 Q 200 356 210 356 L 233.63 356" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 356 L 231.88 359.5 L 233.63 356 L 231.88 352.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 154 250 L 190 250 Q 200 250 200 260 L 200 500 Q 200 510 210 510 L 234.63 510" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 239.88 510 L 232.88 513.5 L 234.63 510 L 232.88 506.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 154 250 L 190 250 Q 200 250 200 260 L 200 625 Q 200 635 210 635 L 233.63 635" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 238.88 635 L 231.88 638.5 L 233.63 635 L 231.88 631.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 650 250 L 733.63 250" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 738.88 250 L 731.88 253.5 L 733.63 250 L 731.88 246.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 882 250 L 922 250 Q 932 250 942 249.89 L 975.63 249.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 980.88 249.5 L 973.88 253 L 975.63 249.5 L 973.88 246 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 882 250 L 940 250 Q 950 250 950 260 L 950 370 Q 950 380 960 380 L 975.63 380" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 980.88 380 L 973.88 383.5 L 975.63 380 L 973.88 376.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 882 250 L 940 250 Q 950 250 950 260 L 950 477 Q 950 487 960 487 L 975.63 487" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 980.88 487 L 973.88 490.5 L 975.63 487 L 973.88 483.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1920 680 L 1986.63 680" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1991.88 680 L 1984.88 683.5 L 1986.63 680 L 1984.88 676.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1466 486.5 L 1543.63 486.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1548.88 486.5 L 1541.88 490 L 1543.63 486.5 L 1541.88 483 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1791 486.5 L 1866.63 486.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1871.88 486.5 L 1864.88 490 L 1866.63 486.5 L 1864.88 483 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 747px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">2. 提交Raft 数据</div></div></div></foreignObject><text x="32" y="751" fill="#000000" font-family="source code pro" font-size="13px">2. 提交Raft 数据</text></switch></g><rect x="30" y="767" width="350" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 343px; height: 1px; padding-top: 797px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Apply(cmd []byte, timeout time.Duration)</div></div></div></foreignObject><text x="37" y="801" fill="#000000" font-family="source code pro" font-size="13px">Apply(cmd []byte, timeout time.Duration)</text></switch></g><rect x="450" y="767" width="360" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 353px; height: 1px; padding-top: 797px; margin-left: 457px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return r.ApplyLog(Log{Data: cmd}, timeout)</div></div></div></foreignObject><text x="457" y="801" fill="#000000" font-family="source code pro" font-size="13px">return r.ApplyLog(Log{Data: cmd}, timeout)</text></switch></g><rect x="882" y="700" width="332" height="192" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 325px; height: 1px; padding-top: 796px; margin-left: 889px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">logFuture := &amp;logFuture{<br />    log: Log{<br />        Type:       LogCommand,<br />        Data:       log.Data,<br />        Extensions: log.Extensions,<br />    },<br />}<br />logFuture.init()<br />select {<br />case r.applyCh &lt;- logFuture:<br />    return logFuture<br />}</div></div></div></foreignObject><text x="889" y="800" fill="#000000" font-family="source code pro" font-size="13px">logFuture := &amp;logFuture{...</text></switch></g><path d="M 380 797 L 443.63 797" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 448.88 797 L 441.88 800.5 L 443.63 797 L 441.88 793.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 810 797 L 836 797 Q 846 797 846 796.5 L 846 796.25 Q 846 796 856 796 L 875.63 796" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 880.88 796 L 873.88 799.5 L 875.63 796 L 873.88 792.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 920px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">3. 接收Raft 同步数据</div></div></div></foreignObject><text x="32" y="924" fill="#000000" font-family="source code pro" font-size="13px">3. 接收Raft 同步数据</text></switch></g><rect x="30" y="940" width="250" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 243px; height: 1px; padding-top: 970px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">resp = r.fsm.Apply(req.log)</div></div></div></foreignObject><text x="37" y="974" fill="#000000" font-family="source code pro" font-size="13px">resp = r.fsm.Apply(req.log)</text></switch></g><rect x="370" y="940" width="187" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 180px; height: 1px; padding-top: 970px; margin-left: 377px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Apply(l *raft.Log)</div></div></div></foreignObject><text x="377" y="974" fill="#000000" font-family="source code pro" font-size="13px">Apply(l *raft.Log)</text></switch></g><rect x="650" y="928" width="450" height="84" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 443px; height: 1px; padding-top: 970px; margin-left: 657px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">if l.Type != raft.LogCommand || l.Extensions == nil {<br />    return c.underlying.Apply(l)<br />}</div></div></div></foreignObject><text x="657" y="974" fill="#000000" font-family="source code pro" font-size="13px">if l.Type != raft.LogCommand || l.Extensions == nil {...</text></switch></g><rect x="1170" y="940" width="205" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 198px; height: 1px; padding-top: 970px; margin-left: 1177px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Apply(log *raft.Log)</div></div></div></foreignObject><text x="1177" y="974" fill="#000000" font-family="source code pro" font-size="13px">Apply(log *raft.Log)</text></switch></g><rect x="1460" y="922" width="338" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 331px; height: 1px; padding-top: 970px; margin-left: 1467px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">msgType := structs.MessageType(buf[0])<br />if fn := c.apply[msgType]; fn != nil {<br />    return fn(buf[1:], log.Index)<br />}</div></div></div></foreignObject><text x="1467" y="974" fill="#000000" font-family="source code pro" font-size="13px">msgType := structs.MessageType(buf[0])...</text></switch></g><rect x="1670" y="753" width="223" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 216px; height: 1px; padding-top: 783px; margin-left: 1677px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">applyKVSOperation(...)</div></div></div></foreignObject><text x="1677" y="787" fill="#000000" font-family="source code pro" font-size="13px">applyKVSOperation(...)</text></switch></g><rect x="1962" y="729" width="393" height="108" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 386px; height: 1px; padding-top: 783px; margin-left: 1969px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">err := structs.Decode(buf, &amp;req)<br />switch req.Op {<br />case api.KVSet:<br />    return c.state.KVSSet(index, &amp;req.DirEnt)<br />}</div></div></div></foreignObject><text x="1969" y="787" fill="#000000" font-family="source code pro" font-size="13px">err := structs.Decode(buf, &amp;req)...</text></switch></g><rect x="2435" y="753" width="124" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 117px; height: 1px; padding-top: 783px; margin-left: 2442px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">KVSSet(...)</div></div></div></foreignObject><text x="2442" y="787" fill="#000000" font-family="source code pro" font-size="13px">KVSSet(...)</text></switch></g><rect x="2645" y="741" width="310" height="84" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 303px; height: 1px; padding-top: 783px; margin-left: 2652px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">tx := s.db.WriteTxn(idx)<br />s.kvsSetTxn(tx, idx, entry, false)<br />return tx.Commit()</div></div></div></foreignObject><text x="2652" y="787" fill="#000000" font-family="source code pro" font-size="13px">tx := s.db.WriteTxn(idx)...</text></switch></g><path d="M 280 970 L 363.63 970" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 368.88 970 L 361.88 973.5 L 363.63 970 L 361.88 966.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 557 970 L 643.63 970" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 648.88 970 L 641.88 973.5 L 643.63 970 L 641.88 966.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1100 970 L 1163.63 970" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1168.88 970 L 1161.88 973.5 L 1163.63 970 L 1161.88 966.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1375 970 L 1453.63 970" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1458.88 970 L 1451.88 973.5 L 1453.63 970 L 1451.88 966.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1629 922 L 1629 793 Q 1629 783 1639 783 L 1663.63 783" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1668.88 783 L 1661.88 786.5 L 1663.63 783 L 1661.88 779.5 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1893 783 L 1955.63 783" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1960.88 783 L 1953.88 786.5 L 1955.63 783 L 1953.88 779.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2355 783 L 2428.63 783" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2433.88 783 L 2426.88 786.5 L 2428.63 783 L 2426.88 779.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2559 783 L 2638.63 783" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2643.88 783 L 2636.88 786.5 L 2638.63 783 L 2636.88 779.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1110 606 L 1065 606 Q 1055 606 1055 616 L 1055 625.5 Q 1055 635 1045 635 L 1006.37 635" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1001.12 635 L 1008.12 631.5 L 1006.37 635 L 1008.12 638.5 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 2200 483.5 L 2177.5 483.5 Q 2167.5 483.5 2167.5 473.5 L 2167.5 466.5 Q 2167.5 459.5 2157.5 459.5 L 2141.37 459.5" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 2136.12 459.5 L 2143.12 456 L 2141.37 459.5 L 2143.12 463 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1510 228.5 L 1469.5 228.5 Q 1459.5 228.5 1459.5 238.5 L 1459.5 244 Q 1459.5 249.5 1449.5 249.5 L 1415.37 249.5" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1410.12 249.5 L 1417.12 246 L 1415.37 249.5 L 1417.12 253 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 45px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 18px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">Consul Raft 实现</div></div></div></foreignObject><text x="32" y="50" fill="#000000" font-family="source code pro" font-size="18px">Consul Raft 实现</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>