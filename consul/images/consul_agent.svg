<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="1611px" height="1463px" viewBox="-0.5 -0.5 1611 1463" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-08-18T01:24:34.252Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/12.6.5 Chrome/80.0.3987.86 Electron/8.0.0 Safari/537.36&quot; etag=&quot;QAZmuHbGVi1L3B_lhzal&quot; version=&quot;12.6.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;KZ7Uo_q30SjbBU23nvTk&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-1215-383-285-26-0"><rect x="1215" y="383" width="285" height="26"/></clipPath><clipPath id="mx-clip-1215-409-285-26-0"><rect x="1215" y="409" width="285" height="26"/></clipPath><clipPath id="mx-clip-1215-435-285-26-0"><rect x="1215" y="435" width="285" height="26"/></clipPath><clipPath id="mx-clip-1215-461-285-26-0"><rect x="1215" y="461" width="285" height="26"/></clipPath><clipPath id="mx-clip-1215-487-285-26-0"><rect x="1215" y="487" width="285" height="26"/></clipPath></defs><g><path d="M 1210 378 L 1210 352 L 1500 352 L 1500 378" fill="#1dbf97" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 1210 378 L 1210 508 L 1500 508 L 1500 378" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1210 378 L 1500 378" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="1216.5" y="370">Agent</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1215-383-285-26-0)" font-size="13px"><text x="1216.5" y="396.5">- delegate: delegate</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1215-409-285-26-0)" font-size="13px"><text x="1216.5" y="422.5">- State: *local.State</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1215-435-285-26-0)" font-size="13px"><text x="1216.5" y="448.5">- cache: *cache.Cache</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1215-461-285-26-0)" font-size="13px"><text x="1216.5" y="474.5">- httpServers: []*HTTPServer</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1215-487-285-26-0)" font-size="13px"><text x="1216.5" y="500.5">- serviceManager: *ServiceManager</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 169px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">1. 运行Agent</div></div></div></foreignObject><text x="32" y="173" fill="#000000" font-family="source code pro" font-size="13px">1. 运行Agent</text></switch></g><rect x="30" y="190" width="187" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 180px; height: 1px; padding-top: 220px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Run(args []string)</div></div></div></foreignObject><text x="37" y="224" fill="#000000" font-family="source code pro" font-size="13px">Run(args []string)</text></switch></g><rect x="310" y="190" width="196" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 189px; height: 1px; padding-top: 220px; margin-left: 317px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">code := c.run(args)</div></div></div></foreignObject><text x="317" y="224" fill="#000000" font-family="source code pro" font-size="13px">code := c.run(args)</text></switch></g><rect x="580" y="190" width="170" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 163px; height: 1px; padding-top: 220px; margin-left: 587px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">run(args []string)</div></div></div></foreignObject><text x="587" y="224" fill="#000000" font-family="source code pro" font-size="13px">run(args []string)</text></switch></g><rect x="860" y="190" width="360" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 353px; height: 1px; padding-top: 220px; margin-left: 867px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">agent, err := agent.New(config, c.logger)</div></div></div></foreignObject><text x="867" y="224" fill="#000000" font-family="source code pro" font-size="13px">agent, err := agent.New(config, c.logger)</text></switch></g><rect x="860" y="260" width="180" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 173px; height: 1px; padding-top: 290px; margin-left: 867px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">err = agent.Start()</div></div></div></foreignObject><text x="867" y="294" fill="#000000" font-family="source code pro" font-size="13px">err = agent.Start()</text></switch></g><rect x="860" y="330" width="250" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 243px; height: 1px; padding-top: 360px; margin-left: 867px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">c.startupJoin(agent, config)</div></div></div></foreignObject><text x="867" y="364" fill="#000000" font-family="source code pro" font-size="13px">c.startupJoin(agent, config)</text></switch></g><rect x="860" y="400" width="178" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 171px; height: 1px; padding-top: 430px; margin-left: 867px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">agent.StartSync()</div></div></div></foreignObject><text x="867" y="434" fill="#000000" font-family="source code pro" font-size="13px">agent.StartSync()</text></switch></g><path d="M 217 220 L 303.63 220" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 308.88 220 L 301.88 223.5 L 303.63 220 L 301.88 216.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 506 220 L 573.63 220" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 578.88 220 L 571.88 223.5 L 573.63 220 L 571.88 216.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 220 L 853.63 220" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 858.88 220 L 851.88 223.5 L 853.63 220 L 851.88 216.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 220 L 780 220 Q 790 220 790 230 L 790 280 Q 790 290 800 290 L 853.63 290" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 858.88 290 L 851.88 293.5 L 853.63 290 L 851.88 286.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 220 L 780 220 Q 790 220 790 230 L 790 350 Q 790 360 800 360 L 853.63 360" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 858.88 360 L 851.88 363.5 L 853.63 360 L 851.88 356.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 750 220 L 780 220 Q 790 220 790 230 L 790 420 Q 790 430 800 430 L 853.63 430" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 858.88 430 L 851.88 433.5 L 853.63 430 L 851.88 426.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 312px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">2. 创建 Agent</div></div></div></foreignObject><text x="32" y="315" fill="#000000" font-family="source code pro" font-size="13px">2. 创建 Agent</text></switch></g><rect x="30" y="334.5" width="142" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 135px; height: 1px; padding-top: 365px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func New(...)</div></div></div></foreignObject><text x="37" y="368" fill="#000000" font-family="source code pro" font-size="13px">func New(...)</text></switch></g><rect x="272" y="310.5" width="418" height="108" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 411px; height: 1px; padding-top: 365px; margin-left: 279px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a := Agent{<br />    config:           c,<br />    joinLANNotifier:  &amp;systemd.Notifier{},<br />    endpoints:        make(map[string]string),<br />}</div></div></div></foreignObject><text x="279" y="368" fill="#000000" font-family="source code pro" font-size="13px">a := Agent{...</text></switch></g><rect x="272" y="430" width="370" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 363px; height: 1px; padding-top: 460px; margin-left: 279px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.serviceManager = NewServiceManager(&amp;a)</div></div></div></foreignObject><text x="279" y="464" fill="#000000" font-family="source code pro" font-size="13px">a.serviceManager = NewServiceManager(&amp;a)</text></switch></g><rect x="272" y="500" width="187" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 180px; height: 1px; padding-top: 536px; margin-left: 279px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.setupNodeID(c)<br />return &amp;a, nil</div></div></div></foreignObject><text x="279" y="540" fill="#000000" font-family="source code pro" font-size="13px">a.setupNodeID(c)...</text></switch></g><path d="M 172 364.5 L 265.63 364.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 270.88 364.5 L 263.88 368 L 265.63 364.5 L 263.88 361 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 172 364.5 L 210 364.5 Q 220 364.5 220 374.5 L 220 450 Q 220 460 230 460 L 265.63 460" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 270.88 460 L 263.88 463.5 L 265.63 460 L 263.88 456.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 172 364.5 L 210 364.5 Q 220 364.5 220 374.5 L 220 526 Q 220 536 230 536 L 265.63 536" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 270.88 536 L 263.88 539.5 L 265.63 536 L 263.88 532.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 630px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">3. 运行 Agent</div></div></div></foreignObject><text x="32" y="634" fill="#000000" font-family="source code pro" font-size="13px">3. 运行 Agent</text></switch></g><rect x="32" y="647" width="88" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 81px; height: 1px; padding-top: 677px; margin-left: 39px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">Start()</div></div></div></foreignObject><text x="39" y="681" fill="#000000" font-family="source code pro" font-size="13px">Start()</text></switch></g><rect x="218" y="629" width="602" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 595px; height: 1px; padding-top: 677px; margin-left: 225px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.State = local.NewState(LocalConfig(c), a.logger, a.tokens)<br />a.sync = ae.NewStateSyncer(a.State, c.AEInterval, a.shutdownCh, a.logger)<br />a.cache = cache.New(nil)<br />consulCfg, err := a.consulConfig()</div></div></div></foreignObject><text x="225" y="681" fill="#000000" font-family="source code pro" font-size="13px">a.State = local.NewState(LocalConfig(c), a.logger, a.tokens)...</text></switch></g><rect x="900" y="641" width="580" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 573px; height: 1px; padding-top: 677px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">server, err := consul.NewServerWithOptions(consulCfg, a.logger, ...)<br />a.delegate = server</div></div></div></foreignObject><text x="907" y="681" fill="#000000" font-family="source code pro" font-size="13px">server, err := consul.NewServerWithOptions(consulCfg, a.logger, ...)...</text></switch></g><rect x="900" y="725" width="680" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 673px; height: 1px; padding-top: 761px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">client, err := consul.NewClientWithOptions(consulCfg, a.logger, a.tlsConfigurator)<br />a.delegate = client</div></div></div></foreignObject><text x="907" y="765" fill="#000000" font-family="source code pro" font-size="13px">client, err := consul.NewClientWithOptions(consulCfg, a.logger, a.tlsConfigurator)...</text></switch></g><rect x="900" y="809" width="480" height="84" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 473px; height: 1px; padding-top: 851px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.State.Delegate = a.delegate<br />a.State.TriggerSyncChanges = a.sync.SyncChanges.Trigger<br />a.registerCache()</div></div></div></foreignObject><text x="907" y="855" fill="#000000" font-family="source code pro" font-size="13px">a.State.Delegate = a.delegate...</text></switch></g><rect x="900" y="904" width="178" height="96" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 171px; height: 1px; padding-top: 952px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.loadServices(c)<br />a.loadProxies(c)<br />a.loadChecks(c)<br />a.loadMetadata(c)</div></div></div></foreignObject><text x="907" y="956" fill="#000000" font-family="source code pro" font-size="13px">a.loadServices(c)...</text></switch></g><rect x="900" y="1010" width="196" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 189px; height: 1px; padding-top: 1046px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">go a.reapServices()<br />go a.handleEvents()</div></div></div></foreignObject><text x="907" y="1050" fill="#000000" font-family="source code pro" font-size="13px">go a.reapServices()...</text></switch></g><rect x="900" y="1090" width="214" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 207px; height: 1px; padding-top: 1120px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.listenAndServeDNS()</div></div></div></foreignObject><text x="907" y="1124" fill="#000000" font-family="source code pro" font-size="13px">a.listenAndServeDNS()</text></switch></g><rect x="900" y="1160" width="410" height="108" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 403px; height: 1px; padding-top: 1214px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">servers, err := a.listenHTTP()<br />for _, srv := range servers {<br />    a.serveHTTP(srv)<br />    a.httpServers = append(a.httpServers, srv)<br />}</div></div></div></foreignObject><text x="907" y="1218" fill="#000000" font-family="source code pro" font-size="13px">servers, err := a.listenHTTP()...</text></switch></g><rect x="900" y="1280" width="250" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 243px; height: 1px; padding-top: 1316px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">a.listenAndServeGRPC()<br />a.reloadWatches(a.config)</div></div></div></foreignObject><text x="907" y="1320" fill="#000000" font-family="source code pro" font-size="13px">a.listenAndServeGRPC()...</text></switch></g><rect x="900" y="1360" width="196" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 189px; height: 1px; padding-top: 1396px; margin-left: 907px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">go a.retryJoinLAN()<br />go a.retryJoinWAN()</div></div></div></foreignObject><text x="907" y="1400" fill="#000000" font-family="source code pro" font-size="13px">go a.retryJoinLAN()...</text></switch></g><path d="M 120 677 L 211.63 677" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 216.88 677 L 209.88 680.5 L 211.63 677 L 209.88 673.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 893.63 677" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 677 L 891.88 680.5 L 893.63 677 L 891.88 673.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 751 Q 860 761 870 761 L 893.63 761" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 761 L 891.88 764.5 L 893.63 761 L 891.88 757.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 841 Q 860 851 870 851 L 893.63 851" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 851 L 891.88 854.5 L 893.63 851 L 891.88 847.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 942 Q 860 952 870 952 L 893.63 952" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 952 L 891.88 955.5 L 893.63 952 L 891.88 948.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 1036 Q 860 1046 870 1046 L 893.63 1046" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 1046 L 891.88 1049.5 L 893.63 1046 L 891.88 1042.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 1110 Q 860 1120 870 1120 L 893.63 1120" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 1120 L 891.88 1123.5 L 893.63 1120 L 891.88 1116.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 1204 Q 860 1214 870 1214 L 893.63 1214" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 1214 L 891.88 1217.5 L 893.63 1214 L 891.88 1210.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 1306 Q 860 1316 870 1316 L 893.63 1316" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 1316 L 891.88 1319.5 L 893.63 1316 L 891.88 1312.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 820 677 L 850 677 Q 860 677 860 687 L 860 1386 Q 860 1396 870 1396 L 893.63 1396" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 898.88 1396 L 891.88 1399.5 L 893.63 1396 L 891.88 1392.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 45px; margin-left: 34px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 18px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">Consul agent 启动</div></div></div></foreignObject><text x="34" y="50" fill="#000000" font-family="source code pro" font-size="18px">Consul agent 启动</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>