<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="4095px" height="590px" viewBox="-0.5 -0.5 4095 590" content="&lt;mxfile host=&quot;Electron&quot; modified=&quot;2020-08-03T15:09:02.149Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_6) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/12.6.5 Chrome/80.0.3987.86 Electron/8.0.0 Safari/537.36&quot; etag=&quot;hJmVJScHqmyVMbPQaMwv&quot; version=&quot;12.6.5&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;uvCQAwpp2GW_bJ-6Q_lI&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs><clipPath id="mx-clip-915-167-345-26-0"><rect x="915" y="167" width="345" height="26"/></clipPath><clipPath id="mx-clip-915-193-345-26-0"><rect x="915" y="193" width="345" height="26"/></clipPath><clipPath id="mx-clip-915-219-345-26-0"><rect x="915" y="219" width="345" height="26"/></clipPath><clipPath id="mx-clip-1719-168-165-26-0"><rect x="1719" y="168" width="165" height="26"/></clipPath><clipPath id="mx-clip-2019-168-281-26-0"><rect x="2019" y="168" width="281" height="26"/></clipPath><clipPath id="mx-clip-2019-194-281-26-0"><rect x="2019" y="194" width="281" height="26"/></clipPath><clipPath id="mx-clip-2019-220-281-26-0"><rect x="2019" y="220" width="281" height="26"/></clipPath></defs><g><path d="M 910 162 L 910 136 L 1260 136 L 1260 162" fill="#1dbf97" stroke="#000000" stroke-miterlimit="10" pointer-events="all"/><path d="M 910 162 L 910 240 L 1260 240 L 1260 162" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 910 162 L 1260 162" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="916.5" y="154">Manager</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-915-167-345-26-0)" font-size="13px"><text x="916.5" y="180.5">- routerHandlers: map[string]http.Handler</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-915-193-345-26-0)" font-size="13px"><text x="916.5" y="206.5">- serviceManager: serviceManager</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-915-219-345-26-0)" font-size="13px"><text x="916.5" y="232.5">- conf: *runtime.Configuration</text></g><path d="M 1714 163 L 1714 137 L 1884 137 L 1884 163" fill="#1dbf97" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1714 163 L 1714 189 L 1884 189 L 1884 163" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1714 163 L 1884 163" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="1720.5" y="155">RouterInfo</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-1719-168-165-26-0)" font-size="13px"><text x="1720.5" y="181.5">- *dynamic.Router</text></g><path d="M 2014 163 L 2014 137 L 2300 137 L 2300 163" fill="#1dbf97" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 2014 163 L 2014 241 L 2300 241 L 2300 163" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 2014 163 L 2300 163" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="source code pro" font-size="13px"><text x="2020.5" y="155">Router</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2019-168-281-26-0)" font-size="13px"><text x="2020.5" y="181.5">- EntryPoints: []string</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2019-194-281-26-0)" font-size="13px"><text x="2020.5" y="207.5">- Service: string</text></g><g fill="#000000" font-family="source code pro" clip-path="url(#mx-clip-2019-220-281-26-0)" font-size="13px"><text x="2020.5" y="233.5">- Rule: string</text></g><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 147px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">1. 创建路由管理器</div></div></div></foreignObject><text x="32" y="151" fill="#000000" font-family="source code pro" font-size="13px">1. 创建路由管理器</text></switch></g><rect x="30" y="168.5" width="205" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 198px; height: 1px; padding-top: 199px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">func NewManager(...)</div></div></div></foreignObject><text x="37" y="202" fill="#000000" font-family="source code pro" font-size="13px">func NewManager(...)</text></switch></g><rect x="335" y="157" width="445" height="83" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 438px; height: 1px; padding-top: 199px; margin-left: 342px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">return &amp;Manager{<br />    routerHandlers:     make(map[string]http.Handler),<br />    serviceManager:     serviceManager,<br />}</div></div></div></foreignObject><text x="342" y="202" fill="#000000" font-family="source code pro" font-size="13px">return &amp;Manager{...</text></switch></g><path d="M 235 198.5 L 328.63 198.5" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 333.88 198.5 L 326.88 202 L 328.63 198.5 L 326.88 195 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 276px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">2. 创建入口处理 handler</div></div></div></foreignObject><text x="32" y="280" fill="#000000" font-family="source code pro" font-size="13px">2. 创建入口处理 handler</text></switch></g><rect x="30" y="298" width="187" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 180px; height: 1px; padding-top: 328px; margin-left: 37px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">BuildHandlers(...)</div></div></div></foreignObject><text x="37" y="332" fill="#000000" font-family="source code pro" font-size="13px">BuildHandlers(...)</text></switch></g><rect x="335" y="276.5" width="673" height="103" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 666px; height: 1px; padding-top: 328px; margin-left: 342px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">for entryPointName, routers := range m.getHTTPRouters(rootCtx, entryPoints, tls) {<br />    handler, err := m.buildEntryPointHandler(ctx, routers)<br />    entryPointHandlers[entryPointName] = handler<br />}<br />return entryPointHandlers</div></div></div></foreignObject><text x="342" y="332" fill="#000000" font-family="source code pro" font-size="13px">for entryPointName, routers := range m.getHTTPRouters(rootCtx, entryPoints, tls) {...</text></switch></g><rect x="1126" y="298" width="196" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 189px; height: 1px; padding-top: 328px; margin-left: 1133px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">getHTTPRouters(...)</div></div></div></foreignObject><text x="1133" y="332" fill="#000000" font-family="source code pro" font-size="13px">getHTTPRouters(...)</text></switch></g><rect x="1410" y="286" width="534" height="84" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 527px; height: 1px; padding-top: 328px; margin-left: 1417px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">if m.conf != nil {<br />    return m.conf.GetRoutersByEntryPoints(ctx, entryPoints, tls)<br />}</div></div></div></foreignObject><text x="1417" y="332" fill="#000000" font-family="source code pro" font-size="13px">if m.conf != nil {...</text></switch></g><rect x="2040" y="298" width="260" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 253px; height: 1px; padding-top: 328px; margin-left: 2047px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">GetRoutersByEntryPoints(...)</div></div></div></foreignObject><text x="2047" y="332" fill="#000000" font-family="source code pro" font-size="13px">GetRoutersByEntryPoints(...)</text></switch></g><rect x="2400" y="262" width="510" height="132" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 503px; height: 1px; padding-top: 328px; margin-left: 2407px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">entryPointsRouters := make(map[string]map[string]*RouterInfo)<br />for rtName, rt := range c.Routers {<br />    for _, entryPointName := range rt.EntryPoints {<br />        entryPointsRouters[entryPointName][rtName] = rt<br />    }<br />}<br />return entryPointsRouters</div></div></div></foreignObject><text x="2407" y="332" fill="#000000" font-family="source code pro" font-size="13px">entryPointsRouters := make(map[string]map[string]*RouterInfo)...</text></switch></g><rect x="1126" y="412" width="268" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 261px; height: 1px; padding-top: 442px; margin-left: 1133px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">buildEntryPointHandler(...)</div></div></div></foreignObject><text x="1133" y="446" fill="#000000" font-family="source code pro" font-size="13px">buildEntryPointHandler(...)</text></switch></g><rect x="1482" y="382" width="640" height="120" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 633px; height: 1px; padding-top: 442px; margin-left: 1489px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">router, err := rules.NewRouter()<br />for routerName, routerConfig := range configs {<br />    handler, err := m.buildRouterHandler(ctxRouter, routerName, routerConfig)<br />    err = router.AddRoute(routerConfig.Rule, routerConfig.Priority, handler)<br />}<br />return chain.Then(router)</div></div></div></foreignObject><text x="1489" y="446" fill="#000000" font-family="source code pro" font-size="13px">router, err := rules.NewRouter()...</text></switch></g><rect x="2212" y="412" width="232" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 225px; height: 1px; padding-top: 442px; margin-left: 2219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">buildRouterHandler(...)</div></div></div></foreignObject><text x="2219" y="446" fill="#000000" font-family="source code pro" font-size="13px">buildRouterHandler(...)</text></switch></g><rect x="2552" y="406" width="560" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 553px; height: 1px; padding-top: 442px; margin-left: 2559px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">handler, err := m.buildHTTPHandler(ctx, routerConfig, routerName)<br />return m.routerHandlers[routerName], nil</div></div></div></foreignObject><text x="2559" y="446" fill="#000000" font-family="source code pro" font-size="13px">handler, err := m.buildHTTPHandler(ctx, routerConfig, routerName)...</text></switch></g><rect x="3210" y="412" width="214" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 207px; height: 1px; padding-top: 442px; margin-left: 3217px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">buildHTTPHandler(...)</div></div></div></foreignObject><text x="3217" y="446" fill="#000000" font-family="source code pro" font-size="13px">buildHTTPHandler(...)</text></switch></g><rect x="3490" y="406" width="574" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 567px; height: 1px; padding-top: 442px; margin-left: 3497px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">sHandler, err := m.serviceManager.BuildHTTP(ctx, router.Service, rm)<br />return alice.New().Extend(*mHandler).Append(tHandler).Then(sHandler)</div></div></div></foreignObject><text x="3497" y="446" fill="#000000" font-family="source code pro" font-size="13px">sHandler, err := m.serviceManager.BuildHTTP(ctx, router.Service, rm)...</text></switch></g><rect x="2212" y="493" width="142" height="60" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 135px; height: 1px; padding-top: 523px; margin-left: 2219px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">AddRoute(...)</div></div></div></foreignObject><text x="2219" y="527" fill="#000000" font-family="source code pro" font-size="13px">AddRoute(...)</text></switch></g><rect x="2552" y="487" width="485" height="72" rx="6" ry="6" fill="#ffffff" stroke="#000000" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 478px; height: 1px; padding-top: 523px; margin-left: 2559px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 13px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: normal; word-wrap: normal; ">route := r.NewRoute().Handler(handler).Priority(priority)<br />return addRuleOnRoute(route, buildTree())</div></div></div></foreignObject><text x="2559" y="527" fill="#000000" font-family="source code pro" font-size="13px">route := r.NewRoute().Handler(handler).Priority(priority)...</text></switch></g><path d="M 217 328 L 328.63 328" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 333.88 328 L 326.88 331.5 L 328.63 328 L 326.88 324.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008 328 L 1119.63 328" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1124.88 328 L 1117.88 331.5 L 1119.63 328 L 1117.88 324.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1322 328 L 1403.63 328" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1408.88 328 L 1401.88 331.5 L 1403.63 328 L 1401.88 324.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1944 328 L 2033.63 328" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2038.88 328 L 2031.88 331.5 L 2033.63 328 L 2031.88 324.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2300 328 L 2393.63 328" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2398.88 328 L 2391.88 331.5 L 2393.63 328 L 2391.88 324.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1008 328 L 1060 328 Q 1070 328 1070 338 L 1070 432 Q 1070 442 1080 442 L 1119.63 442" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1124.88 442 L 1117.88 445.5 L 1119.63 442 L 1117.88 438.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1394 442 L 1475.63 442" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 1480.88 442 L 1473.88 445.5 L 1475.63 442 L 1473.88 438.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2122 442 L 2205.63 442" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2210.88 442 L 2203.88 445.5 L 2205.63 442 L 2203.88 438.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2444 442 L 2545.63 442" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2550.88 442 L 2543.88 445.5 L 2545.63 442 L 2543.88 438.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3112 442 L 3203.63 442" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3208.88 442 L 3201.88 445.5 L 3203.63 442 L 3201.88 438.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3424 442 L 3483.63 442" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 3488.88 442 L 3481.88 445.5 L 3483.63 442 L 3481.88 438.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2122 442 L 2157 442 Q 2167 442 2167 452 L 2167 513 Q 2167 523 2177 523 L 2205.63 523" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2210.88 523 L 2203.88 526.5 L 2205.63 523 L 2203.88 519.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2354 523 L 2545.63 523" fill="none" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 2550.88 523 L 2543.88 526.5 L 2545.63 523 L 2543.88 519.5 Z" fill="#fe4365" stroke="#fe4365" stroke-miterlimit="10" pointer-events="none"/><path d="M 910 175 L 855 175 Q 845 175 845 183.5 L 845 187.75 Q 845 192 835 192 L 785.48 192.02" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 780.23 192.03 L 787.23 188.52 L 785.48 192.02 L 787.23 195.52 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 1884 176 L 1939 176 Q 1949 176 1949 184 L 1949 188 Q 1949 192 1959 192 L 2005.63 191.99" fill="none" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><path d="M 2010.88 191.99 L 2003.88 195.49 L 2005.63 191.99 L 2003.88 188.49 Z" fill="#1dbf97" stroke="#1dbf97" stroke-miterlimit="10" pointer-events="none"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 45px; margin-left: 32px;"><div style="box-sizing: border-box; font-size: 0; text-align: left; "><div style="display: inline-block; font-size: 18px; font-family: source code pro; color: #000000; line-height: 1.2; pointer-events: none; white-space: nowrap; ">Traefix 路由管理器</div></div></div></foreignObject><text x="32" y="50" fill="#000000" font-family="source code pro" font-size="18px">Traefix 路由管理器</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://desk.draw.io/support/solutions/articles/16000042487" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Viewer does not support full SVG 1.1</text></a></switch></svg>